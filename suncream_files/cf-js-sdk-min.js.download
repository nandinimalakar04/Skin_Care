var cf_key = "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJhY2NvdW50X2lkIjoiOTI5ZDgxOTAtMzc3Mi0xMWVmLTlmZTEtZGRmYzA3OGU5ZWQ5IiwicHJvamVjdF9pZCI6ImMwM2U0MzAwLTM3NzItMTFlZi05ZmUxLWRkZmMwNzhlOWVkOSIsImVudmlyb25tZW50X2lkIjoiYzAzZjU0NzAtMzc3Mi0xMWVmLTlmZTEtZGRmYzA3OGU5ZWQ5IiwiZGltZW5zaW9uX2lkIjoiYzA0MzczMjAtMzc3Mi0xMWVmLTlmZTEtZGRmYzA3OGU5ZWQ5IiwiYXBpX2FjY2Vzc19sZXZlbCI6IkNMSUVOVCIsImtleV9pZCI6ImMwNTk0NTEwLTM3NzItMTFlZi05ZmUxLWRkZmMwNzhlOWVkOSIsImlzcyI6IkJwYXpRaDhHQk9NMWxvY2xRMnc5c0J5eEZBcm5LeE14IiwiaWF0IjoxNzE5ODE1MTQ2fQ.iE0O6knUs7mj1j5XVYwAneHUD0c3m6LIb8ELOEqBAwo";
var cf_page_elements_path_type = "ELEMENTS_BY_ID_CLASS";
var cf_intelligent_code_enabled = true;
var cf_sdk_timeout_in_seconds = 5000;
var cf_last_visited_product_url = 0;
var cf_personalize_post_sdk_timeout = true;
var cf_latest_sdk_version = "0.0.21";
var cf_account_enabled = true;
var cf_configs = [ ];
var cf_active_pages = {
  "goal_pages" : [ ],
  "rule_pages" : [ ],
  "personalized_pages" : {
    "page_paths_contains_list" : [ ],
    "page_paths_regex_list" : [ ],
    "page_paths_exact_match_list" : [ ]
  }
};
var cf_revenue_pages = [ ];
var cf_browser_variables = {
  "js_variables" : [ ],
  "cookie_storage" : [ ],
  "data_layer_storage" : [ ],
  "session_storage" : [ ],
  "local_storage" : [ ]
};
var cf_is_inbound = true;
var cf_is_outbound = true;
var cf_personalized_users_limit_exceeded = false;
var cfspa = false;
var cfspa_auto_detect_page_url_change = false;
var is_auto_form_capture = false;
var is_auto_email_capture = false;
var cf_is_page_update_enabled = false;
var cf_is_hubspot_enabled = false;
var cf_retain_text_value = false;
var cf_is_whitelabel_account = false;
var cf_whitelabel_company_display_name = "";
var cf_domain_url = "www.drsheths.com";
var cf_dimension_id = "c0437320-3772-11ef-9fe1-ddfc078e9ed9";
var cf_skip_sdk = false;
var cf_enable_event_analyzer = false;
var cf_event_merge_config = "[]";
var cf_skip_dfs = true;
var cf_is_ms_clarity_enabled = false;
var cf_is_hotjar_enabled = false;
var cf_is_shopify_integrated = true;
var cf_is_ga_enabled = true;
var cf_is_segment_enabled = false;
var cf_is_mixpanel_enabled = false;
var cf_is_moengage_enabled = false;
var cf_is_clevertap_enabled = false;
var cf_is_webengage_enabled = false;
var cf_is_netcore_enabled = false;
var cf_is_amplitude_enabled = false;
var cf_is_heap_enabled = false;
var cf_is_bigcommerce_enabled = false;
var cf_is_gokwik_enabled = false;
var cf_is_shopflo_enabled = false;
var cf_is_shiprocket_enabled = false;
var cf_send_error_report = true;
var cf_ga4_setup_mode = "native";
var cf_gtm_data_variable_name = "dataLayer";
var cf_account_source = "d2c_shopify";
var blacklisted_page_paths = [];
var blacklisted_referrers = [];
var cf_subdomains = ["a.com"];
/*! For license information please see bundle.js.LICENSE.txt */
var CustomFit;(()=>{var e={669:(e,t,r)=>{e.exports=r(609)},448:(e,t,r)=>{"use strict";var i=r(867),s=r(26),n=r(327),o=r(109),a=r(985),c=r(61);e.exports=function(e){return new Promise((function(t,l){var u=e.data,d=e.headers;i.isFormData(u)&&delete d["Content-Type"];var p=new XMLHttpRequest;if(e.auth){var h=e.auth.username||"",_=e.auth.password||"";d.Authorization="Basic "+btoa(h+":"+_)}if(p.open(e.method.toUpperCase(),n(e.url,e.params,e.paramsSerializer),!0),p.timeout=e.timeout,p.onreadystatechange=function(){if(p&&4===p.readyState&&(0!==p.status||p.responseURL&&0===p.responseURL.indexOf("file:"))){var r="getAllResponseHeaders"in p?o(p.getAllResponseHeaders()):null,i={data:e.responseType&&"text"!==e.responseType?p.response:p.responseText,status:p.status,statusText:p.statusText,headers:r,config:e,request:p};s(t,l,i),p=null}},p.onerror=function(){l(c("Network Error",e,null,p)),p=null},p.ontimeout=function(){l(c("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",p)),p=null},i.isStandardBrowserEnv()){var f=r(372),m=(e.withCredentials||a(e.url))&&e.xsrfCookieName?f.read(e.xsrfCookieName):void 0;m&&(d[e.xsrfHeaderName]=m)}if("setRequestHeader"in p&&i.forEach(d,(function(e,t){void 0===u&&"content-type"===t.toLowerCase()?delete d[t]:p.setRequestHeader(t,e)})),e.withCredentials&&(p.withCredentials=!0),e.responseType)try{p.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&p.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&p.upload&&p.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){p&&(p.abort(),l(e),p=null)})),void 0===u&&(u=null),p.send(u)}))}},609:(e,t,r)=>{"use strict";var i=r(867),s=r(849),n=r(321),o=r(655);function a(e){var t=new n(e),r=s(n.prototype.request,t);return i.extend(r,n.prototype,t),i.extend(r,t),r}var c=a(o);c.Axios=n,c.create=function(e){return a(i.merge(o,e))},c.Cancel=r(263),c.CancelToken=r(972),c.isCancel=r(502),c.all=function(e){return Promise.all(e)},c.spread=r(713),e.exports=c,e.exports.default=c},263:e=>{"use strict";function t(e){this.message=e}t.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},t.prototype.__CANCEL__=!0,e.exports=t},972:(e,t,r)=>{"use strict";var i=r(263);function s(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var r=this;e((function(e){r.reason||(r.reason=new i(e),t(r.reason))}))}s.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},s.source=function(){var e;return{token:new s((function(t){e=t})),cancel:e}},e.exports=s},502:e=>{"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},321:(e,t,r)=>{"use strict";var i=r(655),s=r(867),n=r(782),o=r(572);function a(e){this.defaults=e,this.interceptors={request:new n,response:new n}}a.prototype.request=function(e){"string"==typeof e&&(e=s.merge({url:arguments[0]},arguments[1])),(e=s.merge(i,{method:"get"},this.defaults,e)).method=e.method.toLowerCase();var t=[o,void 0],r=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)r=r.then(t.shift(),t.shift());return r},s.forEach(["delete","get","head","options"],(function(e){a.prototype[e]=function(t,r){return this.request(s.merge(r||{},{method:e,url:t}))}})),s.forEach(["post","put","patch"],(function(e){a.prototype[e]=function(t,r,i){return this.request(s.merge(i||{},{method:e,url:t,data:r}))}})),e.exports=a},782:(e,t,r)=>{"use strict";var i=r(867);function s(){this.handlers=[]}s.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},s.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},s.prototype.forEach=function(e){i.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=s},61:(e,t,r)=>{"use strict";var i=r(481);e.exports=function(e,t,r,s,n){var o=new Error(e);return i(o,t,r,s,n)}},572:(e,t,r)=>{"use strict";var i=r(867),s=r(527),n=r(502),o=r(655),a=r(793),c=r(303);function l(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return l(e),e.baseURL&&!a(e.url)&&(e.url=c(e.baseURL,e.url)),e.headers=e.headers||{},e.data=s(e.data,e.headers,e.transformRequest),e.headers=i.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),i.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||o.adapter)(e).then((function(t){return l(e),t.data=s(t.data,t.headers,e.transformResponse),t}),(function(t){return n(t)||(l(e),t&&t.response&&(t.response.data=s(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},481:e=>{"use strict";e.exports=function(e,t,r,i,s){return e.config=t,r&&(e.code=r),e.request=i,e.response=s,e}},26:(e,t,r)=>{"use strict";var i=r(61);e.exports=function(e,t,r){var s=r.config.validateStatus;r.status&&s&&!s(r.status)?t(i("Request failed with status code "+r.status,r.config,null,r.request,r)):e(r)}},527:(e,t,r)=>{"use strict";var i=r(867);e.exports=function(e,t,r){return i.forEach(r,(function(r){e=r(e,t)})),e}},655:(e,t,r)=>{"use strict";var i=r(867),s=r(16),n={"Content-Type":"application/x-www-form-urlencoded"};function o(e,t){!i.isUndefined(e)&&i.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var a,c={adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process)&&(a=r(448)),a),transformRequest:[function(e,t){return s(t,"Content-Type"),i.isFormData(e)||i.isArrayBuffer(e)||i.isBuffer(e)||i.isStream(e)||i.isFile(e)||i.isBlob(e)?e:i.isArrayBufferView(e)?e.buffer:i.isURLSearchParams(e)?(o(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):i.isObject(e)?(o(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};i.forEach(["delete","get","head"],(function(e){c.headers[e]={}})),i.forEach(["post","put","patch"],(function(e){c.headers[e]=i.merge(n)})),e.exports=c},849:e=>{"use strict";e.exports=function(e,t){return function(){for(var r=new Array(arguments.length),i=0;i<r.length;i++)r[i]=arguments[i];return e.apply(t,r)}}},327:(e,t,r)=>{"use strict";var i=r(867);function s(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,r){if(!t)return e;var n;if(r)n=r(t);else if(i.isURLSearchParams(t))n=t.toString();else{var o=[];i.forEach(t,(function(e,t){null!=e&&(i.isArray(e)?t+="[]":e=[e],i.forEach(e,(function(e){i.isDate(e)?e=e.toISOString():i.isObject(e)&&(e=JSON.stringify(e)),o.push(s(t)+"="+s(e))})))})),n=o.join("&")}return n&&(e+=(-1===e.indexOf("?")?"?":"&")+n),e}},303:e=>{"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},372:(e,t,r)=>{"use strict";var i=r(867);e.exports=i.isStandardBrowserEnv()?{write:function(e,t,r,s,n,o){var a=[];a.push(e+"="+encodeURIComponent(t)),i.isNumber(r)&&a.push("expires="+new Date(r).toGMTString()),i.isString(s)&&a.push("path="+s),i.isString(n)&&a.push("domain="+n),!0===o&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},793:e=>{"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},985:(e,t,r)=>{"use strict";var i=r(867);e.exports=i.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function s(e){var i=e;return t&&(r.setAttribute("href",i),i=r.href),r.setAttribute("href",i),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return e=s(window.location.href),function(t){var r=i.isString(t)?s(t):t;return r.protocol===e.protocol&&r.host===e.host}}():function(){return!0}},16:(e,t,r)=>{"use strict";var i=r(867);e.exports=function(e,t){i.forEach(e,(function(r,i){i!==t&&i.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[i])}))}},109:(e,t,r)=>{"use strict";var i=r(867),s=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,r,n,o={};return e?(i.forEach(e.split("\n"),(function(e){if(n=e.indexOf(":"),t=i.trim(e.substr(0,n)).toLowerCase(),r=i.trim(e.substr(n+1)),t){if(o[t]&&s.indexOf(t)>=0)return;o[t]="set-cookie"===t?(o[t]?o[t]:[]).concat([r]):o[t]?o[t]+", "+r:r}})),o):o}},713:e=>{"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},867:(e,t,r)=>{"use strict";var i=r(849),s=r(778),n=Object.prototype.toString;function o(e){return"[object Array]"===n.call(e)}function a(e){return null!==e&&"object"==typeof e}function c(e){return"[object Function]"===n.call(e)}function l(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),o(e))for(var r=0,i=e.length;r<i;r++)t.call(null,e[r],r,e);else for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.call(null,e[s],s,e)}e.exports={isArray:o,isArrayBuffer:function(e){return"[object ArrayBuffer]"===n.call(e)},isBuffer:s,isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:a,isUndefined:function(e){return void 0===e},isDate:function(e){return"[object Date]"===n.call(e)},isFile:function(e){return"[object File]"===n.call(e)},isBlob:function(e){return"[object Blob]"===n.call(e)},isFunction:c,isStream:function(e){return a(e)&&c(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:l,merge:function e(){var t={};function r(r,i){"object"==typeof t[i]&&"object"==typeof r?t[i]=e(t[i],r):t[i]=r}for(var i=0,s=arguments.length;i<s;i++)l(arguments[i],r);return t},extend:function(e,t,r){return l(t,(function(t,s){e[s]=r&&"function"==typeof t?i(t,r):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}},778:e=>{e.exports=function(e){return null!=e&&null!=e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}},20:e=>{"use strict";var t="%[a-f0-9]{2}",r=new RegExp("("+t+")|([^%]+?)","gi"),i=new RegExp("("+t+")+","gi");function s(e,t){try{return[decodeURIComponent(e.join(""))]}catch(e){}if(1===e.length)return e;t=t||1;var r=e.slice(0,t),i=e.slice(t);return Array.prototype.concat.call([],s(r),s(i))}function n(e){try{return decodeURIComponent(e)}catch(n){for(var t=e.match(r)||[],i=1;i<t.length;i++)t=(e=s(t,i).join("")).match(r)||[];return e}}e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"��","%FF%FE":"��"},r=i.exec(e);r;){try{t[r[0]]=decodeURIComponent(r[0])}catch(e){var s=n(r[0]);s!==r[0]&&(t[r[0]]=s)}r=i.exec(e)}t["%C2"]="�";for(var o=Object.keys(t),a=0;a<o.length;a++){var c=o[a];e=e.replace(new RegExp(c,"g"),t[c])}return e}(e)}}},418:e=>{"use strict";var t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach((function(e){i[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(e){return!1}}()?Object.assign:function(e,s){for(var n,o,a=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),c=1;c<arguments.length;c++){for(var l in n=Object(arguments[c]))r.call(n,l)&&(a[l]=n[l]);if(t){o=t(n);for(var u=0;u<o.length;u++)i.call(n,o[u])&&(a[o[u]]=n[o[u]])}}return a}},563:(e,t,r)=>{"use strict";var i=r(610),s=r(418),n=r(20);function o(e,t){return t.encode?t.strict?i(e):encodeURIComponent(e):e}function a(e){return Array.isArray(e)?e.sort():"object"==typeof e?a(Object.keys(e)).sort((function(e,t){return Number(e)-Number(t)})).map((function(t){return e[t]})):e}function c(e){var t=e.indexOf("?");return-1===t?"":e.slice(t+1)}function l(e,t){var r=function(e){var t;switch(e.arrayFormat){case"index":return function(e,r,i){t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===i[e]&&(i[e]={}),i[e][t[1]]=r):i[e]=r};case"bracket":return function(e,r,i){t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==i[e]?i[e]=[].concat(i[e],r):i[e]=[r]:i[e]=r};default:return function(e,t,r){void 0!==r[e]?r[e]=[].concat(r[e],t):r[e]=t}}}(t=s({arrayFormat:"none"},t)),i=Object.create(null);return"string"!=typeof e?i:(e=e.trim().replace(/^[?#&]/,""))?(e.split("&").forEach((function(e){var t=e.replace(/\+/g," ").split("="),s=t.shift(),o=t.length>0?t.join("="):void 0;o=void 0===o?null:n(o),r(n(s),o,i)})),Object.keys(i).sort().reduce((function(e,t){var r=i[t];return Boolean(r)&&"object"==typeof r&&!Array.isArray(r)?e[t]=a(r):e[t]=r,e}),Object.create(null))):i}t.extract=c,t.parse=l,t.stringify=function(e,t){!1===(t=s({encode:!0,strict:!0,arrayFormat:"none"},t)).sort&&(t.sort=function(){});var r=function(e){switch(e.arrayFormat){case"index":return function(t,r,i){return null===r?[o(t,e),"[",i,"]"].join(""):[o(t,e),"[",o(i,e),"]=",o(r,e)].join("")};case"bracket":return function(t,r){return null===r?o(t,e):[o(t,e),"[]=",o(r,e)].join("")};default:return function(t,r){return null===r?o(t,e):[o(t,e),"=",o(r,e)].join("")}}}(t);return e?Object.keys(e).sort(t.sort).map((function(i){var s=e[i];if(void 0===s)return"";if(null===s)return o(i,t);if(Array.isArray(s)){var n=[];return s.slice().forEach((function(e){void 0!==e&&n.push(r(i,e,n.length))})),n.join("&")}return o(i,t)+"="+o(s,t)})).filter((function(e){return e.length>0})).join("&"):""},t.parseUrl=function(e,t){return{url:e.split("?")[0]||"",query:l(c(e),t)}}},610:e=>{"use strict";e.exports=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}))}},75:e=>{for(var t=[],r=0;r<256;++r)t[r]=(r+256).toString(16).substr(1);e.exports=function(e,r){var i=r||0,s=t;return[s[e[i++]],s[e[i++]],s[e[i++]],s[e[i++]],"-",s[e[i++]],s[e[i++]],"-",s[e[i++]],s[e[i++]],"-",s[e[i++]],s[e[i++]],"-",s[e[i++]],s[e[i++]],s[e[i++]],s[e[i++]],s[e[i++]],s[e[i++]]].join("")}},217:e=>{var t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(t){var r=new Uint8Array(16);e.exports=function(){return t(r),r}}else{var i=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)3&t||(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}},570:(e,t,r)=>{var i,s,n=r(217),o=r(75),a=0,c=0;e.exports=function(e,t,r){var l=t&&r||0,u=t||[],d=(e=e||{}).node||i,p=void 0!==e.clockseq?e.clockseq:s;if(null==d||null==p){var h=n();null==d&&(d=i=[1|h[0],h[1],h[2],h[3],h[4],h[5]]),null==p&&(p=s=16383&(h[6]<<8|h[7]))}var _=void 0!==e.msecs?e.msecs:(new Date).getTime(),f=void 0!==e.nsecs?e.nsecs:c+1,m=_-a+(f-c)/1e4;if(m<0&&void 0===e.clockseq&&(p=p+1&16383),(m<0||_>a)&&void 0===e.nsecs&&(f=0),f>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=_,c=f,s=p;var g=(1e4*(268435455&(_+=122192928e5))+f)%4294967296;u[l++]=g>>>24&255,u[l++]=g>>>16&255,u[l++]=g>>>8&255,u[l++]=255&g;var v=_/4294967296*1e4&268435455;u[l++]=v>>>8&255,u[l++]=255&v,u[l++]=v>>>24&15|16,u[l++]=v>>>16&255,u[l++]=p>>>8|128,u[l++]=255&p;for(var y=0;y<6;++y)u[l+y]=d[y];return t||o(u)}}},t={};function r(i){var s=t[i];if(void 0!==s)return s.exports;var n=t[i]={exports:{}};return e[i](n,n.exports,r),n.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var i in t)r.o(t,i)&&!r.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};(()=>{"use strict";r.r(i),r.d(i,{CFEvent:()=>_,CFUser:()=>p,default:()=>v});var e=r(669),t=r.n(e),s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=r(563),o=/^(\w+:\/\/[^/?]+)?(.*?)(\?.+)?$/,a=/^(\/\/[^/?]+)(.*?)(\?.+)?$/;function c(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=t[t.length-1],c=void 0;i&&"object"===(void 0===i?"undefined":s(i))&&(c=i,t=t.slice(0,-1)),c=Object.assign({leadingSlash:!0,trailingSlash:!1,protocolRelative:!1},c);var l,u,d=(l=t.filter((function(e){return"string"==typeof e||"number"==typeof e})).join("/"),{beforePathname:(u=c.protocolRelative&&l.match(a)||l.match(o)||[])[1]||"",pathname:(u[2]||"").replace(/^\/+/,"").replace(/\/+$/,"").replace(/\/+/g,"/"),afterPathname:u[3]||""}),p=d.beforePathname,h=d.pathname,_=d.afterPathname,f="";p?f+=p+(h?"/":""):c.leadingSlash&&(f+="/"),f+=h,c.trailingSlash&&!f.endsWith("/")&&(f+="/");var m=Object.assign({},n.parse(_,c.queryOptions),c.query),g=n.stringify(m,c.queryOptions);return g&&(f+="?"+g),f}var l=r(570),u=r.n(l);class d{constructor(e){this.baseURL="https://api.customfit.ai/",this.accessToken=e,t().defaults.headers.common={"Content-Type":"application/x-www-form-urlencoded"}}send(e,r,i={},s=!1,n=3){let o=c(this.baseURL,r,{trailingSlash:!0}),a=[],l={cfenc:this.accessToken},u="";if("POST"===e?(a["Content-Type"]="application/x-www-form-urlencoded",u=JSON.stringify(i)):Object.keys(i).length&&i.constructor===Object&&(o=c(o,{trailingSlash:!0,query:i})),"POST"===e&&s){var d=new Blob([u],{type:"application/x-www-form-urlencoded"});return navigator.sendBeacon(o+"?cfenc="+this.accessToken,d),Promise.resolve({cf_error_code:"CFJSSDK000"})}const p=(r,i,s,o,a,c)=>t()(i,{method:e,data:s,params:o,headers:a}).then((e=>e.status>=203?Promise.reject({status:e.status,message:e.statusText,data:e.data,headers:e.headers,callURL:i,lparams:o,request_data:c,cf_error_code:"CFJSSDK001"}):e.status>=200&&e.status<=202?e.data:{cf_error_code:"CFJSSDK002"})).catch((e=>void 0===e.response?r<n?new Promise((e=>{setTimeout((()=>{e(p(r+1,i,s,o,a,c))}),500)})):Promise.reject({status:"CORS/Network Error",message:"A CORS or network error occurred",data:null,headers:null,callURL:i,lparams:o,request_data:c,cf_error_code:"CFJSSDK004"}):Promise.reject({status:e.response.status,message:e.message,data:e.response.data,headers:e.response.headers,callURL:i,lparams:o,request_data:c,cf_error_code:"CFJSSDK003"})));return p(1,o,u,l,a,i)}}class p{constructor(e){this.private_fields=e.private_fields,this.session_fields=e.session_fields,this.hs_fields=e.hs_fields,this.user_customer_id=e.user_customer_id,this.anonymous=e.anonymous,this.user_id=e.user_id,this.device_id=e.device_id,this.tags=e.tags,this.latest_session_id="",this.properties=e.properties,this.email=e.email,this.sdk_generated_user_customer_id=e.sdk_generated_user_customer_id,e.utm_source&&(this.utm_source=e.utm_source),e.utm_medium&&(this.utm_medium=e.utm_medium),e.utm_campaign&&(this.utm_campaign=e.utm_campaign),e.utm_term&&(this.utm_term=e.utm_term),e.utm_content&&(this.utm_content=e.utm_content),e.utm_adgroup&&(this.utm_adgroup=e.utm_adgroup),e.fbclid&&(this.fbclid=e.fbclid),e.gclid&&(this.gclid=e.gclid),this.initHubspotUTKIfSet(),this.initGAUDeviceIDIfSet()}initHubspotUTKIfSet(){if(cf_is_hubspot_enabled&&null==this.properties.hubspotutk){const r=`; ${document.cookie}`.split("; hubspotutk=");for(var e=r.length;e>0;e--){var t=r[e-1].split(";").shift();if(t&&t.length>0){this.properties.hubspotutk=t;break}}}}isHubspotUTKExtracted(){return!(null==this.properties.hubspotutk)}initGAUDeviceIDIfSet(){if(cf_is_ga_enabled&&null==this.properties.ga_device_id)try{let e=document.cookie.split("; ").find((e=>e.startsWith("_ga=")));if(!e)return;let t=e.split("=")[1].split(".");if(t.length>3)return void(this.properties.ga_device_id=t[2]+"."+t[3])}catch(e){console.error("An error occurred while getting the GA client ID:",e)}}isGADeviceExtracted(){return!(null==this.properties.ga_device_id)}validateBuild(e){return String(e.constructor)===String(p.Builder)}static get Builder(){return class{constructor(e){this.user_id=null,this.private_fields={},this.private_fields.user_fields=[],this.private_fields.properties=[],this.private_fields.tags=[],this.session_fields={},this.session_fields.user_fields=[],this.session_fields.properties=[],this.session_fields.tags=[],this.hs_fields=[],this.device_id=null,this.user_customer_id=e,this.anonymous=!1,this.ip=null,this.tags=[],this.sdk_generated_user_customer_id=!1,this.properties={};var t=(new Date).getTimezoneOffset();this.properties.cf_timezone=-1*t,this.utm_source=null,this.utm_medium=null,this.utm_campaign=null,this.utm_term=null,this.utm_content=null}getCookie(e){const t=`; ${document.cookie}`.split(`; ${e}=`);if(2===t.length)return t.pop().split(";").shift()}withCustomerId(e){return this.user_customer_id=e,this.sdk_generated_user_customer_id=!1,this}makeAnonymous(e){return this.anonymous=e,this}withIp(e){return this.ip=e,this}withPrivateIp(e){return this.private_fields.user_fields.add("ip"),this.withIp(e)}withSessioneIp(e){return this.session_fields.user_fields.add("ip"),this.withIp(e)}withNumberProperty(e,t){if("string"!=typeof e||isNaN(t)||"boolean"==typeof t||t instanceof Date==1||"[object Date]"===Object.prototype.toString.call(t))throw new Error("withNumberProperty: "+e+" value is not a number");return this.properties[e]=t,this}withPrivateNumberProperty(e,t){if("string"!=typeof e||isNaN(t)||"boolean"==typeof t||t instanceof Date==1||"[object Date]"===Object.prototype.toString.call(t))throw new Error("withPrivateNumberProperty: "+e+" value is not a number");return this.properties[e]=t,this.private_fields.properties.push(e),this}withSessionNumberProperty(e,t){if("string"!=typeof e||isNaN(t)||"boolean"==typeof t||t instanceof Date==1||"[object Date]"===Object.prototype.toString.call(t))throw new Error("withSessionNumberProperty: "+e+" value is not a number");return this.properties[e]=t,this.session_fields.properties.push(e),this}withStringProperty(e,t){if("string"!=typeof e||"string"!=typeof t)throw new Error("withStringProperty: "+e+" value is not a string ");return this.properties[e]=t,this}withPrivateStringProperty(e,t){if("string"!=typeof e||"string"!=typeof t)throw new Error("withPrivateStringProperty: "+e+" value is not a string ");return this.properties[e]=t,this.private_fields.properties.push(e),this}withSessionStringProperty(e,t){if("string"!=typeof e||"string"!=typeof t)throw new Error("withSessionStringProperty: "+e+" value is not a string ");return this.properties[e]=t,this.session_fields.properties.push(e),this}withBooleanProperty(e,t){if("string"!=typeof e||"boolean"!=typeof t)throw new Error("withBooleanProperty: "+e+" value is not a Boolean ");return this.properties[e]=t,this}withPrivateBooleanProperty(e,t){if("string"!=typeof e||"boolean"!=typeof t)throw new Error("withPrivateBooleanProperty: "+e+" value is not a Boolean ");return this.properties[e]=t,this.private_fields.properties.push(e),this}withSessionBooleanProperty(e,t){if("string"!=typeof e||"boolean"!=typeof t)throw new Error("withSessionBooleanProperty: "+e+" value is not a Boolean ");return this.properties[e]=t,this.session_fields.properties.push(e),this}withDateProperty(e,t){if("string"!=typeof e||t instanceof Date!=1||"[object Date]"!==Object.prototype.toString.call(t))throw new Error("withDateProperty: "+e+" value is not a Date ");return this.properties[e]=t,this}withPrivateDateProperty(e,t){if("string"!=typeof e||t instanceof Date!=1||"[object Date]"!==Object.prototype.toString.call(t))throw new Error("withPrivateDateProperty: "+e+" value is not a Date ");return this.properties[e]=t,this.private_fields.properties.push(e),this}withSessionDateProperty(e,t){if("string"!=typeof e||t instanceof Date!=1||"[object Date]"!==Object.prototype.toString.call(t))throw new Error("withSessionDateProperty: "+e+" value is not a Date ");return this.properties[e]=t,this.session_fields.properties.push(e),this}withGeoPointProperty(e,t,r){if("string"!=typeof e||isNaN(t)||isNaN(r)||"boolean"==typeof t||"boolean"==typeof r||t instanceof Date==1||"[object Date]"===Object.prototype.toString.call(t)||r instanceof Date==1||"[object Date]"===Object.prototype.toString.call(r))throw new Error("withGeoPointProperty: "+e+" value is not a geo point ");return this.properties[e]={lat:t,lon:r},this}withPrivateGeoPointProperty(e,t,r){if("string"!=typeof e||isNaN(t)||isNaN(r)||"boolean"==typeof t||"boolean"==typeof r||t instanceof Date==1||"[object Date]"===Object.prototype.toString.call(t)||r instanceof Date==1||"[object Date]"===Object.prototype.toString.call(r))throw new Error("withPrivateGeoPointProperty: "+e+" value is not a geo point ");return this.properties[e]={lat:t,lon:r},this.private_fields.properties.push(e),this}withSessionGeoPointProperty(e,t,r){if("string"!=typeof e||isNaN(t)||isNaN(r)||"boolean"==typeof t||"boolean"==typeof r||t instanceof Date==1||"[object Date]"===Object.prototype.toString.call(t)||r instanceof Date==1||"[object Date]"===Object.prototype.toString.call(r))throw new Error("withSessionGeoPointProperty: "+e+" value is not a geo point ");return this.properties[e]={lat:t,lon:r},this.session_fields.properties.push(e),this}withListNumberProperty(e,t){if(Array.isArray(t)){for(var r=0;r<t.length;r++)if("string"!=typeof e||isNaN(t[r])||"boolean"==typeof t[r]||t[r]instanceof Date==1||"[object Date]"===Object.prototype.toString.call(t[r]))throw new Error("withListNumberProperty: "+e+" value is not a number");return this.properties[e]=t,this}throw new Error("withListNumberProperty: "+e+" value is not an array")}withPrivateListNumberProperty(e,t){if(Array.isArray(t)){for(var r=0;r<t.length;r++)if("string"!=typeof e||isNaN(t[r])||"boolean"==typeof t[r]||t[r]instanceof Date==1||"[object Date]"===Object.prototype.toString.call(t[r]))throw new Error("withPrivateListNumberProperty: "+e+" value is not a number");return this.properties[e]=t,this.private_fields.properties.push(e),this}throw new Error("withPrivateListNumberProperty: "+e+" value is not an array")}withSessionListNumberProperty(e,t){if(Array.isArray(t)){for(var r=0;r<t.length;r++)if("string"!=typeof e||isNaN(t[r])||"boolean"==typeof t[r]||t[r]instanceof Date==1||"[object Date]"===Object.prototype.toString.call(t[r]))throw new Error("withSessionListNumberProperty: "+e+" value is not a number");return this.properties[e]=t,this.session_fields.properties.push(e),this}throw new Error("withSessionListNumberProperty: "+e+" value is not an array")}withListStringProperty(e,t){if(Array.isArray(t)){for(var r=0;r<t.length;r++)if("string"!=typeof e||"string"!=typeof t[r])throw new Error("withListStringProperty: "+e+" value is not a string");return this.properties[e]=t,this}throw new Error("withListStringProperty: "+e+" value is not an array")}withPrivateListStringProperty(e,t){if(Array.isArray(t)){for(var r=0;r<t.length;r++)if("string"!=typeof e||"string"!=typeof t[r])throw new Error("withPrivateListStringProperty: "+e+" value is not a string");return this.properties[e]=t,this.private_fields.properties.push(e),this}throw new Error("withPrivateListStringProperty: "+e+" value is not an array")}withSessionListStringProperty(e,t){if(Array.isArray(t)){for(var r=0;r<t.length;r++)if("string"!=typeof e||"string"!=typeof t[r])throw new Error("withSessionListStringProperty: "+e+" value is not a string");return this.properties[e]=t,this.session_fields.properties.push(e),this}throw new Error("withSessionListStringProperty: "+e+" value is not an array")}withListDateProperty(e,t){if(Array.isArray(t)){for(var r=0;r<t.length;r++)if("string"!=typeof e||t[r]instanceof Date!=1||"[object Date]"!==Object.prototype.toString.call(t[r]))throw new Error("withListDateProperty: "+e+" value is not a date");return this.properties[e]=t,this}throw new Error("withListDateProperty: "+e+" value is not an array")}withPrivateListDateProperty(e,t){if(Array.isArray(t)){for(var r=0;r<t.length;r++)if("string"!=typeof e||t[r]instanceof Date!=1||"[object Date]"!==Object.prototype.toString.call(t[r]))throw new Error("withPrivateListDateProperty: "+e+" value is not a date");return this.properties[e]=t,this.private_fields.properties.push(e),this}throw new Error("withPrivateListDateProperty: "+e+" value is not an array")}withSessionListDateProperty(e,t){if(Array.isArray(t)){for(var r=0;r<t.length;r++)if("string"!=typeof e||t[r]instanceof Date!=1||"[object Date]"!==Object.prototype.toString.call(t[r]))throw new Error("withSessionListDateProperty: "+e+" value is not a date");return this.properties[e]=t,this.session_fields.properties.push(e),this}throw new Error("withSessionListDateProperty: "+e+" value is not an array")}withJsonProperty(e,t){if("string"!=typeof e||!t)throw new Error("withJsonProperty: "+e+" value is not a json ");return this.properties[e]=t,this}withPrivateJsonProperty(e,t){if("string"!=typeof e||!t)throw new Error("withPrivateJsonProperty: "+e+" value is not a json ");return this.properties[e]=t,this.private_fields.properties.push(e),this}withSessionJsonProperty(e,t){if("string"!=typeof e||!t)throw new Error("withSessionJsonProperty: "+e+" value is not a json ");return this.properties[e]=t,this.session_fields.properties.push(e),this}withTags(e){if(Array.isArray(e))return this.tags=e,this}withPrivateTags(e){if(Array.isArray(e))return this.private_fields.tags=e,withTags(e)}withSessionTags(e){if(Array.isArray(e))return this.session_fields.tags=e,withTags(e)}build(){return new p(this)}}}}class h{constructor(e,t){this.cfUserId=null,this.user=e,this.clientKey=t,this.sdkConfigs={},this.configs=null,this.storageKeyPrefix="",this.trackQueueSize=5,this.configSummaryQueueSize=1,this.preview_mode=!1,this.edit_mode=!1,this.personalizedPagePaths={page_paths_contains_list:[],page_paths_exact_match_list:[],page_paths_regex_list:[]},this.configsPathMap=null,this.pageElementsPathType="ELEMENTS_BY_ID",this.matchedPagePath="",this.currentPagePersonalized=!0,this.currentPageActive=!0,this.currentPageTrackSent=!1,this.desired_experiences=null,this.preferred_experiences=null,this.last_page_duration=0,this.last_page_url="",this.current_page_url="",this.current_domain="",this.deviceType="desktop",this.initSettings={},this.preInitTrackMessages=null,this.sessionId="",this.hiddenElementsConfigMap=new Map,this.addingCustomElementsAttempted=!1,this.globalActionsMap=new Map,this.replacedElementsConfigMap=new Map,this.delayAppliedConfigMap=new Map,this.activeElementLoadObserverConfigMap=new Map,this.elementsDuplicatedMap=new Map,this.registeredToScrollEvents=!1,this.maxScrollDepth=0,this.pageClicks=0,this.periodicTimerId=null,this.lastTrackedPageProperties={scroll_depth:0,current_page_duration:0,scroll_pixel_count:0,click_count:0};var r=new Date;this.current_page_start_time_secs=r.getTime(),this.current_time_secs=0,this.config_summary_history=[],this.session_config_summary_history=[],this.cfid=null,this.templateImpressionMap=new Map,this.timerIds=[],this.regEventHandlers=[],this.regObserverHandlers=[],this.spa=!1,this.spa_auto_detect_page_url_change=!1,this.currentPageURL=window.location.href,this.apiTimedOut=!1,this.elementsMoved=!1,this.elementsSwapped=!1,this.elementReAddedObserver=null,this.experienceBehaviorMap=new Map,this.domChangeActionConfigsMap=new Map,this.isRedirectedPage=!1,this.userConfigAPICallState="USER_CONFIG_API_CALL_NOT_NEEDED"}reset(){this.user=null,this.clientKey=null,this.cfUserId=null}getUserId(){return null!=this.user?this.user.user_customer_id:null}setInitSettings(e){this.initSettings=e}getInitSettings(){return this.initSettings}setPageRedirected(e){this.isRedirectedPage=e}isThisPageRedirected(){return this.isRedirectedPage}getUserConfigAPICallState(){return this.userConfigAPICallState}setUserConfigAPICallState(e){this.userConfigAPICallState=e}setPreInitTrackMessages(e){this.preInitTrackMessages=e}getPreInitTrackMessages(){return this.preInitTrackMessages}getDomChangeActionConfigsMap(){return this.domChangeActionConfigsMap}setDomChangeActionConfigsMap(e){this.domChangeActionConfigsMap=e}getDomChangesActionConfigsCount(){return this.domChangeActionConfigsMap.size}setConfigsPathMap(e){this.configsPathMap=e}getConfigsPathMap(){return this.configsPathMap}getCurrentPageUrl(){return this.currentPageURL}setCurrentPageURL(e){return this.currentPageURL=e}setElementsSwapped(e){this.elementsSwapped=!!e}setElementsMoved(e){this.elementsMoved=!!e}hasElementsSwpped(){return this.elementsSwapped}hasElementsMoved(){return this.elementsMoved}isSPA(){try{return this.initSettings.spa}catch(e){return!1}}isSPAAutoDetectPageUrlChangeEnabled(){try{return this.initSettings.spa_auto_detect_page_url_change}catch(e){return!1}}setSessionId(e){this.sessionId=e}getSessionId(){return this.sessionId}setPreviewMode(e){this.preview_mode=e}isPreviewMode(){return this.preview_mode}setEditMode(e){this.edit_mode=e}isEditMode(){return this.edit_mode}setStorageKeyPrefix(e){this.storageKeyPrefix=e}setLastPagePathDuration(){var e=(new Date).getTime(),t=window.location.href,r="",i=sessionStorage.getItem(this.getStorageKeyPrefix()+"last_page_timestamp_"+this.getUserId()),s=sessionStorage.getItem(this.getStorageKeyPrefix()+"last_page_url_"+this.getUserId());if(i&&(this.last_page_duration=e-parseInt(i,10)),sessionStorage.setItem(this.getStorageKeyPrefix()+"last_page_timestamp_"+this.getUserId(),e),s){var n=s.split("^")[0],o=s.split("^")[1];n&&n.length>0&&(n.split("?")[0].replace(/\/$/,"")==t.split("?")[0].replace(/\/$/,"")?o&&o.length>0&&(this.last_page_url=o,r=t+"^"+o):(this.last_page_url=n,r=t+"^"+n))}0==r.length&&(r=t),sessionStorage.setItem(this.getStorageKeyPrefix()+"last_page_url_"+this.getUserId(),r),this.user.properties.cf_last_page_url=this.last_page_url,this.user.session_fields.properties.push("cf_last_page_url"),this.current_page_url=t,this.current_domain=S()}getCurrentPageUrl(){return this.current_page_url}getCurrentDomain(){return this.current_domain}pauseCurrentPageTime(){var e=(new Date).getTime();this.current_time_secs=this.current_time_secs+e-this.current_page_start_time_secs,this.current_page_start_time_secs=0,sessionStorage.setItem(this.getStorageKeyPrefix()+"last_page_timestamp_"+this.getUserId(),e-this.current_time_secs)}resumeCurrentPageTime(){var e=new Date;this.current_page_start_time_secs=e.getTime()}getLastPageDuration(){return this.last_page_duration}getLastPageURL(){return this.last_page_url}getConfigSummaryHistory(){return this.config_summary_history}setConfigSummaryHistory(e){this.config_summary_history=e,this.setSessionConfigSummaryHistory()}getSessionConfigSummaryHistory(){return 0==this.session_config_summary_history.length&&this.setSessionConfigSummaryHistory(),this.session_config_summary_history}setSessionConfigSummaryHistory(){var e=new Map;for(var t of this.config_summary_history)e.get(t.experience_id+t.behaviour_id+t.rule_id)||e.set(""+t.experience_id+t.behaviour_id+t.rule_id,{experience_id:t.experience_id,behaviour_id:t.behaviour_id,rule_id:t.rule_id});var r=sessionStorage.getItem("cf_summary_history");if(r&&"{}"!=r){var i=new Map(JSON.parse(r,(function(e,t){return"object"==typeof t&&null!==t&&"Map"===t.dataType?new Map(t.value):t})));for(var s of i.keys())e.get(s)||e.set(s,i.get(s))}var n=this;e.forEach((function(e,t){n.session_config_summary_history.push(e)})),this.session_config_summary_history.length>0&&sessionStorage.setItem("cf_summary_history",JSON.stringify(e,(function(e,t){return t instanceof Map?{dataType:"Map",value:Array.from(t.entries())}:t})))}getCurrentPageDuration(){var e=(new Date).getTime();return this.current_page_start_time_secs>0?this.current_time_secs+e-this.current_page_start_time_secs:this.current_time_secs}setTinyID(e){this.cfid=e}getTinyId(){return this.cfid}isOutboudUser(){var e=!1,t=localStorage.getItem(this.getStorageKeyPrefix()+"_cf_is_outbound_user");if(t){var r=new Date;Math.floor(r/1e3)<parseInt(t)+604800?e=!0:(e=!1,localStorage.removeItem(this.getStorageKeyPrefix()+"_cf_is_outbound_user"))}return e}setLongUrlParams(e){try{if(e&&e.length>0){var t=e.split("?")[1];sessionStorage.setItem(this.getStorageKeyPrefix()+"long_url_params",t);var r=new Date,i=Math.floor(r/1e3);localStorage.setItem(this.getStorageKeyPrefix()+"_cf_is_outbound_user",i)}}catch(e){}}getLongUrlParams(e){return sessionStorage.getItem(this.getStorageKeyPrefix()+"long_url_params")}setDesiredExperiences(e){if(e&&e.length>0)try{"["==e[0]?this.desired_experiences=JSON.parse(e):this.desired_experiences=JSON.parse(atob(e)),sessionStorage.setItem(this.getStorageKeyPrefix()+"desired_experiences_",JSON.stringify(this.desired_experiences))}catch(e){}}getDesiredExperiences(){try{if(this.desired_experiences)return this.desired_experiences;var e=sessionStorage.getItem(this.getStorageKeyPrefix()+"desired_experiences_");if(e)return this.desired_experiences=JSON.parse(e),this.desired_experiences}catch(e){return null}}setPreferredExperiences(e){if(e&&e.length>0)try{"["==e[0]?this.preferred_experiences=JSON.parse(e):this.preferred_experiences=JSON.parse(atob(e)),sessionStorage.setItem(this.getStorageKeyPrefix()+"preferred_experiences_",JSON.stringify(this.preferred_experiences))}catch(e){}}getPreferredExperiences(){try{if(this.preferred_experiences)return this.preferred_experiences;var e=sessionStorage.getItem(this.getStorageKeyPrefix()+"preferred_experiences_");if(e)return this.preferred_experiences=JSON.parse(e),this.preferred_experiences}catch(e){return null}}getStorageKeyPrefix(){return this.storageKeyPrefix}setTrackQueueSize(e){this.trackQueueSize=e}getTrackQueueSize(){return this.trackQueueSize}setConfigSummaryQueueSize(e){this.configSummaryQueueSize=e}getConfigSummaryQueueSize(){return this.configSummaryQueueSize}getDeviceId(){return null!=this.user?this.user.device_id:null}setCFUserId(e){this.cfUserId=e,null!=this.user&&(this.user.user_id=e,this.getUserId()&&(localStorage.setItem(this.getStorageKeyPrefix()+"cf_customer_id_user_id",this.getUserId()+"|"+e),localStorage.setItem("cfit_user_id",e)))}getCFUserId(){return this.cfUserId}setPersonalizedPagePaths(e){this.personalizedPagePaths=e}getPersonalizedPagePaths(){return this.personalizedPagePaths}setUserInfo(e){try{null!=e&&(this.user=e)}catch(e){console.log("CustomFit Exception: ",e)}}setClientKey(e){try{null!=e&&(this.clientKey=e)}catch(e){console.log("CustomFit Exception: ",e)}}setConfigs(e){try{null!=e&&(this.configs=e)}catch(e){console.log("CustomFit Exception: ",e)}}setSdkConfigs(e){try{null!=e&&(this.sdkConfigs=e)}catch(e){console.log("CustomFit Exception: ",e)}}getUser(){try{if(null!=this.user)return this.user}catch(e){console.log("CustomFit Exception: ",e)}return null}getClientKey(){try{return this.clientKey,this.clientKey}catch(e){console.log("CustomFit Exception: ",e)}return null}getConfigs(){try{if(null!=this.configs)return this.configs}catch(e){console.log("CustomFit Exception: ",e)}return null}getSdkConfigs(){try{if(null!=this.sdkConfigs)return this.sdkConfigs}catch(e){console.log("CustomFit Exception: ",e)}return null}getPageElementsPathType(){return this.pageElementsPathType}setPageElementsPathType(e){e&&e.length>0&&(this.pageElementsPathType=e)}getMatchedPagePath(){return this.matchedPagePath}setMatchedPagePath(e){e&&e.length>0&&(this.matchedPagePath=e)}isCurrentPagePersonalized(){return this.currentPagePersonalized}setCurrentPagePersonalized(e){this.currentPagePersonalized=!!e}isCurrentPageActive(){return this.currentPageActive}setCurrentPageActive(e){this.currentPageActive=!!e}isCurrentPageTrackSent(){return this.currentPageTrackSent}setCurrentPageTrackSent(e){this.currentPageTrackSent=!!e}getDeviceType(){return this.deviceType}setDeviceType(e){this.deviceType=e}setHiddenElementsConfigMap(e){this.hiddenElementsConfigMap=e}getHiddenElementsConfigMap(){return this.hiddenElementsConfigMap}setAddingCustomElementsAttempted(e){this.addingCustomElementsAttempted=e}isAddingCustomElementsAttempted(){return this.addingCustomElementsAttempted}setGlobalActionsMap(e){this.globalActionsMap=e}getGlobalActionsMap(){return this.globalActionsMap}setExperienceBehaviorMap(e){this.experienceBehaviorMap=e}getExperienceBehaviorMap(){return this.experienceBehaviorMap}getTemplateImpressionMap(){return this.templateImpressionMap}setReplacedElementsConfigMap(e){this.replacedElementsConfigMap=e}getReplacedElementsConfigMap(){return this.replacedElementsConfigMap}setDelayAppliedConfigMap(e){this.delayAppliedConfigMap=e}getDelayAppliedConfigMap(){return this.delayAppliedConfigMap}setActiveElementLoadObserverConfigMap(e){this.activeElementLoadObserverConfigMap=e}getActiveElementLoadObserverConfigMap(){return this.activeElementLoadObserverConfigMap}setElementsDuplicatedMap(e){this.elementsDuplicatedMap=e}getElementsDuplicatedMap(){return this.elementsDuplicatedMap}setElementReAddedObserver(e){this.elementReAddedObserver=e}getElementReAddedObserver(){return this.elementReAddedObserver}setRegisterToScrollEvents(e){this.registeredToScrollEvents=e}getRegisterToScrollEvents(){return this.registeredToScrollEvents}setMaxScrollDepth(e){this.maxScrollDepth=e}getMaxScrollDepth(){return this.maxScrollDepth}setPeriodicTimerId(e){this.periodicTimerId=e}getPeriodicTimerId(){return this.periodicTimerId}getPageClicks(){return this.pageClicks}incrementPageClicks(){this.pageClicks++}getLastTrackedPageProperties(){return this.lastTrackedPageProperties}setLastTrackedPageProperties(e){this.lastTrackedPageProperties=e}getTimerIds(){return this.timerIds}saveTimerId(e){this.timerIds.push(e)}apiTimeoutOccurred(e){this.apiTimedOut=e}hasApiTimedout(){return this.apiTimedOut}clearRunningTimers(){for(var e of this.timerIds)try{clearTimeout(e)}catch(e){console.error(e)}this.timerIds=[];try{this.getPeriodicTimerId()&&(clearInterval(this.getPeriodicTimerId()),this.setPeriodicTimerId(null))}catch(e){console.error(e)}}getRegEventHandlers(){return this.regEventHandlers}saveRegEventHandler(e){this.regEventHandlers.push(e)}getRegObserverHandlers(){return this.regObserverHandlers}saveRegObserverHandler(e){this.regObserverHandlers.push(e)}unRegEventHandlers(){for(var e of this.regEventHandlers)try{e.obj.removeEventListener?e.obj.removeEventListener(e.event,e.callback,!1):obj.detachEvent&&obj.detachEvent("on"+e.event,e.callback)}catch(e){console.error(e)}this.regEventHandlers=[]}unRegObservers(){for(var e of this.regObserverHandlers)try{e&&e.disconnect()}catch(e){console.error(e)}this.regObserverHandlers=[]}removeAllTemplates(){try{var e=document.querySelectorAll(".cfit-custom-template");for(var t of e)t.remove()}catch(e){console.error(e)}}}class _{constructor(e){this.properties=e.eventProperties,this.event_type=e.eventType;var t=window.location.hostname;if(t===cf_domain_url||t==="www."+cf_domain_url)t=cf_domain_url;else{for(var r="",i=0;i<cf_subdomains.length;i++){var s=cf_subdomains[i];if(t===s){r=s;break}if(!r&&s.includes("*")){var n=s.replace("*","");t.endsWith(n)&&(r=s)}}r.length>0&&(t=r)}this.event_customer_id=e.eventId.includes("|")?e.eventId:t+"|"+e.eventId,this.domain=e.eventId.includes("|")?e.eventId.split("|")[0]:t,this.name=this.event_customer_id.split("|")[1],this.insert_id=u()(),this.event_timestamp=(new Date).toISOString().replace("T"," ").replace('"',"").replace('"',""),this.session_id=null,this.last_page_duration=null,this.config_summary=[]}getEventProperties(){return this.properties}setEventProperties(e){this.properties=e}getEventType(){return this.event_type}getEventId(){return event_customer_id}validateBuild(e){return String(e.constructor)===String(_.Builder)}static buildCFEvent(e){try{var t=e.event;if(t&&t.length>0){var r=e.type&&e.type.length>0?e.type:"TRACK",i=new _.Builder(t).withEventType(r),s=e.properties;if(s)for(const e in s)s.hasOwnProperty(e)&&(i=i.withEventProperty(e,s[e]));return i.build()}}catch(e){console.error(e)}return null}static get Builder(){return class{constructor(e,t="TRACK"){this.eventId=e,this.eventType="PAGE"===t||"TRACK"===t||"SCREEN"===t||"CLICK"===t||"PAGE_UPDATE"===t||"FORM"===t||"TEMPLATE_VIEW"==t||"TEMPLATE_BUTTON_CLICK"===t?t:"TRACK",this.eventProperties={}}withEventId(e){return this.eventId=e,this}withEventType(e){return"PAGE"===e.toUpperCase()||"TRACK"===e.toUpperCase()||"SCREEN"===e.toUpperCase()||"REVENUE"===e.toUpperCase()||"SCROLL"===e.toUpperCase()||"TEMPLATE_VIEW"===e.toUpperCase()||"TEMPLATE_BUTTON_CLICK"===e.toUpperCase()||"PAGE_UPDATE"===e.toUpperCase()||"FORM"===e.toUpperCase()||"CLICK"===e.toUpperCase()?this.eventType=e.toUpperCase():this.eventType="TRACK",this}withEventTypePage(){return this.eventType="PAGE",this}withEventTypeScreen(){return this.eventType="SCREEN",this}withEventTypeClick(){return this.eventType="CLICK",this}withEventTypeTrack(){return this.eventType="TRACK",this}withEventTypePageUpdate(){return this.eventType="PAGE_UPDATE",this}withEventTypeRevenue(){return this.eventType="REVENUE",this}withEventProperty(e,t){return this.eventProperties[e]=t,this}withEventProperties(e){return this.eventProperties=e,this}build(){return new _(this)}}}}class f{constructor(e,t,r){this.api=t,this.cfRef=e,this.sharedPreferences=r,this.deviceType=this.sharedPreferences.getDeviceType(),this.sessionId=sessionStorage.getItem(this.sharedPreferences.getStorageKeyPrefix()+"session_id_"+this.sharedPreferences.getUserId()),this.events=sessionStorage.getItem(this.sharedPreferences.getStorageKeyPrefix()+"cftrack_eventsq_"+this.sharedPreferences.getUserId()),this.pageview_seq_number=0;var i=sessionStorage.getItem(this.sharedPreferences.getStorageKeyPrefix()+"pageview_seq_number_"+this.sharedPreferences.getUserId());i&&(this.pageview_seq_number=parseInt(i,10)),this.events?(this.events=JSON.parse(this.events),this.events||(this.events=[])):this.events=[];var s=this;try{w(document,"visibilitychange",(function(e){document.hidden?(s.sharedPreferences.pauseCurrentPageTime(),s.sendEvents(!0)):s.sharedPreferences.resumeCurrentPageTime()})),w(window,"pagehide",(function(e){s.cfRef.sendPageUpdates(!0),s.sendEvents(!0),s.cfRef.uninit()}))}catch(e){console.error(e)}}trackEvent(e,t=!1,r=!1){this.sharedPreferences.isPreviewMode()||null!=e&&null!=e&&(e.session_id=this.sessionId,"PAGE_UPDATE"==e.event_type||"FORM"==e.event_type?e.configs=this.sharedPreferences.getSessionConfigSummaryHistory():delete e.configs,"PAGE"==e.event_type?(e.last_page_duration=this.sharedPreferences.getLastPageDuration(),e.pageview_seq_number=this.pageview_seq_number++,sessionStorage.setItem(this.sharedPreferences.getStorageKeyPrefix()+"pageview_seq_number_"+this.sharedPreferences.getUserId(),this.pageview_seq_number)):delete e.last_page_duration,e.insert_id||(e.insert_id=u()()),e.event_timestamp||(e.event_timestamp=(new Date).toISOString().replace("T"," ").replace('"',"").replace('"',"")),e.properties.cf_last_page_url=this.sharedPreferences.getLastPageURL(),this.events.push(e),sessionStorage.setItem(this.sharedPreferences.getStorageKeyPrefix()+"cftrack_eventsq_"+this.sharedPreferences.getUserId(),JSON.stringify(this.events)),t?this.sendEvents(r):this.events.length>=this.sharedPreferences.getTrackQueueSize()&&this.sendEvents())}trackEventList(e,t=!1,r=!1){if(!this.sharedPreferences.isPreviewMode()&&e&&0!=e.length){for(var i of e)null!=i&&null!=i&&(i.session_id=this.sessionId,"PAGE"==i.event_type?(i.last_page_duration=this.sharedPreferences.getLastPageDuration(),i.pageview_seq_number=this.pageview_seq_number++,sessionStorage.setItem(this.sharedPreferences.getStorageKeyPrefix()+"pageview_seq_number_"+this.sharedPreferences.getUserId(),this.pageview_seq_number)):delete i.last_page_duration,i.insert_id||(i.insert_id=u()()),i.event_timestamp||(i.event_timestamp=(new Date).toISOString().replace("T"," ").replace('"',"").replace('"',"")),i.properties.cf_last_page_url=this.sharedPreferences.getLastPageURL(),this.events.push(i));sessionStorage.setItem(this.sharedPreferences.getStorageKeyPrefix()+"cftrack_eventsq_"+this.sharedPreferences.getUserId(),JSON.stringify(this.events)),t?this.sendEvents(r):this.events.length>=this.sharedPreferences.getTrackQueueSize()&&this.sendEvents()}}sendEvents(e=!1){if(!this.sharedPreferences.isPreviewMode()&&this.events.length>0){var t=sessionStorage.getItem(this.sharedPreferences.getStorageKeyPrefix()+"cftrack_eventsq_"+this.sharedPreferences.getUserId());null!=t&&t.length>0&&(t=JSON.parse(t),this.events=[],this.sharedPreferences.getUser().initHubspotUTKIfSet(),this.api.send("POST","/v1/cfe",{user:JSON.parse(JSON.stringify(this.sharedPreferences.getUser(),this.replaceUndefinedOrNull)),events:t,cf_client_sdk_version:cf_latest_sdk_version},e).then((e=>{sessionStorage.setItem(this.sharedPreferences.getStorageKeyPrefix()+"cftrack_eventsq_"+this.sharedPreferences.getUserId(),JSON.stringify(this.events))}),(e=>{cf_send_error_report&&e&&403!=e.status&&this.cfObj.reportError({message:"API /v1/cfe failed",cf_domain_url,error:e,href:window.location.href,position:"error"})})).catch((e=>{console.error(e)})))}}}class m{constructor(e,t,r,i){this.config_id=e.config_id,this.version=e.version,this.user_id=e.user_id,this.requested_time=(new Date).toISOString().replace("T"," ").replace('"',"").replace('"',""),this.variation_id=e.variation_id,this.user_customer_id=r,this.user_id=t,this.session_id=i,null!=e.experience_behaviour_response&&(this.behaviour_id=e.experience_behaviour_response.behaviour_id,this.experience_id=e.experience_behaviour_response.experience_id,this.rule_id=e.experience_behaviour_response.rule_id),e.template_info&&(this.is_template_config=!0)}}class g{constructor(e,t,r){this.cfObj=r,this.api=e,this.sharedPreferences=t,this.summaries=sessionStorage.getItem(this.sharedPreferences.getStorageKeyPrefix()+"cfconfigs_summaries_"+this.sharedPreferences.getUserId()),this.sessionId=sessionStorage.getItem(this.sharedPreferences.getStorageKeyPrefix()+"session_id_"+this.sharedPreferences.getUserId()),this.summaries?(this.summaries=JSON.parse(this.summaries),this.summaries||(this.summaries=[])):this.summaries=[];var i=this;try{w(document,"visibilitychange",(function(){document.hidden&&i.sendSummaries(!0)})),w(window,"beforeunload",(function(){i.sendSummaries(!0)}))}catch(e){console.error(e)}}pushSummary(e){this.sharedPreferences.isPreviewMode()||null==e&&null==e||(this.summaries.push(new m(e,this.sharedPreferences.getCFUserId(),this.sharedPreferences.getUserId(),this.sessionId)),sessionStorage.setItem(this.sharedPreferences.getStorageKeyPrefix()+"cfconfigs_summaries_"+this.sharedPreferences.getUserId(),JSON.stringify(this.summaries)),e.experience_behaviour_response&&e.experience_behaviour_response.experience_id&&this.sharedPreferences.getExperienceBehaviorMap().set(e.experience_behaviour_response.experience_id,e.experience_behaviour_response),this.summaries.length>=this.sharedPreferences.getConfigSummaryQueueSize()&&this.sendSummaries())}_queueSummary(e){this.sharedPreferences.isPreviewMode()||this.sharedPreferences.getExperienceBehaviorMap().get(e.experience_behaviour_response.experience_id)||null==e&&null==e||(this.summaries.push(new m(e,this.sharedPreferences.getCFUserId(),this.sharedPreferences.getUserId(),this.sessionId)),sessionStorage.setItem(this.sharedPreferences.getStorageKeyPrefix()+"cfconfigs_summaries_"+this.sharedPreferences.getUserId(),JSON.stringify(this.summaries)),e.experience_behaviour_response&&e.experience_behaviour_response.experience_id&&this.sharedPreferences.getExperienceBehaviorMap().set(e.experience_behaviour_response.experience_id,e.experience_behaviour_response))}sendSummaries(e=!1){if(!this.sharedPreferences.isPreviewMode()&&(this.sharedPreferences.getUser().initHubspotUTKIfSet(),this.summaries.length>0)){var t=sessionStorage.getItem(this.sharedPreferences.getStorageKeyPrefix()+"cfconfigs_summaries_"+this.sharedPreferences.getUserId());null!=t&&t.length>0&&(t=JSON.parse(t),this.sharedPreferences.setConfigSummaryHistory(this.sharedPreferences.getConfigSummaryHistory().concat(this.summaries)),this.summaries=[],this.api.send("POST","/v1/config/request/summary",{user:JSON.parse(JSON.stringify(this.sharedPreferences.getUser(),this.replaceUndefinedOrNull)),summaries:t},e).then((e=>{sessionStorage.setItem(this.sharedPreferences.getStorageKeyPrefix()+"cfconfigs_summaries_"+this.sharedPreferences.getUserId(),JSON.stringify(this.summaries))}),(e=>{cf_send_error_report&&e&&403!=e.status&&this.cfObj.reportError({message:"API /v1/config/request/summary failed",cf_domain_url,error:e,href:window.location.href,position:"error"})})).catch((e=>{console.error(e)}))),cf_send_error_report&&this.cfObj.track(new _.Builder("cf_summary_sent_3").withEventType("TRACK").build(),!0)}}}class v{constructor(e,t){function r(e,t,r,i,s,n){return a(function(e,t){return e<<t|e>>>32-t}(a(a(t,e),a(i,n)),s),r)}function i(e,t,i,s,n,o,a){return r(t&i|~t&s,e,t,n,o,a)}function s(e,t,i,s,n,o,a){return r(t&s|i&~s,e,t,n,o,a)}function n(e,t,i,s,n,o,a){return r(t^i^s,e,t,n,o,a)}function o(e,t,i,s,n,o,a){return r(i^(t|~s),e,t,n,o,a)}function a(e,t){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}this.user=null,this.api=null,this.preInitTrackMessages=[],this.actionConfigs=[],this.sendPageTrack=!0,this.personalize=!0,this.sharedPreferences=null,this.MD5=function(e){var t=function(e){for(var t,r="0123456789ABCDEF",i="",s=0;s<e.length;s++)t=e.charCodeAt(s),i+=r.charAt(t>>>4&15)+r.charAt(15&t);return i}(function(e){for(var t="",r=0;r<32*e.length;r+=8)t+=String.fromCharCode(e[r>>5]>>>r%32&255);return t}(function(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var r=1732584193,c=-271733879,l=-1732584194,u=271733878,d=0;d<e.length;d+=16){var p=r,h=c,_=l,f=u;c=o(c=o(c=o(c=o(c=n(c=n(c=n(c=n(c=s(c=s(c=s(c=s(c=i(c=i(c=i(c=i(c,l=i(l,u=i(u,r=i(r,c,l,u,e[d+0],7,-680876936),c,l,e[d+1],12,-389564586),r,c,e[d+2],17,606105819),u,r,e[d+3],22,-1044525330),l=i(l,u=i(u,r=i(r,c,l,u,e[d+4],7,-176418897),c,l,e[d+5],12,1200080426),r,c,e[d+6],17,-1473231341),u,r,e[d+7],22,-45705983),l=i(l,u=i(u,r=i(r,c,l,u,e[d+8],7,1770035416),c,l,e[d+9],12,-1958414417),r,c,e[d+10],17,-42063),u,r,e[d+11],22,-1990404162),l=i(l,u=i(u,r=i(r,c,l,u,e[d+12],7,1804603682),c,l,e[d+13],12,-40341101),r,c,e[d+14],17,-1502002290),u,r,e[d+15],22,1236535329),l=s(l,u=s(u,r=s(r,c,l,u,e[d+1],5,-165796510),c,l,e[d+6],9,-1069501632),r,c,e[d+11],14,643717713),u,r,e[d+0],20,-373897302),l=s(l,u=s(u,r=s(r,c,l,u,e[d+5],5,-701558691),c,l,e[d+10],9,38016083),r,c,e[d+15],14,-660478335),u,r,e[d+4],20,-405537848),l=s(l,u=s(u,r=s(r,c,l,u,e[d+9],5,568446438),c,l,e[d+14],9,-1019803690),r,c,e[d+3],14,-187363961),u,r,e[d+8],20,1163531501),l=s(l,u=s(u,r=s(r,c,l,u,e[d+13],5,-1444681467),c,l,e[d+2],9,-51403784),r,c,e[d+7],14,1735328473),u,r,e[d+12],20,-1926607734),l=n(l,u=n(u,r=n(r,c,l,u,e[d+5],4,-378558),c,l,e[d+8],11,-2022574463),r,c,e[d+11],16,1839030562),u,r,e[d+14],23,-35309556),l=n(l,u=n(u,r=n(r,c,l,u,e[d+1],4,-1530992060),c,l,e[d+4],11,1272893353),r,c,e[d+7],16,-155497632),u,r,e[d+10],23,-1094730640),l=n(l,u=n(u,r=n(r,c,l,u,e[d+13],4,681279174),c,l,e[d+0],11,-358537222),r,c,e[d+3],16,-722521979),u,r,e[d+6],23,76029189),l=n(l,u=n(u,r=n(r,c,l,u,e[d+9],4,-640364487),c,l,e[d+12],11,-421815835),r,c,e[d+15],16,530742520),u,r,e[d+2],23,-995338651),l=o(l,u=o(u,r=o(r,c,l,u,e[d+0],6,-198630844),c,l,e[d+7],10,1126891415),r,c,e[d+14],15,-1416354905),u,r,e[d+5],21,-57434055),l=o(l,u=o(u,r=o(r,c,l,u,e[d+12],6,1700485571),c,l,e[d+3],10,-1894986606),r,c,e[d+10],15,-1051523),u,r,e[d+1],21,-2054922799),l=o(l,u=o(u,r=o(r,c,l,u,e[d+8],6,1873313359),c,l,e[d+15],10,-30611744),r,c,e[d+6],15,-1560198380),u,r,e[d+13],21,1309151649),l=o(l,u=o(u,r=o(r,c,l,u,e[d+4],6,-145523070),c,l,e[d+11],10,-1120210379),r,c,e[d+2],15,718787259),u,r,e[d+9],21,-343485551),r=a(r,p),c=a(c,h),l=a(l,_),u=a(u,f)}return Array(r,c,l,u)}(function(e){for(var t=Array(e.length>>2),r=0;r<t.length;r++)t[r]=0;for(r=0;r<8*e.length;r+=8)t[r>>5]|=(255&e.charCodeAt(r/8))<<r%32;return t}(e),8*e.length)));return t.toLowerCase()}}reportError(e){try{if(!cf_send_error_report)return;this.track(new _.Builder("cf_get_user_configs_api_failed").withEventType("TRACK").build(),!0),fetch("https://api.customfit.ai/v1/alerts?cfenc="+cf_key,{method:"POST",body:JSON.stringify(e),headers:{Accept:"application/json","Content-Type":"application/json"}}).then((e=>e.text())).then((e=>{})).catch((e=>console.error(e)))}catch(e){console.error(e)}}replaceUndefinedOrNull(e,t){if(null!=t)return t}getUrlParameter(e){return new URLSearchParams(window.location.href.split("?")[1]).get(e)||""}isCustomFitEditModeEnabled(){return null!=window.frameElement&&"CustomFit editor"==window.frameElement.title||""!=this.getUrlParameter("utm_customfit_edit")}isNextJsSite(){try{if(window.__NEXT_DATA__)return!0;const e=Array.from(document.querySelectorAll("script[src]")),t=Array.from(document.querySelectorAll("link[href]")),r=e.find((e=>e.src.includes("_next"))),i=t.find((e=>e.href.includes("_next")));if(r||i)return!0;if(window.next)return!0}catch(e){console.error(e)}return!1}push(e,t=!1){try{if("USER_CONFIG_API_REQUEST_SENT"==this.sharedPreferences.getUserConfigAPICallState())this.preInitTrackMessages.push(e);else{var r=e.event;if(r&&r.length>0){var i=e.type&&e.type.length>0?e.type:"TRACK",s=new _.Builder(r).withEventType(i),n=e.properties;if(n)for(const e in n)n.hasOwnProperty(e)&&(s=s.withEventProperty(e,n[e]));this.track(s.build(),t)}}}catch(e){console.error(e)}return null}cleanseUser(e){var t=this.sharedPreferences.getStorageKeyPrefix();this.derivePropertiesFromQueryParams(e),this.deriveUTMParams(e),this.deriveUAParams(e),this.deriveBrowserVariables(e);var r=e.user_customer_id;if(r&&""!=r)e.sdk_generated_user_customer_id?e.sdk_generated_user_customer_id=!1:sessionStorage.getItem("customfit_preview")||(e.sdk_generated_user_customer_id=!1,localStorage.setItem(t+"cf_is_customer_id_sdk_generated",e.sdk_generated_user_customer_id),r!==localStorage.getItem(t+"cf_user_customer_id")&&localStorage.removeItem(t+"cf_user_device_id"));else{if(e.sdk_generated_user_customer_id=localStorage.getItem(t+"cf_is_customer_id_sdk_generated"),e.sdk_generated_user_customer_id||(e.sdk_generated_user_customer_id=!1),sessionStorage.getItem("customfit_preview"))r=sessionStorage.getItem(t+"cf_user_customer_id"),e.sdk_generated_user_customer_id=!1;else if(r=localStorage.getItem(t+"cf_user_customer_id"),cf_subdomains.length>0){var i=I(t+"cf_user_customer_id");r&&i&&i!=r&&(r=i)}r&&""!=r||(r=cf_subdomains.length>0&&(i=I(t+"cf_user_customer_id"))&&i.length>0?i:u()(),localStorage.removeItem(t+"cf_user_device_id"),localStorage.removeItem(t+"cf_customer_id_user_id"),e.sdk_generated_user_customer_id=!0,localStorage.setItem(t+"cf_is_customer_id_sdk_generated",e.sdk_generated_user_customer_id))}sessionStorage.getItem("customfit_preview")||(e.device_id=localStorage.getItem(t+"cf_user_device_id"),e.device_id||(e.device_id=u()())),e.user_customer_id=r;var s=localStorage.getItem(t+"cf_customer_id_user_id");if(s){var[n,o]=s.split("|");n==r&&o&&(e.user_id=o)}return this.sharedPreferences.setUserInfo(e),sessionStorage.getItem("customfit_preview")?(null==e.properties.is_first_time_visitor&&(sessionStorage.getItem(t+"cf_user_customer_id")?e.properties.is_first_time_visitor=!1:e.properties.is_first_time_visitor=!0),sessionStorage.setItem(t+"cf_user_customer_id",r)):(null==e.properties.is_repeated_visitor&&(localStorage.getItem(t+"cf_user_customer_id")?null==sessionStorage.getItem(t+"cf_is_first_time_visitor")?e.properties.is_first_time_visitor=!1:e.properties.is_first_time_visitor=!0:(e.properties.is_first_time_visitor=!0,sessionStorage.setItem(t+"cf_is_first_time_visitor",r))),localStorage.setItem(t+"cf_user_customer_id",r),localStorage.setItem("cfit_user_customer_id",r),localStorage.setItem("cfit_dimension_id",cf_dimension_id),cf_subdomains.length>0&&T(t+"cf_user_customer_id",r)),e}initCFUAParser(){var e,t,r,i,s,n,o,a,c,l,u,d,p,h;e="object"==typeof window?window:this,t="model",i="type",s="vendor",o="mobile",a="tablet",c="smarttv",l={extend:function(e,t){var r={};for(var i in e)t[i]&&t[i].length%2==0?r[i]=t[i].concat(e[i]):r[i]=e[i];return r},has:function(e,t){return"string"==typeof e&&-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()},major:function(e){return"string"==typeof e?e.replace(/[^\d\.]/g,"").split(".")[0]:void 0},trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},u={rgx:function(e,t){for(var r,i,s,n,o,a,c=0;c<t.length&&!o;){var l=t[c],u=t[c+1];for(r=i=0;r<l.length&&!o;)if(o=l[r++].exec(e))for(s=0;s<u.length;s++)a=o[++i],"object"==typeof(n=u[s])&&n.length>0?2==n.length?"function"==typeof n[1]?this[n[0]]=n[1].call(this,a):this[n[0]]=n[1]:3==n.length?"function"!=typeof n[1]||n[1].exec&&n[1].test?this[n[0]]=a?a.replace(n[1],n[2]):void 0:this[n[0]]=a?n[1].call(this,a,n[2]):void 0:4==n.length&&(this[n[0]]=a?n[3].call(this,a.replace(n[1],n[2])):void 0):this[n]=a||void 0;c+=2}},str:function(e,t){for(var r in t)if("object"==typeof t[r]&&t[r].length>0){for(var i=0;i<t[r].length;i++)if(l.has(t[r][i],e))return"?"===r?void 0:r}else if(l.has(t[r],e))return"?"===r?void 0:r;return e}},d={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},p={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[r="name",n="version"],[/(opios)[\/\s]+([\w\.]+)/i],[[r,"Opera Mini"],n],[/\s(opr)\/([\w\.]+)/i],[[r,"Opera"],n],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim)(?:browser)?[\/\s]?([\w\.]*)/i,/(bidubrowser|baidubrowser)[\/\s]?([\w\.]+)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]*)/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i],[r,n],[/(konqueror)\/([\w\.]+)/i],[[r,"Konqueror"],n],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[r,"IE"],n],[/(edge|edgios|edga|edg)\/((\d+)?[\w\.]+)/i],[[r,"Edge"],n],[/(yabrowser)\/([\w\.]+)/i],[[r,"Yandex"],n],[/(Avast)\/([\w\.]+)/i],[[r,"Avast Secure Browser"],n],[/(AVG)\/([\w\.]+)/i],[[r,"AVG Secure Browser"],n],[/(puffin)\/([\w\.]+)/i],[[r,"Puffin"],n],[/(focus)\/([\w\.]+)/i],[[r,"Firefox Focus"],n],[/(opt)\/([\w\.]+)/i],[[r,"Opera Touch"],n],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[r,"UCBrowser"],n],[/(comodo_dragon)\/([\w\.]+)/i],[[r,/_/g," "],n],[/(windowswechat qbcore)\/([\w\.]+)/i],[[r,"WeChat(Win) Desktop"],n],[/(micromessenger)\/([\w\.]+)/i],[[r,"WeChat"],n],[/(brave)\/([\w\.]+)/i],[[r,"Brave"],n],[/(qqbrowserlite)\/([\w\.]+)/i],[r,n],[/(QQ)\/([\d\.]+)/i],[r,n],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[r,n],[/(baiduboxapp)[\/\s]?([\w\.]+)/i],[r,n],[/(2345Explorer)[\/\s]?([\w\.]+)/i],[r,n],[/(MetaSr)[\/\s]?([\w\.]+)/i],[r],[/(LBBROWSER)/i],[r],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[n,[r,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[n,[r,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/android.+(line)\/([\w\.]+)\/iab/i],[r,n],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[n,[r,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[r,/(.+)/,"$1 WebView"],n],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[r,/(.+(?:g|us))(.+)/,"$1 $2"],n],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[n,[r,"Android Browser"]],[/(sailfishbrowser)\/([\w\.]+)/i],[[r,"Sailfish Browser"],n],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[r,n],[/(dolfin)\/([\w\.]+)/i],[[r,"Dolphin"],n],[/(qihu|qhbrowser|qihoobrowser|360browser)/i],[[r,"360 Browser"]],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[r,"Chrome"],n],[/(coast)\/([\w\.]+)/i],[[r,"Opera Coast"],n],[/fxios\/([\w\.-]+)/i],[n,[r,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[n,[r,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[n,r],[/webkit.+?(gsa)\/([\w\.]+).+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[[r,"GSA"],n],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[r,[n,u.str,d.browser.oldsafari.version]],[/(webkit|khtml)\/([\w\.]+)/i],[r,n],[/(navigator|netscape)\/([\w\.-]+)/i],[[r,"Netscape"],n],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[r,n]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[["architecture","amd64"]],[/(ia32(?=;))/i],[["architecture",l.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[["architecture","ia32"]],[/windows\s(ce|mobile);\sppc;/i],[["architecture","arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[["architecture",/ower/,"",l.lowerize]],[/(sun4\w)[;\)]/i],[["architecture","sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+[;l]))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[["architecture",l.lowerize]]],device:[[/\((ipad|playbook);[\w\s\),;-]+(rim|apple)/i],[t,s,[i,a]],[/applecoremedia\/[\w\.]+ \((ipad)/],[t,[s,"Apple"],[i,a]],[/(apple\s{0,1}tv)/i],[[t,"Apple TV"],[s,"Apple"],[i,c]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[s,t,[i,a]],[/(kf[A-z]+)\sbuild\/.+silk\//i],[t,[s,"Amazon"],[i,a]],[/(sd|kf)[0349hijorstuw]+\sbuild\/.+silk\//i],[[t,u.str,d.device.amazon.model],[s,"Amazon"],[i,o]],[/android.+aft([bms])\sbuild/i],[t,[s,"Amazon"],[i,c]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[t,s,[i,o]],[/\((ip[honed|\s\w*]+);/i],[t,[s,"Apple"],[i,o]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[s,t,[i,o]],[/\(bb10;\s(\w+)/i],[t,[s,"BlackBerry"],[i,o]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone|p00c)/i],[t,[s,"Asus"],[i,a]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[s,"Sony"],[t,"Xperia Tablet"],[i,a]],[/android.+\s([c-g]\d{4}|so[-l]\w+)(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[t,[s,"Sony"],[i,o]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[s,t,[i,"console"]],[/android.+;\s(shield)\sbuild/i],[t,[s,"Nvidia"],[i,"console"]],[/(playstation\s[34portablevi]+)/i],[t,[s,"Sony"],[i,"console"]],[/(sprint\s(\w+))/i],[[s,u.str,d.device.sprint.vendor],[t,u.str,d.device.sprint.model],[i,o]],[/(htc)[;_\s-]+([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[s,[t,/_/g," "],[i,o]],[/(nexus\s9)/i],[t,[s,"HTC"],[i,a]],[/d\/huawei([\w\s-]+)[;\)]/i,/(nexus\s6p|vog-l29|ane-lx1|eml-l29|ele-l29)/i],[t,[s,"Huawei"],[i,o]],[/android.+(bah2?-a?[lw]\d{2})/i],[t,[s,"Huawei"],[i,a]],[/(microsoft);\s(lumia[\s\w]+)/i],[s,t,[i,o]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[t,[s,"Microsoft"],[i,"console"]],[/(kin\.[onetw]{3})/i],[[t,/\./g," "],[s,"Microsoft"],[i,o]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w*)/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[t,[s,"Motorola"],[i,o]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[t,[s,"Motorola"],[i,a]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[s,l.trim],[t,l.trim],[i,c]],[/hbbtv.+maple;(\d+)/i],[[t,/^/,"SmartTV"],[s,"Samsung"],[i,c]],[/\(dtv[\);].+(aquos)/i],[t,[s,"Sharp"],[i,c]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[s,"Samsung"],t,[i,a]],[/smart-tv.+(samsung)/i],[s,[i,c],t],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)/i,/sec-((sgh\w+))/i],[[s,"Samsung"],t,[i,o]],[/sie-(\w*)/i],[t,[s,"Siemens"],[i,o]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]*)/i],[[s,"Nokia"],t,[i,o]],[/android[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[t,[s,"Acer"],[i,a]],[/android.+([vl]k\-?\d{3})\s+build/i],[t,[s,"LG"],[i,a]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[s,"LG"],t,[i,a]],[/(lg) netcast\.tv/i],[s,t,[i,c]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w*)/i,/android.+lg(\-?[\d\w]+)\s+build/i],[t,[s,"LG"],[i,o]],[/(lenovo)\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+))/i],[s,t,[i,a]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[t,[s,"Lenovo"],[i,a]],[/(lenovo)[_\s-]?([\w-]+)/i],[s,t,[i,o]],[/linux;.+((jolla));/i],[s,t,[i,o]],[/((pebble))app\/[\d\.]+\s/i],[s,t,[i,"wearable"]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[s,t,[i,o]],[/crkey/i],[[t,"Chromecast"],[s,"Google"],[i,c]],[/android.+;\s(glass)\s\d/i],[t,[s,"Google"],[i,"wearable"]],[/android.+;\s(pixel c)[\s)]/i],[t,[s,"Google"],[i,a]],[/android.+;\s(pixel( [23])?( xl)?)[\s)]/i],[t,[s,"Google"],[i,o]],[/android.+;\s(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:a\d|one|one[\s_]plus|note lte)?[\s_]*(?:\d?\w?)[\s_]*(?:plus)?)\s+build/i,/android.+(redmi[\s\-_]*(?:note)?(?:[\s_]*[\w\s]+))\s+build/i],[[t,/_/g," "],[s,"Xiaomi"],[i,o]],[/android.+(mi[\s\-_]*(?:pad)(?:[\s_]*[\w\s]+))\s+build/i],[[t,/_/g," "],[s,"Xiaomi"],[i,a]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[t,[s,"Meizu"],[i,o]],[/(mz)-([\w-]{2,})/i],[[s,"Meizu"],t,[i,o]],[/android.+a000(1)\s+build/i,/android.+oneplus\s(a\d{4})[\s)]/i],[t,[s,"OnePlus"],[i,o]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[t,[s,"RCA"],[i,a]],[/android.+[;\/\s]+(Venue[\d\s]{2,7})\s+build/i],[t,[s,"Dell"],[i,a]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[t,[s,"Verizon"],[i,a]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[s,"Barnes & Noble"],t,[i,a]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[t,[s,"NuVision"],[i,a]],[/android.+;\s(k88)\sbuild/i],[t,[s,"ZTE"],[i,a]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[t,[s,"Swiss"],[i,o]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[t,[s,"Swiss"],[i,a]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[t,[s,"Zeki"],[i,a]],[/(android).+[;\/]\s+([YR]\d{2})\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(\w{5})\sbuild/i],[[s,"Dragon Touch"],t,[i,a]],[/android.+[;\/]\s*(NS-?\w{0,9})\sbuild/i],[t,[s,"Insignia"],[i,a]],[/android.+[;\/]\s*((NX|Next)-?\w{0,9})\s+build/i],[t,[s,"NextBook"],[i,a]],[/android.+[;\/]\s*(Xtreme\_)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[s,"Voice"],t,[i,o]],[/android.+[;\/]\s*(LVTEL\-)?(V1[12])\s+build/i],[[s,"LvTel"],t,[i,o]],[/android.+;\s(PH-1)\s/i],[t,[s,"Essential"],[i,o]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[t,[s,"Envizen"],[i,a]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(\w{1,9})\s+build/i],[s,t,[i,a]],[/android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i],[t,[s,"MachSpeed"],[i,a]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[s,t,[i,a]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[t,[s,"Rotor"],[i,a]],[/android.+(KS(.+))\s+build/i],[t,[s,"Amazon"],[i,a]],[/android.+(Gigaset)[\s\-]+(Q\w{1,9})\s+build/i],[s,t,[i,a]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[i,l.lowerize],s,t],[/[\s\/\(](smart-?tv)[;\)]/i],[[i,c]],[/(android[\w\.\s\-]{0,9});.+build/i],[t,[s,"Generic"]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[n,[r,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[n,[r,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[r,n],[/rv\:([\w\.]{1,9}).+(gecko)/i],[n,r]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[r,n],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[r,[n,u.str,d.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[r,"Windows"],[n,u.str,d.os.windows.version]],[/\((bb)(10);/i],[[r,"BlackBerry"],n],[/(blackberry)\w*\/?([\w\.]*)/i,/(tizen|kaios)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|sailfish|contiki)[\/\s-]?([\w\.]*)/i],[r,n],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]*)/i],[[r,"Symbian"],n],[/\((series40);/i],[r],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[r,"Firefox OS"],n],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i],[r,n],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[r,"Chromium OS"],n],[/(sunos)\s?([\w\.\d]*)/i],[[r,"Solaris"],n],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]*)/i],[r,n],[/(haiku)\s(\w+)/i],[r,n],[/cfnetwork\/.+darwin/i,/ip[honead]{2,4}(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],[[n,/_/g,"."],[r,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)/i],[[r,"Mac OS"],[n,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[r,n]]},h=function(t,r){if("object"==typeof t&&(r=t,t=void 0),!(this instanceof h))return new h(t,r).getResult();var i=t||(e&&e.navigator&&e.navigator.userAgent?e.navigator.userAgent:""),s=r?l.extend(p,r):p;return this.getBrowser=function(){var e={name:void 0,version:void 0};return u.rgx.call(e,i,s.browser),e.major=l.major(e.version),e},this.getCPU=function(){var e={architecture:void 0};return u.rgx.call(e,i,s.cpu),e},this.getDevice=function(){var e={vendor:void 0,model:void 0,type:void 0};return u.rgx.call(e,i,s.device),e},this.getEngine=function(){var e={name:void 0,version:void 0};return u.rgx.call(e,i,s.engine),e},this.getOS=function(){var e={name:void 0,version:void 0};return u.rgx.call(e,i,s.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return i},this.setUA=function(e){return i=e,this},this},h.VERSION="0.7.21",h.BROWSER={NAME:r,MAJOR:"major",VERSION:n},h.CPU={ARCHITECTURE:"architecture"},h.DEVICE={MODEL:t,VENDOR:s,TYPE:i,CONSOLE:"console",MOBILE:o,SMARTTV:c,TABLET:a,WEARABLE:"wearable",EMBEDDED:"embedded"},h.ENGINE={NAME:r,VERSION:n},h.OS={NAME:r,VERSION:n},this.CFUAParser=h}deriveBrowserVariables(e){try{if(!cf_browser_variables)return;var t={},r=[];if(cf_browser_variables.local_storage&&cf_browser_variables.local_storage.length>0){var i={};for(var s of cf_browser_variables.local_storage)try{var[n,o]=s.split(".");if(l=localStorage.getItem(n)){try{l=JSON.parse(l)}catch(e){}o&&(l=l.hasOwnProperty(o)?l[o]:null),null!==l&&(i[n]=o?{[o]:l}:l,r.push("cf_browser_variables.local_storage."+n))}}catch(e){console.log(e)}Object.keys(i).length>0&&(t.local_storage=i)}if(cf_browser_variables.session_storage&&cf_browser_variables.session_storage.length>0){var a={};for(var s of cf_browser_variables.session_storage)try{var[n,o]=s.split(".");if(l=sessionStorage.getItem(n)){try{l=JSON.parse(l)}catch(e){}o&&(l=l.hasOwnProperty(o)?l[o]:null),null!==l&&(a[n]=o?{[o]:l}:l,r.push("cf_browser_variables.session_storage."+n))}}catch(e){console.log(e)}Object.keys(a).length>0&&(t.session_storage=a)}if(cf_browser_variables.cookie_storage&&cf_browser_variables.cookie_storage.length>0){var c={};for(var s of cf_browser_variables.cookie_storage)try{var l,[n,o]=s.split(".");if(l=I(n)){try{l=JSON.parse(l)}catch(e){}o&&(l=l.hasOwnProperty(o)?l[o]:null),null!==l&&(c[n]=o?{[o]:l}:l,r.push("cf_browser_variables.cookie_storage."+n))}}catch(e){console.log(e)}Object.keys(c).length>0&&(t.cookie_storage=c)}if(cf_browser_variables.js_variables&&cf_browser_variables.js_variables.length>0){var u={};for(var s of cf_browser_variables.js_variables)try{var d=(_=s.split("."))[0],p=_[1];null!=(f="window"===d?window[p]:window[d])&&null!=f&&(u[s]=f,r.push("cf_browser_variables.js_variables."+s))}catch(e){console.log(e)}Object.keys(u).length>0&&(t.js_variables=u)}if(cf_browser_variables.data_layer_storage&&cf_browser_variables.data_layer_storage.length>0&&window.dataLayer&&window.dataLayer.length>0){var h={};for(var s of cf_browser_variables.data_layer_storage)try{var _=s.split("."),f=window.dataLayer[0],m=!1;for(var g of _)if("window"!=g){if(!f[g])break;f=f[g],m=!0}m&&(h[s]=f,r.push("cf_browser_variables.data_layer_storage."+s))}catch(e){console.log(e)}Object.keys(h).length>0&&(t.data_layer_storage=h)}Object.keys(t).length>0&&(e.properties.cf_browser_variables=t,e.session_fields.properties=e.session_fields.properties.concat(r))}catch(e){console.log(e)}}deriveUAParams(e){try{if(!this.captureDeviceInfo)return;var t=this.sharedPreferences.getStorageKeyPrefix(),r={},i=sessionStorage.getItem(t+"ua_"+e.user_customer_id);if(i&&i.length>0?r=JSON.parse(i):(this.initCFUAParser(),r=(new this.CFUAParser).getResult(),sessionStorage.setItem(t+"ua_"+e.user_customer_id,JSON.stringify(r))),r.browser){r.browser.name&&r.browser.name.length>0&&(e.properties.cf_browser_name=r.browser.name),r.browser.version&&r.browser.version.length>0&&(e.properties.cf_browser_version=r.browser.version);var s=navigator.languages;s&&s.length>0&&(e.properties.cf_browser_preferred_languages=s);var n=navigator.language||navigator.userLanguage;n&&n.length>0&&(e.properties.cf_browser_primary_language=n)}r.os&&(r.os.name&&r.os.name.length>0&&(e.properties.cf_os_name=r.os.name),r.os.version&&r.os.version.length>0&&(e.properties.cf_os_version=r.os.version)),r.device&&(r.device.model&&r.device.model.length>0&&(e.properties.cf_device_model=r.device.model),r.device.type&&r.device.type.length>0&&(e.properties.cf_device_type=r.device.type),r.device.vendor&&r.device.vendor.length>0&&(e.properties.cf_device_vendor=r.device.vendor)),e.properties.cf_device_type&&""!=e.properties.cf_device_type||(e.properties.cf_device_type="desktop"),this.sharedPreferences.setDeviceType(e.properties.cf_device_type),r.cpu&&r.cpu.architecture&&r.cpu.architecture.length>0&&(e.properties.cf_cpu_architecture=r.cpu.architecture),r.ua&&r.ua.length>0&&(e.properties.cf_ua=r.ua),screen.height&&(e.properties.cf_screen_height=screen.height),screen.width&&(e.properties.cf_screen_width=screen.width);var o=sessionStorage.getItem(t+"referrer_"+e.user_customer_id);if(o){e.properties.referrer_url=o;const t=new URL(o);e.properties.referrer=t.host}else if((o=document.referrer)&&""!=o&&0!==o.indexOf(location.protocol+"//"+location.host)){sessionStorage.setItem(t+"referrer_"+e.user_customer_id,o),e.properties.referrer_url=o;const r=new URL(o);e.properties.referrer=r.host}else e.properties.referrer="",e.properties.referrer_url=""}catch(e){console.log(e)}}deriveUTMParams(e){var t=this.sharedPreferences.getStorageKeyPrefix();try{!e.utm_source&&this.getUrlParameter("utm_source")?(e.properties.utm_source=this.getUrlParameter("utm_source"),sessionStorage.setItem(t+"utm_source_"+e.user_customer_id,e.properties.utm_source),e.properties.session_utm_source=e.properties.utm_source,e.session_fields.properties.push("session_utm_source")):sessionStorage.getItem(t+"utm_source_"+e.user_customer_id)?(e.properties.utm_source=sessionStorage.getItem(t+"utm_source_"+e.user_customer_id),e.properties.session_utm_source=e.properties.utm_source,e.session_fields.properties.push("session_utm_source")):e.utm_source&&sessionStorage.setItem(t+"utm_source_"+e.user_customer_id,e.properties.utm_source),!e.utm_campaign&&this.getUrlParameter("utm_campaign")?(e.properties.utm_campaign=this.getUrlParameter("utm_campaign"),sessionStorage.setItem(t+"utm_campaign_"+e.user_customer_id,e.properties.utm_campaign),e.properties.session_utm_campaign=e.properties.utm_campaign,e.session_fields.properties.push("session_utm_campaign")):sessionStorage.getItem(t+"utm_campaign_"+e.user_customer_id)?(e.properties.utm_campaign=sessionStorage.getItem(t+"utm_campaign_"+e.user_customer_id),e.properties.session_utm_campaign=e.properties.utm_campaign,e.session_fields.properties.push("session_utm_campaign")):e.utm_campaign&&sessionStorage.setItem(t+"utm_campaign_"+e.user_customer_id,e.properties.utm_campaign),!e.utm_term&&this.getUrlParameter("utm_term")?(e.properties.utm_term=this.getUrlParameter("utm_term"),sessionStorage.setItem(t+"utm_term_"+e.user_customer_id,e.properties.utm_term),e.properties.session_utm_term=e.properties.utm_term,e.session_fields.properties.push("session_utm_term")):!e.utm_term&&sessionStorage.getItem(t+"utm_term_"+e.user_customer_id)?(e.properties.utm_term=sessionStorage.getItem(t+"utm_term_"+e.user_customer_id),e.properties.session_utm_term=e.properties.utm_term,e.session_fields.properties.push("session_utm_term")):e.utm_term&&sessionStorage.setItem(t+"utm_term_"+e.user_customer_id,e.properties.utm_term),!e.utm_content&&this.getUrlParameter("utm_content")?(e.properties.utm_content=this.getUrlParameter("utm_content"),sessionStorage.setItem(t+"utm_content_"+e.user_customer_id,e.properties.utm_content),e.properties.session_utm_content=e.properties.utm_content,e.session_fields.properties.push("session_utm_content")):!e.utm_content&&sessionStorage.getItem(t+"utm_content_"+e.user_customer_id)?(e.properties.utm_content=sessionStorage.getItem(t+"utm_content_"+e.user_customer_id),e.properties.session_utm_content=e.properties.utm_content,e.session_fields.properties.push("session_utm_content")):e.utm_content&&sessionStorage.setItem(t+"utm_content_"+e.user_customer_id,e.properties.utm_medium),!e.utm_medium&&this.getUrlParameter("utm_medium")?(e.properties.utm_medium=this.getUrlParameter("utm_medium"),sessionStorage.setItem(t+"utm_medium_"+e.user_customer_id,e.properties.utm_medium),e.properties.session_utm_medium=e.properties.utm_medium,e.session_fields.properties.push("session_utm_medium")):!e.utm_medium&&sessionStorage.getItem(t+"utm_medium_"+e.user_customer_id)?(e.properties.utm_medium=sessionStorage.getItem(t+"utm_medium_"+e.user_customer_id),e.properties.session_utm_medium=e.properties.utm_medium,e.session_fields.properties.push("session_utm_medium")):e.utm_medium&&sessionStorage.setItem(t+"utm_medium_"+e.user_customer_id,e.properties.utm_medium),!e.utm_adgroup&&this.getUrlParameter("utm_adgroup")?(e.properties.utm_adgroup=this.getUrlParameter("utm_adgroup"),sessionStorage.setItem(t+"utm_adgroup_"+e.user_customer_id,e.properties.utm_adgroup),e.properties.session_utm_adgroup=e.properties.utm_adgroup,e.session_fields.properties.push("session_utm_adgroup")):!e.utm_adgroup&&sessionStorage.getItem(t+"utm_adgroup_"+e.user_customer_id)?(e.properties.utm_adgroup=sessionStorage.getItem(t+"utm_adgroup_"+e.user_customer_id),e.properties.session_utm_adgroup=e.properties.utm_adgroup,e.session_fields.properties.push("session_utm_adgroup")):e.utm_adgroup&&sessionStorage.setItem(t+"utm_adgroup_"+e.user_customer_id,e.properties.utm_adgroup),!e.fbclid&&this.getUrlParameter("fbclid")?(e.properties.fbclid=this.getUrlParameter("fbclid"),sessionStorage.setItem(t+"fbclid_"+e.user_customer_id,e.properties.fbclid),e.properties.session_fbclid=e.properties.fbclid,e.session_fields.properties.push("session_fbclid")):!e.fbclid&&sessionStorage.getItem(t+"fbclid_"+e.user_customer_id)?(e.properties.fbclid=sessionStorage.getItem(t+"fbclid_"+e.user_customer_id),e.properties.session_fbclid=e.properties.fbclid,e.session_fields.properties.push("session_fbclid")):e.fbclid&&sessionStorage.setItem(t+"fbclid_"+e.user_customer_id,e.properties.fbclid),!e.gclid&&this.getUrlParameter("gclid")?(e.properties.gclid=this.getUrlParameter("gclid"),sessionStorage.setItem(t+"gclid_"+e.user_customer_id,e.properties.gclid),e.properties.session_gclid=e.properties.gclid,e.session_fields.properties.push("session_gclid")):!e.gclid&&sessionStorage.getItem(t+"gclid_"+e.user_customer_id)?(e.properties.gclid=sessionStorage.getItem(t+"gclid_"+e.user_customer_id),e.properties.session_gclid=e.properties.gclid,e.session_fields.properties.push("session_gclid")):e.gclid&&sessionStorage.setItem(t+"gclid_"+e.user_customer_id,e.properties.gclid)}catch(e){console.log(e)}}derivePropertiesFromQueryParams(e){var t=this.sharedPreferences.getStorageKeyPrefix(),r=[],i=[],s=[],n=[],o=[],a=this.sharedPreferences.getLongUrlParams(),c=location.search;null!=c&&c.length>0&&a&&a.length>0?c=c+"&"+a:null!=c&&0==c.length&&a&&a.length>0&&(c="?"+a);try{const a=new URLSearchParams(c),b=new URLSearchParams(c);var l=!1;for(let t of b)if(t[0]&&t[0].startsWith("cfup_"))"user_customer_id"===(u=t[0].substr(5))?(e.user_customer_id=t[1],a.delete(t[0]),l=!0):u&&u.length>0&&t[1]&&t[1].length>0&&(e.properties[u]=t[1],a.delete(t[0]),l=!0);else if(t[0]&&t[0].startsWith("cfupp_"))(u=t[0].substr(6))&&u.length>0&&t[1]&&t[1].length>0&&(e.properties[u]=t[1],-1===e.private_fields.properties.indexOf(u)&&(i.push({key:u,value:t[1]}),e.private_fields.properties.push(u)),a.delete(t[0]),l=!0);else if(t[0]&&t[0].startsWith("cfuhp_"))(u=t[0].substr(6))&&u.length>0&&t[1]&&t[1].length>0&&(e.properties[u]=t[1],-1===e.hs_fields.indexOf(u)&&(s.push({key:u,value:t[1]}),e.hs_fields.push(u)),a.delete(t[0]),l=!0);else if(t[0]&&t[0].startsWith("cfusp_")){var u;(u=t[0].substr(6))&&u.length>0&&t[1]&&t[1].length>0&&(e.properties[u]=t[1],-1===e.session_fields.properties.indexOf(u)&&(r.push({key:u,value:t[1]}),e.session_fields.properties.push(u)),a.delete(t[0]),l=!0)}else t[0]&&"cfut"==t[0]?t[1]&&t[1].length>0&&(e.tags=t[1].split(","),a.delete(t[0]),l=!0):t[0]&&"cfupt"==t[0]?t[1]&&t[1].length>0&&(e.private_fields.tags=t[1].split(","),o=e.private_fields.tags,a.delete(t[0]),l=!0):t[0]&&"cfust"==t[0]?t[1]&&t[1].length>0&&(e.session_fields.tags=t[1].split(","),n=e.session_fields.tags,a.delete(t[0]),l=!0):t[0]&&"customfit_desired_experiences"===t[0]?(this.sharedPreferences.setDesiredExperiences(t[1]),a.delete(t[0]),l=!0):t[0]&&"customfit_preferred_experiences"===t[0]?(this.sharedPreferences.setPreferredExperiences(t[1]),a.delete(t[0]),l=!0):t[0]&&"cfid"===t[0]?(this.sharedPreferences.setTinyID(t[1]),a.delete(t[0]),l=!0):t[0]&&"cfsid"===t[0]?this.sharedPreferences.setTinyID(t[1]):t[0]&&"email"===t[0]?(e.properties[t[0]]=t[1],l=!0):t[0]&&"cf_redirected"===t[0]&&this.sharedPreferences.setPageRedirected(!0);if(l)try{a.toString().length>0?window.history.replaceState({},document.title,window.location.pathname+"?"+a.toString()):window.history.replaceState({},document.title,window.location.pathname),this.sharedPreferences.setCurrentPageURL(window.location.href)}catch(e){}var d=sessionStorage.getItem(t+"private_fields_");if(d)for(var p of JSON.parse(d))-1===e.private_fields.properties.indexOf(p.key)&&(e.properties[p.key]=p.value,e.private_fields.properties.push(p.key),i.push(p));i.length>0&&sessionStorage.setItem(t+"private_fields_",JSON.stringify(i));var h=sessionStorage.getItem(t+"private_tags_");if(h)for(var _ of JSON.parse(h))e.private_fields.tags.push(_);o.length>0&&sessionStorage.setItem(t+"private_tags_",JSON.stringify(o));var f=sessionStorage.getItem(t+"hs_fields_");if(f)for(var m of JSON.parse(f))e.properties[m.key]=m.value,e.hs_fields.push(m.key),s.push(m);s.length>0&&sessionStorage.setItem(t+"hs_fields_",JSON.stringify(s));var g=sessionStorage.getItem(t+"session_fields_");if(g)for(var v of JSON.parse(g))-1===e.session_fields.properties.indexOf(v.key)&&(e.properties[v.key]=v.value,e.session_fields.properties.push(v.key),r.push(v));r.length>0&&sessionStorage.setItem(t+"session_fields_",JSON.stringify(r));var y=sessionStorage.getItem(t+"session_tags_");if(y)for(var w of JSON.parse(y))e.session_fields.tags.push(w);n.length>0&&sessionStorage.setItem(t+"session_tags_",JSON.stringify(n)),e.properties.cf_current_page_url=window.location.href,e.session_fields.properties.push("cf_current_page_url")}catch(e){console.log(e)}}getCurrentPageScrollPercentage(){try{var e=document.documentElement,t=document.body,r="scrollTop",i="scrollHeight",s=e[r]||t[r],n=(e[i]||t[i])-e.clientHeight;return 0==n?0:s/n*100}catch(e){return 0}}getUser(){try{return this.sharedPreferences.getUser()}catch(e){return null}}updateUser(e,t=!1){return new Promise(((r,i)=>{try{if(this.isCustomFitEditModeEnabled())return void i();if(this.getUrlParameter("customfit_preview")||sessionStorage.getItem("customfit_preview"))return void i();if(e&&(this.user=this.cleanseUser(e),this.sharedPreferences.setUserInfo(this.user)),1==cf_is_outbound&&0==cf_is_inbound&&!this.sharedPreferences.getLongUrlParams()&&!this.sharedPreferences.getTinyId()&&!this.sharedPreferences.isOutboudUser())return console.log("CustomFit.ai is enabled for only outbound campaigns. Reach out to support(reach@customfit.ai) for upgradation"),void i();this.sharedPreferences.getUser().initHubspotUTKIfSet();var s="";if(!this.maintainSession){var n=this.sharedPreferences.getMatchedPagePath();s=n&&n.length>0&n.includes("?")?n:P().length>1?P().replace(/\/$/,""):P()}this.sharedPreferences.setUserConfigAPICallState("USER_CONFIG_API_REQUEST_SENT"),this.api.send("POST","/v1/users/configs",{user:JSON.parse(JSON.stringify(this.user,this.replaceUndefinedOrNull)),desired_experiences:this.sharedPreferences.getDesiredExperiences(),preferred_experiences:this.sharedPreferences.getPreferredExperiences(),cfid:this.sharedPreferences.getTinyId(),preview_mode:this.sharedPreferences.isPreviewMode(),current_page_path:s,current_domain:S(),session_id:this.user.latest_session_id},t).then((e=>{this.sharedPreferences.setUserConfigAPICallState("USER_CONFIG_API_RESPONSE_RCVD"),r()}),(e=>{this.sharedPreferences.setUserConfigAPICallState("USER_CONFIG_ERROR_RESPONSE_RCVD"),console.log("CustomFit.ai Error status:"+e.status),console.log("CustomFit.ai Error message:"+e.message),console.log("CustomFit.ai Error data:"+JSON.stringify(e.data)),r()})).catch((e=>{this.sharedPreferences.setUserConfigAPICallState("USER_CONFIG_ERROR_RESPONSE_RCVD"),r()}))}catch(e){console.log(e),r()}}))}getExperienceConfigs(e,t,r){return new Promise(((t,i)=>{try{if(this.isCustomFitEditModeEnabled())return void i();if(this.getUrlParameter("customfit_preview")||sessionStorage.getItem("customfit_preview"))return void i();if(r&&(this.user=this.cleanseUser(r),this.sharedPreferences.setUserInfo(this.user)),1==cf_is_outbound&&0==cf_is_inbound&&!this.sharedPreferences.getLongUrlParams()&&!this.sharedPreferences.getTinyId()&&!this.sharedPreferences.isOutboudUser())return console.log("CustomFit.ai is enabled for only outbound campaigns. Reach out to support(reach@customfit.ai) for upgradation"),void i();this.sharedPreferences.getUser().initHubspotUTKIfSet();var s="";if(!this.maintainSession){var n=this.sharedPreferences.getMatchedPagePath();s=n&&n.length>0&n.includes("?")?n:P().length>1?P().replace(/\/$/,""):P()}this.sharedPreferences.setUserConfigAPICallState("USER_CONFIG_API_REQUEST_SENT"),this.api.send("POST","/v1/users/configs",{user:JSON.parse(JSON.stringify(this.user,this.replaceUndefinedOrNull)),desired_experiences:this.sharedPreferences.getDesiredExperiences(),preferred_experiences:e,cfid:this.sharedPreferences.getTinyId(),preview_mode:this.sharedPreferences.isPreviewMode(),current_page_path:s,session_id:this.user.latest_session_id},!1).then((r=>{if(this.sharedPreferences.setUserConfigAPICallState("USER_CONFIG_API_RESPONSE_RCVD"),r){var i={};if(r.configs)for(var s in r.configs)if(r.configs.hasOwnProperty(s)&&r.configs[s].experience_behaviour_response&&r.configs[s].experience_behaviour_response.experience_id)if(e&&e.length>0){var n=!1;for(var o of e)if(o==r.configs[s].experience_behaviour_response.experience_id){n=!0;break}n&&(i[s]=r.configs[s])}else i[s]=r.configs[s];t(i)}else t()}),(e=>{console.log("CustomFit.ai Error status:"+e.status),console.log("CustomFit.ai Error message:"+e.message),console.log("CustomFit.ai Error data:"+JSON.stringify(e.data)),this.sharedPreferences.setUserConfigAPICallState("USER_CONFIG_ERROR_RESPONSE_RCVD"),i()})).catch((e=>{this.sharedPreferences.setUserConfigAPICallState("USER_CONFIG_ERROR_RESPONSE_RCVD"),i()}))}catch(e){console.log(e),i()}}))}refreshConfigs(e){return new Promise(((t,r)=>{try{if(this.isCustomFitEditModeEnabled())return console.log("CustomFit.ai is running in edit mode"),void r();if((this.getUrlParameter("customfit_preview")||sessionStorage.getItem("customfit_preview"))&&(sessionStorage.setItem("customfit_preview",!0),this.sharedPreferences.setPreviewMode(!0)),e&&(this.user=this.cleanseUser(e),this.sharedPreferences.setUserInfo(this.user)),1==cf_is_outbound&&0==cf_is_inbound&&!this.sharedPreferences.getLongUrlParams()&&!this.sharedPreferences.getTinyId()&&!this.sharedPreferences.isOutboudUser())return console.log("CustomFit.ai is enabled for only outbound campaigns. Reach out to support(reach@customfit.ai) for upgradation"),void r();var i="";if(!this.maintainSession){var s=this.sharedPreferences.getMatchedPagePath();i=s&&s.length>0&s.includes("?")?s:P().length>1?P().replace(/\/$/,""):P()}this.sharedPreferences.setUserConfigAPICallState("USER_CONFIG_API_REQUEST_SENT"),this.api.send("POST","/v1/users/configs",{user:JSON.parse(JSON.stringify(this.user,this.replaceUndefinedOrNull)),desired_experiences:this.sharedPreferences.getDesiredExperiences(),preferred_experiences:this.sharedPreferences.getPreferredExperiences(),cfid:this.sharedPreferences.getTinyId(),preview_mode:this.sharedPreferences.isPreviewMode(),current_page_path:i,current_domain:S(),session_id:this.user.latest_session_id}).then((e=>{this.sharedPreferences.setUserConfigAPICallState("USER_CONFIG_API_RESPONSE_RCVD"),this.updateConfigVariationToDeviceSpecific(e.configs),this.sharedPreferences.setConfigs(e.configs),this.sharedPreferences.setLongUrlParams(e.long_url),this.sharedPreferences.setCFUserId(e.user_id),this.extractCurrentPagePathInformation(e.page_paths),cf_intelligent_code_enabled||sessionStorage.setItem(this.sharedPreferences.getStorageKeyPrefix()+"cfconfigs_"+this.user.user_customer_id,JSON.stringify(e)),this.sharedPreferences.isCurrentPagePersonalized()&&this.updatePageElements(e.configs,!1),t()}),(e=>{this.sharedPreferences.setUserConfigAPICallState("USER_CONFIG_ERROR_RESPONSE_RCVD"),console.log("CustomFit.ai Error status:"+e.status),console.log("CustomFit.ai Error message:"+e.message),console.log("CustomFit.ai Error data:"+JSON.stringify(e.data)),t()})).catch((e=>{this.sharedPreferences.setUserConfigAPICallState("USER_CONFIG_ERROR_RESPONSE_RCVD"),t()}))}catch(e){console.log(e),t()}}))}construct(e,t,r=!1,i=!0,s=5,n=!1,o=!0){var a=!1;this.captureDeviceInfo=!0,this.spa=!1,this.spa_auto_detect_page_url_change=!1,"boolean"!=typeof r?(r.personalize&&(a=r.personalize),null!=r.maintainSession&&(i=r.maintainSession),r.trackQueueSize&&(s=r.trackQueueSize),r.sendPageTrack&&(n=r.sendPageTrack),r.makeDocumentVisibleAfterUpdate&&(o=r.makeDocumentVisibleAfterUpdate),r.captureDeviceInfo&&(this.captureDeviceInfo=r.captureDeviceInfo),r.spa&&(this.spa=r.spa),r.spa_auto_detect_page_url_change&&(this.spa_auto_detect_page_url_change=r.spa_auto_detect_page_url_change)):a=r,s<5&&(s=5);try{this.sharedPreferences=new h(this.user,t),y=this.sharedPreferences,this.getUrlParameter("customfit_preview")&&(cf_intelligent_code_enabled=!1),this.extractCurrentPagePathInformation(cf_page_paths),this.displayToggle();var c=!1;(this.getUrlParameter("customfit_preview")||sessionStorage.getItem("customfit_preview"))&&(console.log("CustomFit.ai is running in preview mode"),sessionStorage.setItem("customfit_preview",!0),cf_intelligent_code_enabled=!1,c=!0);var l="cf_"+this.MD5(t)+"_";if(this.sharedPreferences.setStorageKeyPrefix(l),this.sharedPreferences.setTrackQueueSize(s),this.sharedPreferences.setInitSettings({personalize:a,maintainSession:i,trackQueueSize:s,sendPageTrack:n,makeDocumentVisibleAfterUpdate:o,captureDeviceInfo:this.captureDeviceInfo,spa:this.spa,spa_auto_detect_page_url_change:this.spa_auto_detect_page_url_change}),this.user=this.cleanseUser(e),!c&&1==cf_is_outbound&&0==cf_is_inbound&&0==cf_personalized_users_limit_exceeded&&!this.sharedPreferences.getTinyId()&&!this.sharedPreferences.isOutboudUser())return console.log("CustomFit.ai is enabled for only outbound campaigns. Reach out to support (reach@customfit.ai) for upgradation"),this.makeDocumentVisible(!0,!0),!1;if(this.isReferrerBlackListed(this.user.properties.referrer))return this.makeDocumentVisible(!0,!0),!1;if(this.sharedPreferences.setUserInfo(this.user),this.sharedPreferences.setLastPagePathDuration(),this.isCustomFitEditModeEnabled())return console.log("CustomFit.ai is running in edit mode."),this.isNextJsSite()||(window.self=window.top),window.frameElement&&"CustomFit editor"==window.frameElement.title||""==this.getUrlParameter("utm_customfit_edit")||sessionStorage.setItem("cf_extension_init_url",window.location.href),this.sharedPreferences.setEditMode(!0),this.makeDocumentVisible(!0,!0),!1;c&&(e=(new p.Builder).build(),this.user=this.cleanseUser(e),this.sharedPreferences.setUserInfo(this.user),this.sharedPreferences.setPreviewMode(!0));var d=sessionStorage.getItem(this.sharedPreferences.getStorageKeyPrefix()+"session_id_"+this.sharedPreferences.getUserId());d||(d=u()(),sessionStorage.setItem(this.sharedPreferences.getStorageKeyPrefix()+"session_id_"+this.sharedPreferences.getUserId(),d),sessionStorage.setItem("cfit_session_id",d)),this.sharedPreferences.setSessionId(d),this.user.properties.latest_session_id=d,this.sharedPreferences.setUserInfo(this.user)}catch(e){console.error(e)}return!0}displayToggle(){var e=document.querySelector("html");if(cf_intelligent_code_enabled&&cf_page_paths){if(this.sharedPreferences.isCurrentPagePersonalized()&&(this.hideElementsIfNeeded(),this.sharedPreferences.getHiddenElementsConfigMap().size>0)){var t=this,r=setTimeout((function(){t.removeAllHideStyles(),t.sharedPreferences.apiTimeoutOccurred(!0)}),cf_sdk_timeout_in_seconds);this.sharedPreferences.saveTimerId(r)}}else e.classList?e.classList.add("customfit-invisible-block"):e.className&&(e.className=e.className+" customfit-invisible-block"),t=this,r=setTimeout((function(){t.makeDocumentVisible(!0,!0);for(var e=document.querySelectorAll(".customfit-invisible-block"),r=0;e&&r<e.length;r++)try{e[r].style.transition=".1s all",e[r].className=e[r].className.replace(/\bcustomfit-invisible-block\b/g,"")}catch(e){}t.sharedPreferences.apiTimeoutOccurred(!0)}),cf_sdk_timeout_in_seconds),this.sharedPreferences.saveTimerId(r);e.className=e.className.replace(/\bcustomfit-invisible-preinit-block\b/g,"");var i=document.getElementById("customfit-invisible-preinit-css-block");i&&i.parentNode.removeChild(i)}uninit(){try{this.sharedPreferences&&1==this.sharedPreferences.isSPA()&&(this.sharedPreferences.clearRunningTimers(),this.sharedPreferences.unRegEventHandlers(),this.sharedPreferences.unRegObservers(),this.sharedPreferences.removeAllTemplates(),this.sharedPreferences.unInited=!0)}catch(e){console.error(e)}}init(e,t,r=!1,i=!0,s=5,n=!1,o=!0){cf_legacy&&this.construct(e,t,r,i,s,n,o);try{window.customFitEvents&&window.customFitEvents.length>0&&(this.preInitTrackMessages.push(...window.customFitEvents),window.customFitEvents=[])}catch(e){console.log(e)}return new Promise(((e,t)=>{try{if(this.isCustomFitEditModeEnabled())return console.log("CustomFit.ai is running in edit mode"),void t();if(this.api=new d(this.sharedPreferences.getClientKey()),this.maintainSession=this.sharedPreferences.getInitSettings().maintainSession,this.personalize=this.sharedPreferences.getInitSettings().personalize,this.eventTracker=new f(this,this.api,this.sharedPreferences),this.summaryExporter=new g(this.api,this.sharedPreferences,this),this.sendPageTrack=this.sharedPreferences.getInitSettings().sendPageTrack,this.spa=this.sharedPreferences.getInitSettings().spa,this.spa_auto_detect_page_url_change=this.sharedPreferences.getInitSettings().spa_auto_detect_page_url_change,!cf_intelligent_code_enabled){let t=sessionStorage.getItem(this.sharedPreferences.getStorageKeyPrefix()+"cfconfigs_"+this.sharedPreferences.getUserId());if(t){var r=JSON.parse(t);if(this.sharedPreferences.setConfigs(r.configs),this.sharedPreferences.setLongUrlParams(r.long_url),this.sharedPreferences.setCFUserId(r.user_id),this.extractCurrentPagePathInformation(r.page_paths),this.maintainSession)return this.updatePageElements(r.configs,!0,this.sendPageTrack,this.personalize),this.makeDocumentVisible(this.personalize),void e()}}if((this.sharedPreferences.isCurrentPagePersonalized()||!cf_intelligent_code_enabled||cf_enable_event_analyzer||this.sharedPreferences.isPreviewMode())&&this.personalize){var i="";if(!this.maintainSession){var s=this.sharedPreferences.getMatchedPagePath();i=s&&s.length>0&s.includes("?")?s:P().length>1?P().replace(/\/$/,""):P()}cf_script_time_before_config_call=(new Date).getTime(),this.sharedPreferences.setUserConfigAPICallState("USER_CONFIG_API_REQUEST_SENT"),this.api.send("POST","/v1/users/configs",{user:JSON.parse(JSON.stringify(this.user,this.replaceUndefinedOrNull)),desired_experiences:this.sharedPreferences.getDesiredExperiences(),preferred_experiences:this.sharedPreferences.getPreferredExperiences(),cfid:this.sharedPreferences.getTinyId(),current_page_path:i,current_domain:S(),preview_mode:this.sharedPreferences.isPreviewMode(),session_id:this.sharedPreferences.getSessionId()}).then((r=>{if(this.sharedPreferences.setUserConfigAPICallState("USER_CONFIG_API_RESPONSE_RCVD"),this.isCustomFitEditModeEnabled())return console.log("CustomFit.ai is running in edit mode"),this.sharedPreferences.setEditMode(!0),this.makeDocumentVisible(!0,!0),t(),!1;if(cf_script_time_after_config_call=(new Date).getTime(),this.updateConfigVariationToDeviceSpecific(r.configs),this.sharedPreferences.setConfigs(r.configs),this.sharedPreferences.setLongUrlParams(r.long_url),this.sharedPreferences.setCFUserId(r.user_id),this.extractCurrentPagePathInformation(r.page_paths),cf_intelligent_code_enabled||sessionStorage.setItem(this.sharedPreferences.getStorageKeyPrefix()+"cfconfigs_"+this.sharedPreferences.getUserId(),JSON.stringify(r)),this.sharedPreferences.hasApiTimedout()&&!cf_personalize_post_sdk_timeout||!this.sharedPreferences.isCurrentPagePersonalized())this.makeDocumentVisible(this.personalize,!0),this.sendCurrentPageEvents(),this.initCBHandlers();else if(cf_initial_delay_in_ms&&cf_initial_delay_in_ms>0){var i=this,s=!1;window.onload=function(){setTimeout((function(){s||(s=!0,i.updatePageElements(r.configs,!0,i.sendPageTrack,i.personalize),i.makeDocumentVisible(i.personalize),i.initCBHandlers())}),cf_initial_delay_in_ms)},setTimeout((function(){s||(s=!0,i.updatePageElements(r.configs,!0,i.sendPageTrack,i.personalize),i.makeDocumentVisible(i.personalize),i.initCBHandlers())}),cf_initial_delay_in_ms)}else this.updatePageElements(r.configs,!0,this.sendPageTrack,this.personalize),this.makeDocumentVisible(this.personalize),this.sendCurrentPageEvents(),this.initCBHandlers();e()}),(t=>{this.sharedPreferences.setUserConfigAPICallState("USER_CONFIG_ERROR_RESPONSE_RCVD"),console.log("CustomFit.ai Error status:"+t.status),console.log("CustomFit.ai Error message:"+t.message),console.log("CustomFit.ai Error data:"+JSON.stringify(t.data)),this.makeDocumentVisible(this.personalize,!0),cf_send_error_report&&t&&403!=t.status&&this.reportError({message:"API /v1/users/configs failed",cf_domain_url,error:t,href:window.location.href,position:"error"}),e()})).catch((t=>{this.sharedPreferences.setUserConfigAPICallState("USER_CONFIG_ERROR_RESPONSE_RCVD"),this.makeDocumentVisible(this.personalize,!0),cf_send_error_report&&t&&403!=t.status&&this.reportError({message:"API /v1/users/configs failed",cf_domain_url,error:t,href:window.location.href,position:"catch"}),e()}))}else{try{this.makeDocumentVisible(this.personalize,!0),this.sendCurrentPageEvents(),this.initCBHandlers()}catch(e){console.log("CustomFit.ai, error:",e)}e()}}catch(t){console.log(t),this.makeDocumentVisible(this.personalize,!0),e()}}))}initCBHandlers(){var e=this;function t(e){return function(t){var r=function(){window[e]&&t()};window[e]?t():"loading"===document.readyState?document.addEventListener("DOMContentLoaded",(function(){window[e]?t():window.addEventListener("load",r)})):"interactive"===document.readyState?window.addEventListener("load",r):"complete"===document.readyState&&r()}}if(cf_send_error_report&&e.track(new _.Builder("cf_init_cb_evt_3").withEventType("TRACK").build(),!0),cf_is_page_update_enabled&&(w(window,"click",(function(){e.sharedPreferences.incrementPageClicks()}),!0),w(window,"scroll",(function(t){var r=e.getCurrentPageScrollPercentage();(r=parseFloat(r.toFixed(3)))>e.sharedPreferences.getMaxScrollDepth()&&e.sharedPreferences.setMaxScrollDepth(r)})),e.startPeriodicTimer()),"loading"!=document.readyState?e.registerOnDocumentLoadHandlers(e):w(document,"DOMContentLoaded",(function(t){e.registerOnDocumentLoadHandlers(e)}),!1),cf_is_hubspot_enabled&&(e.registerHubspotFormEvents(e),setTimeout((function(){if(!e.sharedPreferences.getUser().isHubspotUTKExtracted())try{e.sharedPreferences.getUser().initHubspotUTKIfSet()&&e.sharedPreferences.getUser().isHubspotUTKExtracted()&&(e.sharedPreferences.getUser().form_update_detected="true",e.updateUser())}catch(e){console.error(e)}}),3e3)),1==e.sharedPreferences.isSPA()&&e.sharedPreferences.isSPAAutoDetectPageUrlChangeEnabled()&&((()=>{let t=history.pushState;history.pushState=function(){let e=t.apply(this,arguments);return window.dispatchEvent(new Event("locationchange")),e};let r=history.replaceState;history.replaceState=function(){let e=r.apply(this,arguments);return window.dispatchEvent(new Event("locationchange")),e},window.addEventListener("popstate",(()=>{var t=window.location.href;e.sharedPreferences.getCurrentPageUrl()!=t&&window.dispatchEvent(new Event("locationchange"))}))})(),window.addEventListener("locationchange",(function(){try{if(e.sharedPreferences.getCurrentPageUrl()!=window.location.href&&!e.sharedPreferences.unInited){var t=e.sharedPreferences.getCurrentPageUrl().split("?")[0].split("#")[0];window.location.href.split("?")[0].split("#")[0]!==t&&(e.uninit(),cfitinit())}}catch(e){console.error(e)}}))),cf_is_hotjar_enabled){var r=function(){if(window.hj){var t=e.sharedPreferences.getExperienceBehaviorMap();if(t.size>0)try{for(var r of t.keys()){var i=t.get(r),s=i.experience.replaceAll(" ","_").replace(/\W/g,""),n=i.behaviour.replaceAll(" ","_").replace(/\W/g,"");hj("event","customfit_"+s+"_"+n),console.log("CustomFit.ai has successfully tagged experience: "+s+" and behavior: "+n+" in the HotJar")}}catch(e){console.log(e)}}};window.hj||"complete"==document.readyState?r():window.addEventListener("load",r)}if(cf_is_ms_clarity_enabled){var i=function(){if(window.clarity){var t=e.sharedPreferences.getExperienceBehaviorMap();if(t.size>0)try{for(var r of t.keys()){var i=t.get(r),s=i.experience.replaceAll(" ","_").replace(/\W/g,""),n=i.behaviour.replaceAll(" ","_").replace(/\W/g,"");clarity("set","customfit",s+"_"+n),console.log("CustomFit.ai has successfully tagged experience: "+s+" and behavior: "+n+" in the MS Clarity")}}catch(e){console.log(e)}}};window.clarity||"complete"==document.readyState?i():window.addEventListener("load",i)}if(cf_is_segment_enabled){var s=function(){if(window.analytics){var t=e.sharedPreferences.getExperienceBehaviorMap();if(t.size>0)try{for(var r of t.keys()){var i=t.get(r),s=i.experience.replaceAll(" ","_").replace(/\W/g,""),n=i.behaviour.replaceAll(" ","_").replace(/\W/g,"");analytics.track("CustomFit Experience Viewed",{experienceId:i.experience_id,experienceName:s,behaviourId:i.behaviour_id,behaviourName:n,experience_behavior:s+"_"+n,nonInteraction:1}),console.log("CustomFit.ai has successfully tagged experience: "+s+" and behavior: "+n+" in the Segment")}}catch(e){console.log(e)}}};window.analytics||"complete"==document.readyState?s():window.addEventListener("load",s)}if(cf_is_mixpanel_enabled){var n=function(){if(window.mixpanel){var t=e.sharedPreferences.getExperienceBehaviorMap();if(t.size>0)try{for(var r of t.keys()){var i=t.get(r),s=i.experience.replaceAll(" ","_").replace(/\W/g,""),n=i.behaviour.replaceAll(" ","_").replace(/\W/g,"");mixpanel.track("CustomFit Experience Viewed",{experienceId:i.experience_id,experienceName:s,behaviorId:i.behaviour_id,behaviorName:n,experience_behavior:s+"_"+n}),console.log("CustomFit.ai has successfully tagged experience: "+s+" and behavior: "+n+" in the MixPanel")}}catch(e){console.log(e)}}};window.mixpanel||"complete"==document.readyState?n():window.addEventListener("load",n)}if(cf_is_amplitude_enabled){var o=function(){if(window.mixpanel){var t=e.sharedPreferences.getExperienceBehaviorMap();if(t.size>0)try{for(var r of t.keys()){var i=t.get(r),s=i.experience.replaceAll(" ","_").replace(/\W/g,""),n=i.behaviour.replaceAll(" ","_").replace(/\W/g,"");amplitude.track({event_type:"CustomFit Experience Viewed",event_properties:{experienceId:i.experience_id,experienceName:s,behaviorId:i.behaviour_id,behaviorName:n,experience_behavior:s+"_"+n}}),console.log("CustomFit.ai has successfully tagged experience: "+s+" and behavior: "+n+" in the Amplitude")}}catch(e){console.log(e)}}};window.amplitude||"complete"==document.readyState?o():window.addEventListener("load",o)}if(cf_is_heap_enabled){var a=function(){if(window.mixpanel){var t=e.sharedPreferences.getExperienceBehaviorMap();if(t.size>0)try{for(var r of t.keys()){var i=t.get(r),s=i.experience.replaceAll(" ","_").replace(/\W/g,""),n=i.behaviour.replaceAll(" ","_").replace(/\W/g,"");heap.track("CustomFit Experience Viewed",{experienceId:i.experience_id,experienceName:s,behaviorId:i.behaviour_id,behaviorName:n,experience_behavior:s+"_"+n}),console.log("CustomFit.ai has successfully tagged experience: "+s+" and behavior: "+n+" in the Heap")}}catch(e){console.log(e)}}};window.heap||"complete"==document.readyState?a():window.addEventListener("load",a)}if(cf_is_moengage_enabled&&t("Moengage")((function(){if(window.Moengage){var t=e.sharedPreferences.getExperienceBehaviorMap();if(t.size>0)try{for(var r of t.keys()){var i=t.get(r),s=i.experience.replaceAll(" ","_").replace(/\W/g,""),n=i.behaviour.replaceAll(" ","_").replace(/\W/g,"");Moengage.track_event("CustomFit",{customfit_experience_name:s,customfit_behavior_name:n,customfit_experience_behavior:s+"_"+n}),console.log("CustomFit.ai has successfully tagged experience: "+s+" and behavior: "+n+" in the MoEngage")}}catch(e){console.log(e)}}})),cf_is_clevertap_enabled&&t("clevertap")((function(){if(window.clevertap){var t=e.sharedPreferences.getExperienceBehaviorMap();if(t.size>0)try{for(var r of t.keys()){var i=t.get(r),s=i.experience.replaceAll(" ","_").replace(/\W/g,""),n=i.behaviour.replaceAll(" ","_").replace(/\W/g,"");clevertap.event.push("CustomFit",{customfit_experience_name:s,customfit_behavior_name:n,customfit_experience_behavior:s+"_"+n}),console.log("CustomFit.ai has successfully tagged experience: "+s+" and behavior: "+n+" in the CleverTap")}}catch(e){console.log(e)}}})),cf_is_webengage_enabled&&t("webengage")((function(){if(window.webengage){var t=e.sharedPreferences.getExperienceBehaviorMap();if(t.size>0)try{for(var r of t.keys()){var i=t.get(r),s=i.experience.replaceAll(" ","_").replace(/\W/g,""),n=i.behaviour.replaceAll(" ","_").replace(/\W/g,"");webengage.track("CustomFit",{customfit_experience_name:s,customfit_behavior_name:n,customfit_experience_behavior:s+"_"+n}),console.log("CustomFit.ai has successfully tagged experience: "+s+" and behavior: "+n+" in the WebEngage")}}catch(e){console.log(e)}}})),cf_is_netcore_enabled&&t("smartech")((function(){if(window.webengage){var t=e.sharedPreferences.getExperienceBehaviorMap();if(t.size>0)try{for(var r of t.keys()){var i=t.get(r),s=i.experience.replaceAll(" ","_").replace(/\W/g,""),n=i.behaviour.replaceAll(" ","_").replace(/\W/g,"");smartech("dispatch","CustomFit",{customfit_experience_name:s,customfit_behavior_name:n,customfit_experience_behavior:s+"_"+n}),console.log("CustomFit.ai has successfully tagged experience: "+s+" and behavior: "+n+" in the WebEngage")}}catch(e){console.log(e)}}})),cf_is_ga_enabled)try{var c=e.sharedPreferences.getExperienceBehaviorMap();if(c.size>0){window.dataLayer=window.dataLayer||[];var l=window.gtag;"function"!=typeof l?(cf_send_error_report&&(null==l||null==l?e.track(new _.Builder("cf_gtag_found_in_window_is_null").withEventType("TRACK").build(),!0):e.track(new _.Builder("cf_gtag_found_in_window_is_not_func").withEventType("TRACK").build(),!0)),l=function(){window.dataLayer.push(arguments)}):cf_send_error_report&&e.track(new _.Builder("cf_gtag_found_3").withEventType("TRACK").build(),!0),function(t,r){try{if(r.size>0)try{for(var i of r.keys()){var s=r.get(i);if(s.audience_name&&0!=s.audience_name.length){var[n,o,a]=s.audience_name.split("-");"gtm"==cf_ga4_setup_mode?window[cf_gtm_data_variable_name].push({event:"customfit-data-push-ga4",customfit_exp_beh_string:"CF-"+s.experience_id+"-"+s.behaviour_id}):t?s.ga_measurement_id&&s.ga_measurement_id.length>0?(t("event","CustomFit",{send_to:s.ga_measurement_id,customfit_experience_name:o,customfit_behavior_name:a,customfit_experience_behavior_audience:s.audience_name}),t("event","experience_impression",{send_to:s.ga_measurement_id,exp_variant_string:"CF-"+s.experience_id+"-"+s.behaviour_id}),cf_send_error_report&&e.track(new _.Builder("ga4_tagged_event_3").withEventType("TRACK").build(),!0)):(t("event","CustomFit",{customfit_experience_name:o,customfit_behavior_name:a,customfit_experience_behavior_audience:s.audience_name}),t("event","experience_impression",{exp_variant_string:"CF-"+s.experience_id+"-"+s.behaviour_id})):cf_send_error_report&&(e.track(new _.Builder("cf_gtag_not_found_3").withEventType("TRACK").build(),!0),e.reportError({message:"GA not tagged:  window.gtag not found",cf_domain_url}))}else cf_send_error_report&&e.track(new _.Builder("cf_empty_audience_name_event_3").withEventType("TRACK").build(),!0)}}catch(e){console.log(e)}else cf_send_error_report&&e.track(new _.Builder("cf_empty_expbeh_map_event_3").withEventType("TRACK").build(),!0)}catch(e){console.error(e)}}(l,c)}}catch(e){console.error(e)}var u=function(){try{if(window.ShopifyAnalytics&&window.ShopifyAnalytics.meta&&window.ShopifyAnalytics.meta.page&&"product"==window.ShopifyAnalytics.meta.page.pageType){var e=window.ShopifyAnalytics.meta.page.resourceId,t=window.ShopifyAnalytics.meta.selectedVariantId||k("variant");if(t&&(t=Number(t)),e){var r=[],i=localStorage.getItem("customfit_viewed_products");if(i&&i.length>0)try{r=JSON.parse(i)}catch(e){console.error(e)}let s=r.findIndex((t=>t.product_id==e));if(-1!==s){let[e]=r.splice(s,1);e.viewed_count=e.viewed_count+1,e.variant_id=t,r.unshift(e)}else r.unshift({product_id:e,variant_id:t,time_stamp:Date.now(),viewed_count:1});r.length>10&&(r=r.slice(0,10)),localStorage.setItem("customfit_viewed_products",JSON.stringify(r))}}}catch(e){console.error(e)}};if("complete"==document.readyState||"interactive"==document.readyState?u():window.addEventListener("DOMContentLoaded",u,!0),cf_is_shopify_integrated){var d=function(){try{if(Shopify&&Shopify.analytics){const e="customfit_ready",t={cf_user_customer_id:y.getUser().user_customer_id,cf_key,cf_shopify_event_settings,cf_domain_in_id:y.getCurrentDomain(),cf_session_id:y.getSessionId(),cf_storage_key_prefix:y.getStorageKeyPrefix(),cf_latest_sdk_version,cf_user:y.getUser(),cf_account_enabled,cf_shopify_events_enabled,cf_skip_sdk};Shopify.analytics.publish(e,t)}}catch(e){console.error(e)}};"complete"==document.readyState?d():(w(document,"DOMContentLoaded",d,!0),w(window,"load",d,!0))}}registerHubspotFormEvents(e){var t=function(e){return function(t){"hsFormCallback"===t.data.type&&"onFormReady"===t.data.eventName?e.sendFormEvents(t.data.id,null,"hubspot","form_view"):"hsFormCallback"===t.data.type&&"onFormSubmit"===t.data.eventName&&(e.sendFormEvents(t.data.id,t.data.data,"hubspot","form_submitted"),e.sharedPreferences.getUser().form_update_detected="true",e.updateUser())}}(e);w(window,"message",t)}sendFormEvents(e,t,r,i){try{if(!e)return;var s=this,n=(s.sharedPreferences.getLastTrackedPageProperties(),P().length>1?P().replace(/\/$/,""):P()),o=E(n),a=new _.Builder("hs_form_"+e).withEventType("FORM");if(a.form_type=r,a.form_action=i,t)for(var c of t)"hs_context"!=c.name&&("email"==c.name&&(s.sharedPreferences.getUser().email=c.value),a=a.withEventProperty(c.name,c.value));a=(a=(a=a.withEventProperty("form_action",i)).withEventProperty("form_type",r)).withEventProperty("page_path",o),o!=n&&(a=a.withEventProperty("cf_merged_page_path",!0));var l=a.build();l.form_type=r,l.form_action=i,s.track(l,!0,!0)}catch(e){console.error(e)}}registerAnyFormSubmit(e){var t=document.querySelectorAll("form");for(var r of t)try{r.addEventListener("submit",(function(t){try{e.sharedPreferences.getUser().form_update_detected="true",e.updateUser()}catch(t){console.error(t)}}),!1)}catch(e){console.error(e)}}registerOnDocumentLoadHandlers(e){if(cf_is_hubspot_enabled&&e.registerAnyFormSubmit(e),is_auto_form_capture){var t=document.querySelectorAll("form");!t||t.length<=0?setTimeout((function(){e._initContactCapture(e)}),5e3):e._initContactCapture(e)}}_initContactCapture(e){var t=document.querySelectorAll("form");if(t&&!(t.length<=0)){var r=e.user;for(var i of t)try{var s=i.querySelectorAll("input");if(s&&s.length>0)for(var n of s)if(null!=n.getAttribute("name")&&"text"==n.getAttribute("type")||"email"==n.getAttribute("type")||"tel"==n.getAttribute("type")){if("hidden"==n.getAttribute("type"))continue;w(n,"change",(function(){try{var t=!1;if("email"==this.type&&is_auto_email_capture){var i=this.value;i&&i.length>0&&r.properties.email!=i&&/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(i).toLowerCase())&&(r.properties.email=i,t=!0)}else if("tel"==this.type&&is_auto_phonenumber_capture){var s=this.value;s&&s.length>0&&r.properties.phone!=i&&(r.properties.phone=s,t=!0)}else"hidden"!=this.type&&this.value&&this.value.length>0&&r.properties[this.getAttribute("name").replace(/ /g,"_")]!=this.value&&(r.properties[this.getAttribute("name").replace(/ /g,"_")]=this.value,t=!0);t&&e.sharedPreferences.setUserInfo(r)}catch(e){console.error(e)}}),!1)}i.attachEvent?i.attachEvent("submit",(function(){e.updateUser()})):w(i,"submit",(function(){e.updateUser()}))}catch(e){console.error(e)}}}startPeriodicTimer(){var e=this,t=window.location.href.split("?");e.sharedPreferences.getPeriodicTimerId()&&clearInterval(e.sharedPreferences.getPeriodicTimerId());var r=setInterval((function(){1!=e.sharedPreferences.isSPA()||0!=e.sharedPreferences.isSPAAutoDetectPageUrlChangeEnabled()||e.sharedPreferences.getCurrentPageUrl()==t?e.sendPageUpdates():e.uninit()}),2e4);e.sharedPreferences.setPeriodicTimerId(r)}sendPageUpdates(e=!1){var t=this;if(cf_is_page_update_enabled&&!this.isPageBlackListedForTrack()&&t.sharedPreferences.isCurrentPageActive()){var r=t.sharedPreferences.getLastTrackedPageProperties(),i={scroll_depth:null,click_count:null,current_page_duration:null};try{var s=!1,n=t.sharedPreferences.getMaxScrollDepth();n>0&&n>=r.scroll_depth+.05*r.scroll_depth&&(i.scroll_depth=parseFloat(n-r.scroll_depth).toFixed(3),r.scroll_depth=n,t.sharedPreferences.setLastTrackedPageProperties(r),s=!0);var o=t.sharedPreferences.getPageClicks();r.click_count<o&&(i.click_count=o-r.click_count,r.click_count=o,t.sharedPreferences.setLastTrackedPageProperties(r),s=!0);var a=t.sharedPreferences.getCurrentPageDuration();if((e||s)&&(a<=18e5?(i.current_page_duration=a-r.current_page_duration,r.current_page_duration=a,t.sharedPreferences.setLastTrackedPageProperties(r),s=!0):(r.current_page_duration=a,t.sharedPreferences.setLastTrackedPageProperties(r))),s){var c=P().length>1?P().replace(/\/$/,""):P(),l=C(c),u=0,d=!1;for(var p of l)try{u++;var h=t.getGoalDomainIfConfigured(p),f=h?h+"|"+p:p,m=new _.Builder(f).withEventType("PAGE_UPDATE");p!=c&&(m=m.withEventProperty("cf_merged_page_path",!0)),i.scroll_depth&&(m=m.withEventProperty("scroll_depth",i.scroll_depth)),i.click_count&&(m=m.withEventProperty("click_count",i.click_count)),i.current_page_duration&&(m=m.withEventProperty("current_page_duration",i.current_page_duration)),u==l.length&&(d=!0),t.track(m.build(),d,e)}catch(e){console.error(e)}t.sharedPreferences.setLastTrackedPageProperties(r)}}catch(e){console.error(e)}}}extractCurrentPagePathInformation(e){var t=this.isCurrentPagePersonalized(e);t.match_found&&(this.sharedPreferences.setPageElementsPathType(t.matched_page_elememnt_type),this.sharedPreferences.setMatchedPagePath(t.matched_page_path)),this.sharedPreferences.setCurrentPagePersonalized(t.match_found),this.sharedPreferences.setPersonalizedPagePaths(e),this.sharedPreferences.setCurrentPageActive(this.isCurrentPageActive())}makeDocumentVisible(e,t=!1){try{if(t||e&&"loading"!=document.readyState){if(cf_intelligent_code_enabled)this.removeAllHideStyles(!0);else if(cf_legacy)"hidden"===document.getElementsByTagName("HTML")[0].style.visibility&&(document.getElementsByTagName("HTML")[0].style.visibility="visible");else{var r=document.querySelector("html");r&&r.className&&(r.className=r.className.replace(/\bcustomfit-invisible-block\b/g,"")),this.removeAllHideStyles(!0)}this.documentMadeVisible=!0,cf_script_time_after_all_done=(new Date).getTime(),console.log("CustomFit:s1",cf_script_time_init,cf_script_time_before_config_call,cf_script_time_after_config_call,cf_script_time_after_all_done,JSON.stringify(cf_script_time_after_config_duriations))}this.summaryExporter&&this.summaryExporter.sendSummaries()}catch(e){console.error(e)}}addDevice(e){try{if(!e&&sessionStorage.getItem("customfit_preview"))return;this.api.send("POST","/v1/users/"+this.sharedPreferences.getCFUserId()+"/devices",{add_devices:[{device_customer_id:e,device_type:"WEB",user_id:this.sharedPreferences.getCFUserId()}],anonymous:+this.sharedPreferences.getUser().anonymous}).then((t=>{localStorage.setItem(this.sharedPreferences.getStorageKeyPrefix()+"cf_user_device_id",e)}),(e=>{})).catch((e=>{}))}catch(e){}}_getConfigs(e){return this.sharedPreferences.getConfigs()}getSystemConfigPathMap(e){let t=new Map;try{for(var r in e)try{var i=e[r];if("HTML_ELEMENT"==i.variation_data_type&&i.properties.page_path&&i.properties.element_path&&i.properties.system_created&&S().includes(i.properties.domain)&&this.isConfigBelongsToCurrentPage(i)){var s=t.get(i.properties.element_path);s&&s.experience_behaviour_response&&i.experience_behaviour_response&&(i.experience_behaviour_response.experience_id!=s.experience_behaviour_response.experience_id||i.experience_behaviour_response.behaviour_id!=s.experience_behaviour_response.behaviour_id)?t.set(i.properties.element_path+"/*"+i.experience_behaviour_response.behaviour_id+"*/",i):t.set(i.properties.element_path,i)}}catch(e){console.log("CustomFit.ai, error:",e)}}catch(e){console.log("CustomFit.ai, error:",e)}return t}isConfigBelongsToCurrentPage(e){var t=this.sharedPreferences.getMatchedPagePath(),r=P(),i=t||P();i=i.replace(/\/$/,"");var s="exact_match",n=!1;try{if(e.properties.page_match&&e.properties.page_match.length>0&&(s=e.properties.page_match),"contains"===s){for(var o of e.properties.page_path.split(","))if(r.includes(o)){n=!0;break}}else if("regex"===s){for(var o of e.properties.page_path.split(","))if(r.match(o)){n=!0;break}}else i===e.properties.page_path.replace(/\/$/,"")&&(n=!0)}catch(e){}return n}handleManualcreatedConfigs(e,t){try{for(var r in e)try{var i=e[r];"HTML_ELEMENT"==i.variation_data_type&&i.properties&&i.properties.page_path&&!i.properties.system_created&&P().replace(/\/$/,"")===i.properties.page_path.replace(/\/$/,"")&&this.replaceElementInPath(i.properties.element_path,i,t)}catch(e){console.log("CustomFit.ai, error:",e)}}catch(e){console.log("CustomFit.ai, error:",e)}}updatePageElements(e,t,r=!1,i=!0){try{this.actionConfigs=[];var s=this.getSystemConfigPathMap(e);if(cf_intelligent_code_enabled&&this.makeVisibleNonPersonalizedElements(s),this._updatePageElements(s,e,t),t)try{this.handleActions()}catch(e){console.log("CustomFit.ai, error:",e)}var n=!0;if(s.forEach((function(e,t){e&&!e.replaced&&(n=!1)})),n)this.makeDocumentVisible(i,!0),this.sendCurrentPageEvents();else{var o=this;try{w(document,"DOMContentLoaded",(function(t){let r=new Map;s.forEach((function(e,t){e&&!e.replaced&&r.set(t,e)})),o._updatePageElements(r,e,!1),o.makeDocumentVisible(i),o.sendCurrentPageEvents()}),!1)}catch(e){}}this.delayedReplaceElement(s,e,t)}catch(e){console.log("CustomFit.ai, error:",e)}}sendCurrentPageEvents(){try{var e,t=this;if(this.sharedPreferences.isCurrentPageTrackSent())return;if(e=this.getRevenueEvents(),this.sendPageTrack&&!this.isPageBlackListedForTrack()&&(this.sharedPreferences.isCurrentPageActive()||e&&e.length>0)){var r=P().length>1?P().replace(/\/$/,""):P(),i=C(r),s=0,n=!1;for(var o of i)try{s++;var a=this.getGoalDomainIfConfigured(o),c=a?a+"|"+o:o,l=new _.Builder(c).withEventType("PAGE");o!=r&&(l=l.withEventProperty("cf_merged_page_path",!0)),s==i.length&&(n=!0),this.track(l.build(),n)}catch(e){console.error(e)}}if(this.preInitTrackMessages&&this.preInitTrackMessages.length>0&&(this.preInitTrackMessages.forEach((function(e){var r=e.event;if(r&&r.length>0){var i=e.type&&e.type.length>0?e.type:"TRACK",s=new _.Builder(r).withEventType(i),n=e.properties;if(n)for(const e in n)n.hasOwnProperty(e)&&(s=s.withEventProperty(e,n[e]));t.track(s.build(),!0)}})),this.preInitTrackMessages=[]),e)for(var u of e)t.track(u.build(),!0);this.sharedPreferences.setCurrentPageTrackSent(!0)}catch(e){console.error(e)}}getRevenueEvents(){var e=[],t=S();for(var r of cf_revenue_pages)try{var i=P(),s=!1;if(!t.includes(r.domain)){if(!r.domain.includes("*"))continue;var n=r.domain.replace("*","");if(!t.endsWith(n))continue}try{if("simple"==r.path_check_type?i==r.pattern_value&&(s=!0):"starts_with"==r.path_check_type?i.startsWith(r.pattern_value)&&(s=!0):"ends_with"==r.path_check_type?i.endsWith(r.pattern_value)&&(s=!0):"contains"==r.path_check_type?i.includes(r.pattern_value)&&(s=!0):"regex"==r.path_check_type&&i.match(r.pattern_value)&&(s=!0),s){var o=new _.Builder(r.revenue_event_customer_id).withEventType("REVENUE").withEventProperty("revenue_amount",r.revenue_amount);e.push(o)}}catch(e){console.log(e)}}catch(e){console.log(e)}return e}findElement(e){try{var t=document.querySelector(e.properties.element_path);t?e.mapped_dom_element=t:e.properties.element_path&&e.properties.element_path.includes("CFIT_GLOBAL_")?e.mapped_dom_element=document.querySelector("html"):e.mapped_dom_element=null}catch(e){console.error(e)}return e}getDistance(e,t){let r=0;try{let i=t.mapped_dom_element,s=i;for(;s&&s.parentNode&&s!==e;)r++,s=s.parentNode;let n=1e-6*Array.from(i.parentNode.children).indexOf(i);t.mapped_dom_element_depth=r+n}catch(e){console.log(e)}return r}_updatePageElements(e,t,r){try{var i=this,s=(new Date).getTime();cf_skip_dfs||this.dfsReplace(document.querySelector("body"),e,r),i.sharedPreferences.setConfigsPathMap(e);const t=[...e.values()].map((e=>i.findElement(e)));for(var n of(i._sortConfigs(document.body,t),t))try{var o=n.config_customer_id,a=this.sharedPreferences.getReplacedElementsConfigMap().get(o);if(!cf_retain_text_value&&null!=a&&(null==a.variation.cf_retain_value||"false"==a.variation.cf_retain_value))continue;if(n.variation&&n.variation.cf_delay_apply_time&&n.variation.cf_delay_apply_time>0){if(this.sharedPreferences.getDelayAppliedConfigMap().get(o))continue;this.sharedPreferences.getDelayAppliedConfigMap().set(o,n),function(e,t){setTimeout((function(){var r=document.querySelector(e.properties.element_path);i._applyChanges(e,t,r,!0)}),e.variation.cf_delay_apply_time);var r=i.sharedPreferences.getHiddenElementsConfigMap().get(e.properties.element_path);r&&(r.delayedTimer=!0),t&&!e.replaced&&i.summaryExporter._queueSummary(n)}(n,r);continue}var c=n.mapped_dom_element;if(c&&a&&a.element_replaced!=c)continue;i._applyChanges(n,r,c),i.setDomChangeActionConfig(n),r&&!n.replaced&&i.summaryExporter._queueSummary(n)}catch(e){console.log(e)}if(r&&"loading"!=document.readyState){this.preReadActionElementsBeforeApply(),this.addCustomElements(t,e,r);var l=document.getElementsByClassName("cfit-custom-template");if(l)for(var u of l)this._applyTemplateInnerElementChanges(u,e,r)}var d=(new Date).getTime();cf_script_time_after_config_duriations.push(d-s),console.log("CustomFit:st ",JSON.stringify(cf_script_time_after_config_duriations))}catch(e){console.log(e)}this.handleManualcreatedConfigs(t,r)}_applyTemplateInnerElementChanges(e,t,r){try{if(!e)return;const s=[...t.values()].filter((t=>t.properties.element_path.startsWith("div#"+e.id))).map((e=>this.findElement(e)));for(var i of(this._sortConfigs(e,s),s))try{this.replaceElementInPath(i.properties.element_path,i,r)}catch(e){console.error(e)}}catch(e){console.error(e)}}applyTemplateInnerElementChanges(e){try{if(!e)return;var t=document.getElementById(e);if(!t)return;var r=this.sharedPreferences.getConfigsPathMap();this._applyTemplateInnerElementChanges(t,r,!0)}catch(e){console.error(e)}}_sortConfigs(e,t){if(e){var r=this;t.sort(((t,i)=>{try{return(t.mapped_dom_element?t.mapped_dom_element_depth||r.getDistance(e,t):99999)-(i.mapped_dom_element?i.mapped_dom_element_depth||r.getDistance(e,i):99999)}catch(e){return console.error(e),0}}))}}_applyChanges(e,t,r,i=!1){try{if(r)this.replaceElementInPath(e.properties.element_path,e,t),i&&this.handleActions();else if(!e.properties.element_path.startsWith("div#CFIT_")){var s=this;this.notifyElementLoad(e,t).then((function(e){if(e){var t=e[1],r=e[2];t.replaced||(s.replaceElementInPath(t.properties.element_path,t,r),s.handleActions())}})).catch((function(e){}))}}catch(e){console.log(e)}}setDomChangeActionConfig(e){try{var t=e.variation.customfit_meta;t&&(t.move_action||t.swap_action||t.edit_elem_action||t.advanced_click_actions||t.duplicate_actions)&&this.sharedPreferences.getDomChangeActionConfigsMap().set(e.properties.element_path,e)}catch(e){console.log(e)}}unsetDomChangeActionConfig(e){try{var t=e.variation.customfit_meta;t&&(t.move_action||t.swap_action||t.edit_elem_action||t.advanced_click_actions||t.duplicate_actions)&&this.sharedPreferences.getDomChangeActionConfigsMap().delete(e.properties.element_path)}catch(e){console.log(e)}}pushAction(e){for(let t=0;t<this.actionConfigs.length;t++)if(e.config_id==this.actionConfigs[t].config_id){this._preReadActionElementsBeforeApply(e,!0),this.actionConfigs.splice(t,1);break}this.actionConfigs.push(e)}handleActions(e=!1){if(("complete"==document.readyState||e||this.actionConfigs.length>=this.sharedPreferences.getDomChangesActionConfigsCount())&&this.actionConfigs.length>0){this.preReadActionElementsBeforeApply();for(let e of this.actionConfigs)this._handleAction(e);this.actionConfigs=[]}}_preReadActionElementsBeforeApply(e,t=!1){try{var r=e.variation.customfit_meta;if(!r)return;if(r.move_action)try{!r.move_action.target_elem||r.move_action.target_elem_obj&&!t||(r.move_action.target_elem_obj=document.querySelector(r.move_action.target_elem)),!r.move_action.first_elem||r.move_action.first_elem_obj&&!t||(r.move_action.first_elem_obj=document.querySelector(r.move_action.first_elem))}catch(e){console.log(e)}if(r.swap_action)try{!r.swap_action.target_elem||r.swap_action.target_elem_obj&&!t||(r.swap_action.target_elem_obj=document.querySelector(r.swap_action.target_elem)),!r.swap_action.first_elem||r.swap_action.first_elem_obj&&!t||(r.swap_action.first_elem_obj=document.querySelector(r.swap_action.first_elem))}catch(e){console.log(e)}if(r.edit_elem_action)try{var i=r.edit_elem_action;i&&i.action_type&&i.target_elem&&i.action_txt&&0!=i.action_txt.length&&(!i.target_elem||i.target_elem_obj&&!t||(i.target_elem_obj=document.querySelector(i.target_elem)))}catch(e){console.log(e)}if(r.advanced_click_actions&&r.advanced_click_actions.length>0)try{for(let e=0;e<r.advanced_click_actions.length;e++)try{const i=r.advanced_click_actions[e];!i.first_elem||i.first_elem_obj&&!t||(i.first_elem_obj=document.querySelector(i.first_elem)),!i.target_elem||i.target_elem_obj&&!t||(i.target_elem_obj=document.querySelector(i.target_elem))}catch(e){console.log(e)}}catch(e){console.log(e)}if(r.duplicate_actions&&r.duplicate_actions.length>0)try{var s=r.duplicate_actions;for(let e=0;e<s.length;e++)try{var n=s[e];!n.first_elem||n.first_elem_obj&&!t||(n.first_elem_obj=document.querySelector(n.first_elem)),!n.target_elem||n.target_elem_obj&&!t||(n.target_elem_obj=document.querySelector(n.target_elem))}catch(e){console.log("error: ",e)}}catch(e){console.log(e)}}catch(e){console.log(e)}}preReadActionElementsBeforeApply(){try{for(let e of this.actionConfigs)this._preReadActionElementsBeforeApply(e);this.actionConfigs.sort(((e,t)=>{try{if(e.variation.customfit_meta.move_action&&t.variation.customfit_meta.move_action){let r=e.variation.customfit_meta.move_action.position,i=t.variation.customfit_meta.move_action.position;e.variation.customfit_meta.move_action.order||(e.variation.customfit_meta.move_action.order="0"),t.variation.customfit_meta.move_action.order||(t.variation.customfit_meta.move_action.order="0");let s=parseInt(e.variation.customfit_meta.move_action.order),n=parseInt(t.variation.customfit_meta.move_action.order);return"below"===r?"below"===i?n-s:1:"above"===i?s-n:-1}if(e.variation.customfit_meta.swap_action&&t.variation.customfit_meta.swap_action){e.variation.customfit_meta.swap_action.order||(e.variation.customfit_meta.swap_action.order="0"),t.variation.customfit_meta.swap_action.order||(t.variation.customfit_meta.swap_action.order="0");let r=parseInt(e.variation.customfit_meta.swap_action.order);return parseInt(t.variation.customfit_meta.swap_action.order)-r}}catch(e){console.log(e)}}))}catch(e){console.log(e)}}_handleAction(e){try{if(e.variation&&e.variation.customfit_meta){var t=e.variation.customfit_meta;if(e.variation.customfit_meta.is_default&&e.experience_behaviour_response&&e.experience_behaviour_response.experience_id&&((t=e.variation.customfit_meta.experience[e.experience_behaviour_response.experience_id]).is_default=!0,t.experience_id=e.experience_behaviour_response.experience_id),t&&t.global_actions)try{this.globalActions(e,t.global_actions)}catch(e){console.log(e)}if(t&&t.duplicate_actions&&t.duplicate_actions.length>0)try{this.duplicateElement(t.duplicate_actions)}catch(e){console.log(e)}if(t&&t.advanced_click_actions&&t.advanced_click_actions.length>0)try{this.advancedClickActions(t.advanced_click_actions)}catch(e){console.log(e)}if(t&&t.move_action)try{this.moveElement(t.move_action.target_elem_obj,t.move_action.first_elem_obj,t.move_action.position)}catch(e){console.log(e)}if(t&&t.swap_action)try{this.swapElements(t.swap_action.first_elem_obj,t.swap_action.target_elem_obj)}catch(e){console.log(e)}if(t&&t.edit_elem_action)try{this.editElements(t.edit_elem_action)}catch(e){console.log(e)}if(t&&t.onclick_action&&t.onclick_action.action_txt&&t.onclick_action.action_txt.length>0)try{if(s=document.querySelector(e.properties.element_path)){var r=this,i=(n=t,o=e,function(e){try{const a=e.currentTarget;if("track_click"==n.onclick_action.action_type){var t=P().length>1?P().replace(/\/$/,""):P(),i=E(t);r.track(new _.Builder(n.onclick_action.action_txt).withEventType("CLICK").withEventProperty("page_path",i).build(),!0)}else if("execute_javascript"==n.onclick_action.action_type)"inline_js"==cf_jsevl_type?x(o.config_id,o.variation_id,n.experience_id,n.is_default,"on_click"):cf_ev_method(n.onclick_action.action_txt,a);else if("track_click_and_execute_javascript"==n.onclick_action.action_type)try{var s=JSON.parse(n.onclick_action.action_txt);t=P().length>1?P().replace(/\/$/,""):P(),i=E(t),r.track(new _.Builder(s.goal_name).withEventType("CLICK").withEventProperty("page_path",i).build(),!0),"inline_js"==cf_jsevl_type?x(o.config_id,o.variation_id,n.experience_id,n.is_default,"on_click"):cf_ev_method(s.js_code,a)}catch(e){console.log(e)}}catch(e){console.log(e)}});try{"IFRAME"==s.tagName?(top.focus(),b(s,"focus",i,!0),w(s,"focus",i,!0)):(b(s,"click",i,!0),w(s,"click",i,!0))}catch(e){console.error(e)}}}catch(e){console.error(e)}if(t&&t.onload_action&&"execute_javascript"==t.onload_action.action_type&&t.onload_action.action_txt&&t.onload_action.action_txt.length>0)try{"inline_js"==cf_jsevl_type?x(e.config_id,e.variation_id,t.experience_id,t.is_default,"on_load"):cf_ev_method(t.onload_action.action_txt,e.mapped_dom_element)}catch(e){console.error(e)}}else if(e.variation&&e.variation.cf_perform_click_action&&"true"==e.variation.cf_perform_click_action)try{var s;(s=document.querySelector(e.properties.element_path))&&s.click()}catch(e){console.error(e)}}catch(e){console.error(e)}var n,o}delayedReplaceElement(e,t,r){var i=this,s=function(e,t,r){if(i.sharedPreferences.hasElementsMoved()||i.sharedPreferences.hasElementsSwpped()){if(i.sharedPreferences.isAddingCustomElementsAttempted()&&r)try{if(i.addCustomElements(t,e,r),n=document.getElementsByClassName("cfit-custom-template"))for(var s of n)i._applyTemplateInnerElementChanges(s,e,r)}catch(e){console.log(e)}}else if(i._updatePageElements(e,t,r),r){try{var n;if(i.addCustomElements(t,e,r),n=document.getElementsByClassName("cfit-custom-template"))for(var s of n)i._applyTemplateInnerElementChanges(s,e,r)}catch(e){console.log(e)}i.handleActions(),i.summaryExporter.sendSummaries(),i.makeDocumentVisible(!0)}},n=i.sharedPreferences.getReplacedElementsConfigMap();for(var o of e.keys())if(!n.get(o))break;cf_retain_text_value&&"complete"!=document.readyState?window.onload=function(){s(e,t,r),i.handleActions(!0),i.makeDocumentVisible(!0);var n=i.sharedPreferences.getElementReAddedObserver();n&&n.disconnect()}:window.onload=function(){i.handleActions(!0),i.makeDocumentVisible(!0)};try{const n=cf_config_reapply_timers.split(",").filter((e=>""!==e.trim()&&!isNaN(e))).map((e=>Number(e)));for(var a of n)if(0!=a){var c=setTimeout((function(){s(e,t,r)}),a);i.sharedPreferences.saveTimerId(c)}}catch(e){console.error(e)}cf_retain_text_value&&this.notifyElementsReAdded()}cleanSelectorID(e){try{let t,r=e.charAt(0);isNaN(parseInt(r))?e=CSS.escape(e):(r=CSS.escape(r),t=e.slice(1),e=r.concat(t))}catch(e){console.log(e)}return`${e}`.toString()}cssPath(e){if(!(e instanceof Element))return;const t=e;var r=[];if(e&&"BODY"===e.nodeName||"HEAD"===e.nodeName)return`html > ${e.nodeName.toLowerCase()}`;for(;e.nodeType===Node.ELEMENT_NODE;){var i=e.nodeName.toLowerCase(),s=!1;if(e.id&&("ELEMENTS_BY_ID"==this.sharedPreferences.getPageElementsPathType()||"ELEMENTS_BY_ID_CLASS"==this.sharedPreferences.getPageElementsPathType()))try{1==document.querySelectorAll('[id="'+e.id+'"]').length&&(s=!0)}catch(e){s=!1}if(s){i+="#"+this.cleanSelectorID(e.id),r.unshift(i);break}if(("ELEMENTS_BY_ID_CLASS"==this.sharedPreferences.getPageElementsPathType()||"ELEMENTS_BY_CLASS"==this.sharedPreferences.getPageElementsPathType())&&e.classList&&e.classList.length>0){var n=!1,o=e.parentElement;if(!o)break;for(var a=0;a<e.classList.length;a++){var c=e.classList[a].replaceAll(":","\\:");if(1==[].filter.call(o.children,(function(e){return[].indexOf.call(e.classList,c)>=0})).length&&1==document.querySelectorAll('[class~="'+c+'"]').length){var l=r.slice();if(l.unshift(i+"."+c),document.querySelector(l.join(" > "))==t){i+="."+c,n=!0;break}}}if(n){r.unshift(i);break}}for(var u=e,d=1;u=u.previousElementSibling;)u.nodeName.toLowerCase()==i&&d++;1!=d&&(i+=":nth-of-type("+d+")"),r.unshift(i),e=e.parentNode}return r.join(" > ")}updateConfigVariationToDeviceSpecific(e){for(let t in e)if(e.hasOwnProperty(t)){let r=e[t];this.getDeviceSpecificVariation(r)&&delete e[t]}}getDeviceSpecificVariation(e){var t=e.variation;try{var r=this.sharedPreferences.getDeviceType();e.experience_behaviour_response&&e.experience_behaviour_response.config_modifications&&"device_specific"===e.experience_behaviour_response.config_modifications&&("mobile"==r&&t.mobile?e.variation=t.mobile:"mobile"!=r&&t.desktop?e.variation=t.desktop:e.variation={})}catch(e){console.error(e)}return!1}replaceElementInPath(e,t,r){let i=t.variation,s=document.querySelector(e),n=this.sharedPreferences.getDeviceType(),o=this;if(!s){if(!t.properties.element_path||!t.properties.element_path.includes("CFIT_GLOBAL_"))return;s=document.querySelector("html")}if(i&&i.customfit_meta&&i.customfit_meta.custom_template)console.log("CF ignored custom_template in replace");else{if(!s.cf_sdk_update_value||"CF_DONT_CHANGE"!=s.cf_sdk_update_value){t.delayed=!1;var a=!0;if(t.replaced&&(a=!1),i&&i.cf_defer_apply&&"loading"==document.readyState)return t.delayed=!0,void(r&&a&&this.summaryExporter._queueSummary(t));var c,l=!1;for(var u of Object.keys(i))try{if("customfit_meta"===u&&r&&a){l=!0;continue}if("cf_perform_click_action"===u){l=!0;continue}if("mobile"===u||"desktop"==u)continue;if("style"===u)for(var d of Object.keys(i[u]))("position"!=d&&"top"!=d&&"left"!=d||"desktop"==n)&&i[u][d]&&i[u][d].length>0&&(cf_intelligent_code_enabled&&"backgroundImage"==d&&s.style[d]!=i[u][d]&&(s.style[d]="unset"),s.style[d]=i[u][d],s.style.setProperty(d,i[u][d],"important"));if("srcset"==u&&(s.getAttribute("data-lazy-srcset")&&s.setAttribute("data-lazy-srcset",i[u].replace(/\\"/g,'"')),s.getAttribute("data-srcset")&&s.setAttribute("data-srcset",i[u].replace(/\\"/g,'"')),s.getAttribute("data-ws-srcset")&&s.setAttribute("data-ws-srcset",i[u].replace(/\\"/g,'"'))),"src"==u)if(s.getAttribute("data-lazy-src")&&s.setAttribute("data-lazy-src",i[u].replace(/\\"/g,'"')),s.getAttribute("data-src")&&s.setAttribute("data-src",i[u].replace(/\\"/g,'"')),s.getAttribute("data-ws-src")&&s.setAttribute("data-ws-src",i[u].replace(/\\"/g,'"')),s.getAttribute("data-mfp-src")&&s.setAttribute("data-mfp-src",i[u].replace(/\\"/g,'"')),cf_intelligent_code_enabled&&s[u]!=i[u]){var p=this.sharedPreferences.getHiddenElementsConfigMap().get(t.properties.element_path);p&&(t.imageChange=!0,p.imageChange=!0,w(s,"load",c=function(){o.removeHideStyles(t)}),w(s,"error",c))}else"IMG"!==s.tagName||cf_intelligent_code_enabled||s[u]==i[u]||(s.classList?s.classList.add("customfit-invisible-block"):s.className&&(s.className=html_ele.className+" customfit-invisible-block"),function(e,t,r){var i=function(t){e.src==r&&(e.style.transition=".1s all",e.className=e.className.replace(/\bcustomfit-invisible-block\b/g,""))};w(s,"load",i),w(s,"error",i)}(s,0,i[u]));if(!isNaN(i[u])&&i[u].length>0)s[u]=Number(i[u]);else if("string"==typeof i[u]){if("cf_classes_edit_option"===u&&i[u]&&"no_changes"!=i[u])if("add_remove_classes"==i[u]){if(i.cf_classes_add&&i.cf_classes_add.length>0)for(var h of i.cf_classes_add.split(" "))s.classList.add(h);if(i.cf_classes_remove&&i.cf_classes_remove.length>0)for(var _ of i.cf_classes_remove.split(" "))s.classList.remove(_)}else"overwrite_classes"==i[u]&&i.cf_classes_overwrite.length>0&&((" "+s.className+" ").indexOf(" customfit-invisible-block ")>-1?s.setAttribute("class",i.cf_classes_overwrite.replace(/\\"/g,'"')+" customfit-invisible-block"):s.setAttribute("class",i.cf_classes_overwrite.replace(/\\"/g,'"')));else"href_target"===u?s.setAttribute("target",i[u].replace(/\\"/g,'"')):s[u]!=i[u]&&(s[u]=i[u].replace(/\\"/g,'"'));"innerHTML"!=u&&"value"!=u||"true"!=i.cf_retain_value||!r||!a||t.innerHTMLObserver||(t.replacementCount=0,function(e,t,r,i){try{if(null==r||null==r)return;var s=new MutationObserver((function(s,n){e[t]!=r&&i.replacementCount<3?(e[t]=r,i.replacementCount++):i.replacementCount>3&&n.disconnect()}));s.observe(e,{characterData:!0,childList:!0,subtree:!0,attributes:!0}),i.innerHTMLObserver=s,o.sharedPreferences.saveRegObserverHandler(s)}catch(e){console.error(e)}}(s,u,i[u],t)),cf_retain_text_value&&"innerHTML"==u&&r&&a&&!t.innerHTMLObserver&&(t.replacementCount=0,function(e,t,r){try{var i=new MutationObserver((function(i,s){e.innerHTML!=t&&r.replacementCount<3?(e.innerHTML=t,r.replacementCount++):r.replacementCount>3&&s.disconnect()}));i.observe(e,{characterData:!0,childList:!0,subtree:!0,attributes:!0}),r.innerHTMLObserver=i,o.sharedPreferences.saveRegObserverHandler(i)}catch(e){console.error(e)}}(s,i[u],t))}}catch(e){console.error(e)}return t.replaced=!0,"INPUT"==s.tagName&&s.dispatchEvent(new Event("change")),r&&a&&(l&&(t.variation&&t.variation.customfit_meta&&(t.variation.customfit_meta.swap_action||t.variation.customfit_meta.move_action||t.variation.cf_perform_click_action||t.variation.customfit_meta.edit_elem_action||t.variation.customfit_meta.duplicate_actions&&t.variation.customfit_meta.duplicate_actions.length>0||t.variation.customfit_meta.advanced_click_actions&&t.variation.customfit_meta.advanced_click_actions.length>0)?this.pushAction(t):this._handleAction(t)),t.element_replaced=s,this.sharedPreferences.getReplacedElementsConfigMap().set(t.config_customer_id,t),this.summaryExporter._queueSummary(t)),cf_intelligent_code_enabled&&!t.imageChange&&this.removeHideStyles(t,!1),!0}console.log("CF_DONT_CHANGE set for path:"+e)}}addCustomTemplateStyles(e){var t="";return e&&e.template_properties&&(t=JSON.parse(e.template_properties).root_style),t}insertDynamicJS(e,t,r,i,s){if("inline_js"==cf_jsevl_type)try{var n=document.createElement("script"),o="prod"==cf_setup_env?"https://cdn.customfit.ai":"https://cdn.customfit.ai/stage";n.src=`${o}/${cf_dimension_id}/jss/${e}_cfitTemplate_on_template_js_load.js`,n.type="text/javascript",n.async=!0,n.className="customfit-js",n.id="js_"+e,n.setAttribute("cfit_template_id",e),n.setAttribute("cfit_template_exp_beh_info",i),document.body.appendChild(n)}catch(e){console.error(e)}else cf_ev_method(r,s)}trackTemplateView(e,t,r,i,s){try{var n=(l=i,function(t){try{var i=JSON.parse(JSON.stringify(r.experience_behaviour_response));i.template_id=l,i.button_clicked=t.target.innerText,e.track(new _.Builder("popup clicked").withEventType("TRACK").withEventProperty("cf_current_page_url",window.location.href).build(),!0)}catch(e){console.log(e)}}),o=t.querySelectorAll("a");for(var a of o)w(a,"click",n,!0);for(var a of o=t.querySelectorAll("button"))w(a,"click",n,!0);if(!e.sharedPreferences.getTemplateImpressionMap().get(i)){var c=JSON.parse(JSON.stringify(r.experience_behaviour_response));c.template_id=i,e.track(new _.Builder("popup viewed").withEventType("TRACK").withEventProperty("cf_current_page_url",window.location.href).build(),!0),r.template_info=c,e.summaryExporter._queueSummary(r),e.sharedPreferences.getTemplateImpressionMap().set(i,!0)}}catch(e){console.error(e)}var l}handleTemplateDisplayActions(e,t,r){var i=document.getElementById(t),s=this;if(i&&r&&r.config_selected){if("on_entry"==r.config_selected)return i.style.display="",i.style.visibility="",void s.trackTemplateView(s,i,e,t,r);if("on_click"==r.config_selected)try{var n=r.on_click_config.element_list;for(var o of n)!function(e,t,r,i,n){try{var o=document.querySelector(e);o&&w(o,"click",(function(e){try{var o=document.getElementById(i);o&&(o.style.display="block",o.style.visibility="visible",s.trackTemplateView(s,r,t,i,n))}catch(e){console.log(e)}}),!0)}catch(e){console.log(e)}}(o,e,i,t,r)}catch(e){console.log(e)}else"at_exit"==r.config_selected?function(e,t,r){try{var i=!1,n=r.at_exit_config.delay;function a(){var n=document.getElementById(t);if(n)return n.style.display="block",n.style.visibility="visible",s.trackTemplateView(s,n,e,t,r),i=!0,!0}n<0&&(n=1);var o=setTimeout((function(e){var t=function(e){var r=(e=e||window.event).relatedTarget||e.toElement;r&&"HTML"!==r.nodeName||!i&&a()&&b(document,"mouseout",t)};w(document,"mouseout",t)}),1e3*n);s.sharedPreferences.saveTimerId(o)}catch(c){console.error(c)}}(e,t,r):"timerbased"==r.config_selected?function(e,t,r){if(r.timerdisplay_config){var i=r.timerdisplay_config.timeout;i<0&&(i=1);var n=setTimeout((function(i){var n=document.getElementById(t);n&&(n.style.display="block",n.style.visibility="visible",s.trackTemplateView(s,n,e,t,r))}),1e3*i);s.sharedPreferences.saveTimerId(n)}}(e,t,r):"on_scroll"==r.config_selected&&function(e,t,r){try{var i=function(){try{var n=s.getCurrentPageScrollPercentage();if(n>0&&n>=r.on_scroll_config.scroll_percentage){var o=document.getElementById(t);o&&(o.style.display="block",o.style.visibility="visible",s.trackTemplateView(s,o,e,t,r),b(document,"scroll",i))}}catch(e){console.error(e)}};w(document,"scroll",i)}catch(e){console.error(e)}}(e,t,r)}}getTemplateDOM(e,t,r){try{let u=this.sharedPreferences.getDeviceType();if(document.getElementById(t.id))return null;if(sessionStorage.getItem("cf_popup_closed_"+t.id))return null;var i=document.createElement("div");i.style.position="relative",i.style.textAlign="center";const d=this.addCustomTemplateStyles(t.properties);d&&(i.style.cssText=d),i.className="cfit-custom-template",i.innerHTML=r,i.id=t.id;var s=null;try{t.properties&&t.properties.properties.settings&&(s=t.properties.properties.settings).config_selected&&(i.style.display="none",i.style.visibility="hidden")}catch(e){}try{if(s&&s.visibility_selected){if("hide_template"==s.visibility_selected)return null;if("desktop"==u&&"mobile_only"==s.visibility_selected)return null;if("mobile"==u&&"desktop_only"==s.visibility_selected)return null}if(s&&s.close_settings&&s.close_settings.close_config_selected){var n=localStorage.getItem("cf_popup_closed_"+t.id);if(n){var o=n.split(";")[0],a=parseInt(n.split(";")[1]);if("next_session"==s.close_settings.close_config_selected){if(o==window.customFit.sharedPreferences.sessionId)return null}else if("duration"==s.close_settings.close_config_selected){var c=new Date;if(Math.floor(c/1e3)<a+parseInt(s.close_settings.close_duration_settings.expiry))return null}localStorage.removeItem("cf_popup_closed_"+t.id),sessionStorage.removeItem("cf_popup_closed_"+t.id)}}}catch(e){}let p=null,h=null;t.nextSibling&&t.nextSibling.includes("CFIT_")?p=A(t.nextSibling):h=t.nextSibling&&document.querySelector(t.nextSibling);var l=document.querySelector(t.parentElement);if(l)return{nextSiblingElement:h,parentElement:l,templateDOM:i,config:e,templateData:t,htmlData:r,templateSettings:s,adjacentTemplate:p,nextSiblingPath:t.nextSibling}}catch(e){}return null}insertHTMLTemplate(e,t,r){var i=this;try{var s=e.templateSettings,n=e.config,o=e.templateData,a=e.htmlData;if(e.parentElement){e.adjacentTemplate&&e.nextSiblingPath&&(e.nextSiblingElement=document.querySelector("#"+e.adjacentTemplate),e.nextSiblingElement&&e.nextSiblingElement.parentElement!=e.parentElement&&(e.nextSiblingElement=null));var c=e.parentElement.insertBefore(e.templateDOM,e.nextSiblingElement);if(c)try{s&&this.handleTemplateDisplayActions(n,o.id,s);try{var l=JSON.parse(o.properties.template_properties).js_script,u=JSON.stringify(n.experience_behaviour_response);if(l&&l.length>0&&(l=l.replace("{{cf_template_id}}","'"+o.id+"'"),l="(function(){ var template_id = '"+o.id+"'; var template_exp_beh_info = '"+u+"';var template_settings = '"+JSON.stringify(s)+"';"+l+"})()",this.insertDynamicJS(o.id,s,l,u,c)),this.summaryExporter._queueSummary(n),this.sharedPreferences.getReplacedElementsConfigMap().set(n.config_customer_id,n),!(n.variation&&"true"==n.variation.cf_retain_value||cf_retain_text_value))return;!function(e,t,r,s,n,o,a){try{if(null==e.replacementCount||null==e.replacementCount||e.replacementCount<5){e.replacementCount=e.replacementCount||0;var c=new MutationObserver((function(o,a){try{if(!(o&&o.length>0))return;var c=!1;for(var l of o){for(var u of l.removedNodes)if(u.id&&u.id==t.id){c=!0;break}if(c)break}if(c&&e.replacementCount<5&&!sessionStorage.getItem("cf_popup_closed_"+t.id)){e.replacementCount++;var d=i.getTemplateDOM(e,t,r);if(d){a.disconnect(),i.insertHTMLTemplate(d,s,n);var p=document.getElementById(t.id);p&&i._applyTemplateInnerElementChanges(p,s,n)}}}catch(e){console.error(e),a.disconnect()}}));c.observe(a,{childList:!0}),e.innerHTMLObserver=c,i.sharedPreferences.saveRegObserverHandler(c)}}catch(e){console.error(e)}}(n,o,a,t,r,0,e.parentElement)}catch(e){console.error(e)}}catch(e){console.error(e)}}}catch(e){console.error(e)}}addCustomElements(e,t,r){var i=new Map,s=[],n=[];for(var o of Object.keys(e))try{if((u=e[o]).variation.customfit_meta&&u.variation.customfit_meta.custom_template){var a=u.variation.customfit_meta.custom_template,c=(a.parentElement?a.parentElement:"")+"|"+(a.nextSibling?a.nextSibling:""),l=i.get(c);l?l.experience_behaviour_response&&u.experience_behaviour_response&&l.experience_behaviour_response.priority&&u.experience_behaviour_response.priority&&l.experience_behaviour_response.experience_created_time&&u.experience_behaviour_response.experience_created_time&&(u.experience_behaviour_response.priority>l.experience_behaviour_response.priority||u.experience_behaviour_response.priority==l.experience_behaviour_response.priority&&u.experience_behaviour_response.experience_created_time>=l.experience_behaviour_response.experience_created_time)&&(u.properties&&u.properties.custom_template&&u.properties.custom_template.properties&&u.properties.custom_template.properties.properties&&u.properties.custom_template.properties.properties.alignment&&u.properties.custom_template.properties.properties.alignment,u.experience_behaviour_response.experience_id!=l.experience_behaviour_response.experience_id||u.experience_behaviour_response.behaviour_id!=l.experience_behaviour_response.behaviour_id?i.delete(c):c=c+"|"+u.experience_behaviour_response.behaviour_id,i.set(c,u),s.push(u)):(i.set(c,u),s.push(u))}}catch(e){}for(var u of s){const e=u.variation.customfit_meta.custom_template;u.variation&&u.variation.innerHTML&&(d=this.getTemplateDOM(u,e,u.variation.innerHTML,t,r))&&n.push(d)}for(var d of(n.sort(((e,t)=>new Date(e.config.config_created_at)-new Date(t.config.config_created_at))),n))this.insertHTMLTemplate(d,t,r);n.length>0&&this.sharedPreferences.setAddingCustomElementsAttempted(!0)}dfsReplace(e,t,r){if(t&&e instanceof Element){var i=this.cssPath(e);if(t.has(i)){let e=t.get(i);this.replaceElementInPath(i,e,r)}e.childNodes.forEach((e=>{this.dfsReplace(e,t,r)}))}}track(e,t=!1,r=!1){this.eventTracker&&this.eventTracker.trackEvent(e,t,r)}makeVisibleNonPersonalizedElements(e){var t=this.sharedPreferences.getHiddenElementsConfigMap();if(t)for(var r of t.keys())try{e.get(r)||this.removeHideStyles(t.get(r))}catch(e){console.log(e)}}notifyElementLoad(e,t){var r,i,s=this;return r=e,i=t,new Promise((function(e,t){var n=document.querySelector(r.properties.element_path);if(n)e([n,r,i]);else if(s.sharedPreferences.getActiveElementLoadObserverConfigMap().get(r.properties.element_path))t();else{var o=null;if(!r.variation.cf_retain_value){var a=setTimeout((function(){o&&o.disconnect();var t=document.querySelector(r.properties.element_path);t&&e([t,r,i]),s.sharedPreferences.getActiveElementLoadObserverConfigMap().delete(r.properties.element_path),s.unsetDomChangeActionConfig(r),s.handleActions()}),r.variation&&r.variation.cf_evt_load_time&&r.variation.cf_evt_load_time>0?r.variation.cf_evt_load_time:cf_sdk_timeout_in_seconds);s.sharedPreferences.saveTimerId(a)}(o=new MutationObserver((function(t){for(var n=0;n<t.length;n++){var c=t[n],l=Array.from(c.addedNodes);for(var u of l)if(u.matches&&u.matches(r.properties.element_path)||u.querySelector&&"function"==typeof u.querySelector&&u.querySelector(r.properties.element_path))try{return s.replaceElementInPath(r.properties.element_path,r,i),s.handleActions(),s.sharedPreferences.getActiveElementLoadObserverConfigMap().delete(r.properties.element_path),o.disconnect(),o=null,clearTimeout(a),void e()}catch(e){return o.disconnect(),void console.log(e)}}}))).observe(document.documentElement,{childList:!0,subtree:!0}),s.sharedPreferences.getActiveElementLoadObserverConfigMap().set(r.properties.element_path,!0),s.sharedPreferences.saveRegObserverHandler(o)}}))}notifyElementsReAdded(){var e=this,t=null,r=setTimeout((function(){t&&t.disconnect()}),2e4);e.sharedPreferences.saveTimerId(r),(t=new MutationObserver((function(t){t.forEach((function(t){try{var r=Array.from(t.addedNodes);for(var i of r)if(!(i.cfActionExecuted||i.id&&i.id.startsWith("CFIT"))){var s=e.sharedPreferences.getReplacedElementsConfigMap();for(var n of s.keys()){var o=s.get(n);if(i.matches&&i.matches(o.properties.element_path)||i.querySelector&&"function"==typeof i.querySelector&&i.querySelector(o.properties.element_path))try{if(o.variation&&o.variation.customfit_meta&&o.variation.customfit_meta&&o.variation.customfit_meta.edit_elem_action){var a=document.querySelector(o.properties.element_path);if(a&&a.cfActionExecuted)continue}o.replaced=!1,console.log("CF Config ReAdded: "+o.config_id),o.variation,e.replaceElementInPath(o.properties.element_path,o,!0)}catch(e){console.log(e)}}}}catch(e){console.log(e)}}))}))).observe(document.documentElement,{childList:!0,subtree:!0}),e.sharedPreferences.setElementReAddedObserver(t),e.sharedPreferences.saveRegObserverHandler(t)}isCurrentPageActive(){try{if(cf_enable_event_analyzer||!cf_active_pages)return!0;var e=window.location.hostname,t=P().replace(/\/$/,""),r=E(t);if(cf_active_pages.goal_pages)for(var i of cf_active_pages.goal_pages){var s=i.domain.replace("*","");if((t===i.page_path.replace(/\/$/,"")||r===i.page_path.replace(/\/$/,""))&&e.includes(s))return!0}if(cf_active_pages.rule_pages)for(var n of cf_active_pages.rule_pages)if(s=n.domain.replace("*",""),(t===n.page_path.replace(/\/$/,"")||r===n.page_path.replace(/\/$/,""))&&e.includes(s))return!0;return!1}catch(e){console.error(e)}return!1}getGoalDomainIfConfigured(e){if(cf_active_pages.goal_pages){var t=window.location.hostname;for(var r of cf_active_pages.goal_pages){var i=r.domain.replace("*","");if(e===r.page_path.replace(/\/$/,"")&&t.includes(i))return r.domain}}return null}isCurrentPagePersonalized(e){var t=P().replace(/\/$/,""),r=P(),i="ELEMENTS_BY_ID",s="",n=window.location.hostname,o=window.location.href,a=!1;if(e){if(e.page_paths_exact_match_list)for(var c of e.page_paths_exact_match_list){let[e,r]=c.page_path.split("?");if(e=e.replace(/\/$/,""),e===t){if(r){var l=!0;for(let e of r.split("&"))if(!o.includes(e)){l=!1;break}if(!l)continue}if(a=!0,c.page_elements_path_type&&(i=c.page_elements_path_type,s=c.page_path),r)break}}if(!a&&e.page_paths_contains_list)for(var u of(r=P(),e.page_paths_contains_list)){for(var d of u.target_text_list)if(r.includes(d)&&(!u.domain||n.includes(u.domain))){a=!0,u.page_elements_path_type&&(i=u.page_elements_path_type,s=r);break}if(a)break}if(!a&&e.page_paths_regex_list)for(var u of(r=P(),e.page_paths_regex_list)){for(var d of u.target_text_list)if(r.match(d)&&(!u.domain||n.includes(u.domain))){a=!0,u.page_elements_path_type&&(i=u.page_elements_path_type,s=r);break}if(a)break}}return{match_found:a,matched_page_elememnt_type:i,matched_page_path:s}}isPageBlackListedForTrack(){if(blacklisted_page_paths&&blacklisted_page_paths.length>0){var e=window.location.href;for(var t of blacklisted_page_paths)if(e.match(t))return!0}return!1}isReferrerBlackListed(e){if(e&&e.length>0&&blacklisted_referrers&&blacklisted_referrers.length>0)for(var t of blacklisted_referrers)if(e.match(t))return!0;return!1}makeElementInvisible(e,t){try{t||(t=document.getElementsByTagName("head")[0]);var r,i=document.createElement("style"),s=e.properties.element_path;return e.properties.element_path&&e.properties.element_path.includes("CFIT_GLOBAL_")&&1==e.properties.url_redirection_logic&&(s="html"),r=e.properties.element_hint&&"media"==e.properties.element_hint?s+"{ filter : blur(50px) !important; }":s+"{ opacity:0 !important; }",i.type="text/css",i.className="customfit-invisible-style",i.id="cf_style_"+e.config_id,i.setAttribute("data-customfit-selector",s),i.appendChild(document.createTextNode(r)),t.appendChild(i),!0}catch(e){}return!1}removeAllHideStyles(e=!1){for(var t=document.querySelectorAll(".customfit-invisible-style"),r=0;t&&r<t.length;r++)try{var i=t[r].getAttribute("data-customfit-selector");if(i){var s=document.querySelector(i),n=this.sharedPreferences.getHiddenElementsConfigMap().get(i);if(e&&n&&(n.imageChange||n.delayedTimer))continue;s&&(s.style.transition=".1s all")}t[r].parentNode.removeChild(t[r]),this.sharedPreferences.getHiddenElementsConfigMap().delete(i)}catch(s){}this.summaryExporter&&this.summaryExporter.sendSummaries()}removeHideStyles(e,t=!0){try{if(e){var r=document.getElementById("cf_style_"+e.config_id);if(r){if(t){var i=document.querySelector(e.properties.element_path);i&&(i.style.transition=".1s all")}r.remove(),this.sharedPreferences.getHiddenElementsConfigMap().get(e.properties.element_path)&&this.sharedPreferences.getHiddenElementsConfigMap().delete(e.properties.element_path)}}}catch(i){console.error(i)}}hideElementsIfNeeded(){try{var e=document.getElementsByTagName("head")[0];for(var t of cf_configs)this.isConfigBelongsToCurrentPage(t)&&this.makeElementInvisible(t,e)&&this.sharedPreferences.getHiddenElementsConfigMap().set(t.properties.element_path,t)}catch(e){console.log("CustomFit Exception: ",e)}}getNumber(e,t){try{return null==this._getConfigs()||null==this._getConfigs()||null==this._getConfigs()[e]||null==this._getConfigs()[e]||"NUMBER"!=this._getConfigs()[e].variation_data_type?t:(this.summaryExporter.pushSummary(this._getConfigs()[e]),this._getConfigs()[e].variation)}catch(e){return t}}getString(e,t){try{return null==this._getConfigs()||null==this._getConfigs()||null==this._getConfigs()[e]||null==this._getConfigs()[e]||"STRING"!=this._getConfigs()[e].variation_data_type?t:(this.summaryExporter.pushSummary(this._getConfigs()[e]),this._getConfigs()[e].variation)}catch(e){return t}}getBoolean(e,t){try{return null==this._getConfigs()||null==this._getConfigs()||null==this._getConfigs()[e]||null==this._getConfigs()[e]||"BOOLEAN"!=this._getConfigs()[e].variation_data_type?t:(this.summaryExporter.pushSummary(this._getConfigs()[e]),this._getConfigs()[e].variation)}catch(e){return t}}getImage(e,t){try{return null==this._getConfigs()||null==this._getConfigs()||null==this._getConfigs()[e]||null==this._getConfigs()[e]||"STRING"!=this._getConfigs()[e].variation_data_type?t:(this.summaryExporter.pushSummary(this._getConfigs()[e]),this._getConfigs()[e].variation)}catch(e){return t}}getList(e,t){try{return null==this._getConfigs()||null==this._getConfigs()||null==this._getConfigs()[e]||null==this._getConfigs()[e]||"LIST"!=this._getConfigs()[e].variation_data_type?t:(this.summaryExporter.pushSummary(this._getConfigs()[e]),this._getConfigs()[e].variation)}catch(e){return t}}getColor(e,t){try{return null==this._getConfigs()||null==this._getConfigs()||null==this._getConfigs()[e]||null==this._getConfigs()[e]||"COLOR"!=this._getConfigs()[e].variation_data_type?t:(this.summaryExporter.pushSummary(this._getConfigs()[e]),this._getConfigs()[e].variation)}catch(e){return t}}getRichText(e,t){try{return null==this._getConfigs()||null==this._getConfigs()||null==this._getConfigs()[e]||null==this._getConfigs()[e]||"RICHTEXT"!=this._getConfigs()[e].variation_data_type?t:(this.summaryExporter.pushSummary(this._getConfigs()[e]),this._getConfigs()[e].variation)}catch(e){return t}}getJson(e,t){try{return null==this._getConfigs()||null==this._getConfigs()||null==this._getConfigs()[e]||null==this._getConfigs()[e]||"JSON"!=this._getConfigs()[e].variation_data_type?t:(this.summaryExporter.pushSummary(this._getConfigs()[e]),this._getConfigs()[e].variation)}catch(e){return t}}advancedClickActions(e){for(let i=0;i<e.length;i++)try{const s=e[i];var t=s.first_elem_obj;if(!t)continue;if(t.style.cursor="pointer",t.style.setProperty("cursor","pointer","important"),"scroll_to_element"==s.action_type)(r=s.target_elem_obj)&&function(e,t){e.addEventListener("click",(function(){try{const e=t.getBoundingClientRect().top+window.scrollY;window.scrollTo({top:e,behavior:"smooth"})}catch(e){console.error(e)}}),!0)}(t,r);else if("redirect_to_page"==s.action_type)!function(e){t.addEventListener("click",(function(){let t=e.redirect_url,r=null==e.retain_params||e.retain_params,i=location.search;r&&i.length>0&&(t=t.includes("?")?t+i.replace("?","&"):t+i),e.open_in_new_tab?window.open(t,"_blank"):window.location.href=t}),!0)}(s);else if("hide_element"==s.action_type)(r=s.target_elem_obj)&&function(e,t){e.addEventListener("click",(function(){t.style.setProperty("display","none","important")}),!0)}(t,r);else if("unhide_element"==s.action_type){var r;(r=s.target_elem_obj)&&function(e,t){e.addEventListener("click",(function(){t.style.setProperty("display","","important")}),!0)}(t,r)}}catch(e){console.log("error: ",e)}}duplicateElement(e){for(let t=0;t<e.length;t++)try{const r=e[t];let i={position:r.position,first_elem:r.first_elem_obj,target_elem:r.target_elem_obj,cloned_elem_id:r.cloned_elem_id};this.sharedPreferences.getElementsDuplicatedMap().get(r.cloned_elem_id)||this.applyDuplicateElement(i)}catch(e){console.log("error: ",e)}}applyDuplicateElement(e){try{if(!e)return;let s=e.position,n=e.first_elem,o=e.target_elem,a=n.cloneNode(!0),c=e.cloned_elem_id,l=document.createElement("div");l.appendChild(a),l.id=c,l.classList.add("customfit-editor-element-duplicated");let u=!1;if("above"===s?u=this.duplicateElementAbove(o,l):"below"===s&&(u=this.duplicateElementBelow(o,l)),u){this.sharedPreferences.getElementsDuplicatedMap().set(c,n);var t=this.sharedPreferences.getConfigsPathMap();for(var r of t.keys())if(r.includes(c)){var i=t.get(r);this.replaceElementInPath(i.properties.element_path,i,!0)}}else this.duplicate_elem_wrapper.remove()}catch(e){console.log("error: ",e)}}duplicateElementAbove(e,t){let r=!1;try{e.parentNode.insertBefore(t,e),r=!0}catch(e){r=!1}return r}duplicateElementBelow(e,t){let r=!1;try{e.parentNode.insertBefore(t,e.nextSibling),r=!0}catch(e){r=!1}return r}moveElement(e,t,r){try{"above"==r?this.moveElementAbove(e,t):this.moveElementBelow(e,t)}catch(e){console.error(e)}}moveElementAbove(e,t){try{var r,i,s=e.parentNode,n=t.parentNode;if(!s||!n||s.isEqualNode(t)||n.isEqualNode(e))return;for(var o=0;o<s.children.length;o++)s.children[o].isEqualNode(e)&&(r=o);for(o=0;o<n.children.length;o++)n.children[o].isEqualNode(t)&&(i=o);s.isEqualNode(n)&&r<i&&i++,t.cfActionExecuted=!0,s.insertBefore(t,s.children[r])}catch(e){console.log(e)}}moveElementBelow(e,t){try{var r,i,s=e.parentNode,n=t.parentNode;if(!s||!n||s.isEqualNode(t)||n.isEqualNode(e))return;for(var o=0;o<s.children.length;o++)s.children[o].isEqualNode(e)&&(r=o);for(o=0;o<n.children.length;o++)n.children[o].isEqualNode(t)&&(i=o);s.isEqualNode(n)&&r<i&&i++,t.cfActionExecuted=!0,s.insertBefore(t,e.nextSibling),this.sharedPreferences.setElementsMoved(!0)}catch(e){console.log(e)}}swapElements(e,t){try{var r,i,s=e.parentNode,n=t.parentNode;if(!s||!n||s.isEqualNode(t)||n.isEqualNode(e))return;for(var o=0;o<s.children.length;o++)s.children[o].isEqualNode(e)&&(r=o);for(o=0;o<n.children.length;o++)n.children[o].isEqualNode(t)&&(i=o);s.isEqualNode(n)&&r<i&&i++,e.cfActionExecuted=!0,t.cfActionExecuted=!0,s.insertBefore(t,s.children[r]),n.insertBefore(e,n.children[i]),this.sharedPreferences.setElementsSwapped(!0)}catch(e){console.log(e)}}editElements(e){try{if(!(e&&e.action_type&&e.target_elem_obj&&e.action_txt&&0!=e.action_txt.length))return;let t=e.target_elem_obj;if(!t)return;if("replace_html"==e.action_type)return void function(t){function r(){var r=t.target_elem_obj,i=document.createElement("div");i.innerHTML=e.action_txt;var s=Array.from(i.children),n=null;if(r.parentNode)n=r.parentNode;else{if((r=document.querySelector(t.target_elem)).cfActionExecuted)return;r&&(n=r.parentNode)}n&&s.forEach((function(e){e.cfActionExecuted=!0,n.insertBefore(e,r)})),r.remove()}cf_retain_text_value?"complete"!=document.readyState&&w(window,"load",(function(e){setTimeout((function(){r()}),500)}),!0):r()}(e);if("insert_before_html"==e.action_type)return t.insertAdjacentHTML("beforebegin",e.action_txt),void(t.cfActionExecuted=!0);if("insert_after_html"==e.action_type)return t.insertAdjacentHTML("afterend",e.action_txt),void(t.cfActionExecuted=!0);if("append_html"==e.action_type)return t.insertAdjacentHTML("beforeend",e.action_txt),void(t.cfActionExecuted=!0)}catch(e){console.log(e)}}globalActions(e,t){try{if(!t)return;if(y.getGlobalActionsMap().get(e.properties.element_path))return;try{if(t.css&&t.css.script&&t.css.script.length>0){let e=document.createElement("style");e.class="cfit_global_action_dynamic_css",e.type="text/css",e.innerHTML=t.css.script,document.head.appendChild(e)}}catch(e){console.log(e)}try{if(t.query_params&&t.query_params.length>0){const e=new URL(window.location.href);for(var r of t.query_params)r.key&&r.key.length>0&&r.value&&r.value.length>0&&("add"===r.operation?e.searchParams.set(r.key,r.value):"remove"===r.operation&&e.searchParams.delete(key));window.history.pushState({path:e.href},"",e.href)}}catch(e){console.log(e)}try{t.js&&t.js.script&&t.js.script.length>0&&(n=e,o=t.js,a=function(){try{"inline_js"==cf_jsevl_type?x(n.config_id,n.variation_id,"",!1,"on_global_js_load"):cf_ev_method(o.script)}catch(e){console.error(e)}},o.execution_type&&"asap"!=o.execution_type?"document_ready"==o.execution_type?"loading"==document.readyState?w(document,"DOMContentLoaded",a,!0):a():"document_load"==o.execution_type&&("complete"!=document.readyState?w(window,"load",a,!0):a()):a())}catch(e){console.log(e)}try{if(t.redirection&&t.redirection.url&&t.redirection.url.length>0){if(y.isThisPageRedirected())return;var i=document.getElementById("customfitinit")||document.getElementById("customfitpreinit");if(!i)return;i.insertAdjacentHTML("beforebegin",'<style type="text/css">.customfit-redurl-invisible-block{visibility:hidden !important; opacity:0 !important}</style>'),(s=document.querySelector("html")).classList?s.classList.add("customfit-redurl-invisible-block"):s.className&&(s.className=s.className+" customfit-redurl-invisible-block"),y.splitTestActivated=!0;let e=t.redirection.url,r=null==t.redirection.retain_params||t.redirection.retain_params,n=location.search;r&&n.length>0&&(e=e.includes("?")?e+n.replace("?","&"):e+n),window.location.href.split("?")[0]==e.split("?")[0]&&(e=e.includes("?")?e+"&cf_redirected=true":e+"?cf_redirected=true"),window.location.href=e}}catch(e){var s;(s=document.querySelector("html"))&&s.className&&(s.className=s.className.replace(/\bcustomfit-redurl-invisible-block\b/g,"")),console.log(e)}y.getGlobalActionsMap().set(e.properties.element_path,!0)}catch(e){console.log(e)}var n,o,a}}var y=null,w=function(e,t,r,i=!1){e.addEventListener?e.addEventListener(t,r,i):e.attachEvent&&e.attachEvent("on"+t,r),y.saveRegEventHandler({obj:e,event:t,callback:r})},b=function(e,t,r,i=!1){e.removeEventListener?e.removeEventListener(t,r,i):e.detachEvent&&e.detachEvent("on"+t,r)},P=function(){let e="";try{e=window.location.href.split(window.location.hostname)[1];const t=e.indexOf("?");e=-1==t?e.substring(0):e.substring(0,t)}catch(t){console.log(t),e=window.location.pathname}return e=e.replace(/[\/#]*$/,""),0==e.length&&(e="/"),e},S=function(){var e=window.location.hostname;return e!==cf_domain_url&&e!=="www."+cf_domain_url||(e=cf_domain_url),e},E=function(e){try{if(e&&e.length>0&&cf_event_merge_config_json&&cf_event_merge_config_json.length>0)for(var t of cf_event_merge_config_json)if("regex"==t.path_check_type){if(e.match(t.pattern_value))return t.final_path}else if("starts_with"==t.path_check_type){if(e.startsWith(t.pattern_value)||e.startsWith("/"+t.pattern_value))return t.final_path}else if("ends_with"==t.path_check_type){if(e.endsWith(t.pattern_value))return t.final_path}else if("contains"==t.path_check_type&&e.includes(t.pattern_value))return t.final_path}catch(e){console.log(e)}return e},C=function(e){try{var t=[],r=window.location.hostname;if(e&&e.length>0&&cf_event_merge_config_json&&cf_event_merge_config_json.length>0)for(var i of cf_event_merge_config_json)if("regex"==i.path_check_type){if(e.match(i.pattern_value))if(i.domain){var s=i.domain.replace("*","");r.includes(s)&&t.push(i.final_path)}else t.push(i.final_path)}else"starts_with"==i.path_check_type?(e.startsWith(i.pattern_value)||e.startsWith("/"+i.pattern_value))&&(i.domain?(s=i.domain.replace("*",""),r.includes(s)&&t.push(i.final_path)):t.push(i.final_path)):"ends_with"==i.path_check_type?e.endsWith(i.pattern_value)&&(i.domain?(s=i.domain.replace("*",""),r.includes(s)&&t.push(i.final_path)):t.push(i.final_path)):"contains"==i.path_check_type&&e.includes(i.pattern_value)&&(i.domain?(s=i.domain.replace("*",""),r.includes(s)&&t.push(i.final_path)):t.push(i.final_path))}catch(e){console.log(e)}t.push(e);var n=new Set;return t.forEach((e=>{try{if(cf_active_pages.goal_pages)for(var t of cf_active_pages.goal_pages){var i=t.domain.replace("*","");e.replace(/\/$/,"")===t.page_path.replace(/\/$/,"")&&r.includes(i)&&n.add(e)}if(cf_active_pages.rule_pages)for(var s of cf_active_pages.rule_pages)i=s.domain.replace("*",""),e.replace(/\/$/,"")===s.page_path.replace(/\/$/,"")&&r.includes(i)&&n.add(e)}catch(e){console.error(e)}})),0==n.size&&n.add(e),Array.from(n)},x=function(e,t,r,i,s){try{var n=document.createElement("script"),o="prod"==cf_setup_env?"https://cdn.customfit.ai":"https://cdn.customfit.ai/stage";n.src=i?`${o}/${cf_dimension_id}/jss/${e}_${t}_${r}_${s}.js`:`${o}/${cf_dimension_id}/jss/${e}_${t}_${s}.js`,n.type="text/javascript",n.async=!0,n.className="customfit-js",document.body.appendChild(n)}catch(e){console.error(e)}},T=function(e,t,r=400){var i="",s="";if(r){var n=new Date;n.setTime(n.getTime()+24*r*60*60*1e3),i="; expires="+n.toUTCString(),s=document.domain.match(/[^\.]*\.[^.]*$/)[0]+";"}document.cookie=e+"="+(t||"")+i+"; domain="+s+"; path=/"},I=function(e){for(var t=e+"=",r=document.cookie.split(";"),i=0;i<r.length;i++){for(var s=r[i];" "==s.charAt(0);)s=s.substring(1,s.length);if(0==s.indexOf(t))return s.substring(t.length,s.length)}return null},k=function(e){try{if(!e||0==e.length)return null;var t=location.search;if(t&&t.length>0)return new URLSearchParams(t).get(e)}catch(e){return null}return null},A=function(e){try{if(!e.includes("CFIT_"))return null;const t=/\/\*([^*]+)\*\//,r=e.match(t);return r?r[1].trim():null}catch(e){return null}return null}})(),CustomFit=i})();try{(function() {
	// Union of Chrome, Firefox, IE, Opera, and Safari console methods
	var methods = ["log","error", "info", "warn"];
	var length = methods.length;
	var console = (window.console = window.console || {});
	var method;
	var noop = function() {};
	while (length--) {
	  method = methods[length];
	  // define undefined methods as noops to prevent errors
	  if (!console[method])
		console[method] = noop;
	}
})();}catch(e){}


var cf_key = cf_key || undefined;
var cf_intelligent_code_enabled = cf_intelligent_code_enabled || false;
var cf_configs = cf_configs || undefined;
var cf_page_paths = cf_page_paths || undefined;
var cf_active_pages = cf_active_pages || undefined;
//var cf_legacy = document.getElementById('customfitinit') ? false:true;
var cf_legacy = false;
var cf_sdk_version = cf_sdk_version || "0.0.21";
var cfspa = cfspa || undefined;
var cf_spa = cfspa;
var cfspa_auto_detect_page_url_change = cfspa_auto_detect_page_url_change || undefined;
var cf_spa_auto_detect_page_url_change = cfspa_auto_detect_page_url_change;
var cf_sdk_timeout_in_seconds = cf_sdk_timeout_in_seconds || 3000;
var cf_personalize_post_sdk_timeout = cf_personalize_post_sdk_timeout == undefined? true:cf_personalize_post_sdk_timeout ;
var cf_latest_sdk_version = cf_latest_sdk_version ||"0.0.21";
var cf_account_enabled = cf_account_enabled == undefined ? true:cf_account_enabled;
var blacklisted_page_paths = blacklisted_page_paths || [];
var blacklisted_referrers = blacklisted_referrers || [];
var is_auto_form_capture = is_auto_form_capture || false;
var is_auto_email_capture = is_auto_email_capture || false;
var is_auto_phonenumber_capture = is_auto_phonenumber_capture || false;
var cf_is_inbound =  cf_is_inbound == undefined ? true:cf_is_inbound;
var cf_is_outbound = cf_is_outbound == undefined ? true:cf_is_outbound;
//var cf_ev_method = eval;
var cf_is_page_update_enabled = cf_is_page_update_enabled == undefined ? true: cf_is_page_update_enabled;
var cf_config_reapply_timers = cf_config_reapply_timers || "2000";
var cf_is_hubspot_enabled = cf_is_hubspot_enabled == undefined ? false:cf_is_hubspot_enabled;
var cf_send_error_report = cf_send_error_report == undefined ? false:cf_send_error_report;
var cf_is_moengage_enabled = cf_is_moengage_enabled == undefined ? false:cf_is_moengage_enabled;
var cf_is_clevertap_enabled = cf_is_clevertap_enabled == undefined ? false:cf_is_clevertap_enabled;
var cf_is_webengage_enabled = cf_is_webengage_enabled == undefined ? false:cf_is_webengage_enabled;
var cf_is_netcore_enabled = cf_is_netcore_enabled == undefined ? false:cf_is_netcore_enabled;
var cf_retain_text_value = cf_retain_text_value == undefined ? false:cf_retain_text_value;
var cf_personalized_users_limit_exceeded = cf_personalized_users_limit_exceeded == undefined ? false: cf_personalized_users_limit_exceeded;
var cf_skip_dfs = true;//cf_skip_dfs == undefined ? false : cf_skip_dfs;
var cf_domain_url = cf_domain_url || window.location.host
var cf_subdomains = cf_subdomains || [];
var cf_script_time_init = new Date().getTime();
var cf_script_time_before_config_call = null;
var cf_script_time_after_config_call = null;
var cf_script_time_after_config_duriations = [];
var cf_script_time_after_all_done = null;
var cf_skip_sdk = cf_skip_sdk == undefined ? false : cf_skip_sdk;
var cf_jsevl_type = cf_jsevl_type || "default";
var cf_dimension_id = cf_dimension_id || "";
var cf_setup_env = cf_setup_env || "prod";
var cf_initial_delay_in_ms = cf_initial_delay_in_ms || 0;
var cf_enable_event_analyzer = cf_enable_event_analyzer == undefined ? true: cf_enable_event_analyzer;
var cf_event_merge_config = cf_event_merge_config || "[]";
var cf_event_merge_config_json = [];
var cf_is_hotjar_enabled = cf_is_hotjar_enabled == undefined ? false: cf_is_hotjar_enabled;
var cf_is_ms_clarity_enabled = cf_is_ms_clarity_enabled == undefined ? false: cf_is_ms_clarity_enabled;
var cf_is_segment_enabled = cf_is_segment_enabled == undefined ? false: cf_is_segment_enabled;
var cf_is_mixpanel_enabled = cf_is_mixpanel_enabled == undefined ? false: cf_is_mixpanel_enabled;
var cf_is_amplitude_enabled = cf_is_amplitude_enabled == undefined ? false: cf_is_amplitude_enabled;
var cf_is_heap_enabled = cf_is_heap_enabled == undefined ? false: cf_is_heap_enabled;
var cf_shopify_event_settings = cf_shopify_event_settings || "{}";
var cf_browser_variables = cf_browser_variables || null;
var cf_revenue_pages = cf_revenue_pages || [];
var cf_is_shopify_integrated = cf_is_shopify_integrated == undefined ? false: cf_is_shopify_integrated;
var cf_is_ga_enabled = cf_is_ga_enabled == undefined ? false:cf_is_ga_enabled;
var cf_ga4_setup_mode = cf_ga4_setup_mode || "gtm"
var cf_gtm_data_variable_name = cf_gtm_data_variable_name || "dataLayer"
var cf_shopify_events_enabled = cf_shopify_events_enabled == undefined ? false: cf_shopify_events_enabled;
var cf_ev_method = function (js, this_element) {
	try {
		const fn = new Function('this_element', js);
		fn(this_element); // Replace `el` with your actual element reference
	} catch (e) {
		console.error('Error executing dynamic JS:', e);
	}
}

function removeCFInvisibleCode() {
	var html_ele =  document.querySelector("html");
	html_ele.className = html_ele.className.replace(/\bcustomfit-invisible-preinit-block\b/g, "");
	var a = document.getElementById("customfit-invisible-preinit-css-block");
	if (a) a.parentNode.removeChild(a);
}

if(cf_active_pages) {
	cf_page_paths = cf_active_pages.personalized_pages;
}

var bots = [
    "(Pingdom.com_bot_version_)(\d+)\.(\d+)", // Pingdom
    "(facebookexternalhit)/(\d+)\.(\d+)", // Facebook
    "Google.*/\+/web/snippet", // Google Plus
    "(Twitterbot)/(\d+)\.(\d+)", // Twitter
    "/((?:Ant-)?Nutch|[A-z]+[Bb]ot|[A-z]+[Ss]pider|Axtaris|fetchurl|Isara|ShopSalad|Tailsweep)[ \-](\d+)(?:\.(\d+)(?:\.(\d+))?)?", // Bots Pattern '/name-0.0'
    "(008|Altresium|Argus|BaiduMobaider|BoardReader|DNSGroup|DataparkSearch|EDI|Goodzer|Grub|INGRID|Infohelfer|LinkedInBot|LOOQ|Nutch|PathDefender|Peew|PostPost|Steeler|Twitterbot|VSE|WebCrunch|WebZIP|Y!J-BR[A-Z]|YahooSeeker|envolk|sproose|wminer)/(\d+)(?:\.(\d+)(?:\.(\d+))?)?", //Bots Pattern 'name/0.0'
    "(MSIE) (\d+)\.(\d+)([a-z]\d?)?;.* MSIECrawler", //MSIECrawler
    "(Google-HTTP-Java-Client|Apache-HttpClient|http%20client|Python-urllib|HttpMonitor|TLSProber|WinHTTP|JNLP)(?:[ /](\d+)(?:\.(\d+)(?:\.(\d+))?)?)?", // Downloader ...
    "(1470\.net crawler|50\.nu|8bo Crawler Bot|Aboundex|Accoona-[A-z]+-Agent|AdsBot-Google(?:-[a-z]+)?| PTST\/|Chrome\-Lighthouse|Chrome-Lighthouse|Lighssthouse|GTmetrix|altavista|AppEngine-Google|archive.*?\.org_bot|archiver|Ask Jeeves|[Bb]ai[Dd]u[Ss]pider(?:-[A-Za-z]+)*|bingbot|BingPreview|blitzbot|BlogBridge|BoardReader(?: [A-Za-z]+)*|boitho.com-dc|BotSeer|\b\w*favicon\w*\b|\bYeti(?:-[a-z]+)?|Catchpoint bot|[Cc]harlotte|Checklinks|clumboot|Comodo HTTP\(S\) Crawler|Comodo-Webinspector-Crawler|ConveraCrawler|CRAWL-E|CrawlConvera|Daumoa(?:-feedfetcher)?|Feed Seeker Bot|findlinks|Flamingo_SearchEngine|FollowSite Bot|furlbot|Genieo|gigabot|GomezAgent|gonzo1|(?:[a-zA-Z]+-)?Googlebot(?:-[a-zA-Z]+)?|Google SketchUp|grub-client|gsa-crawler|heritrix|HiddenMarket|holmes|HooWWWer|htdig|ia_archiver|ICC-Crawler|Icarus6j|ichiro(?:/mobile)?|IconSurf|IlTrovatore(?:-Setaccio)?|InfuzApp|Innovazion Crawler|InternetArchive|IP2[a-z]+Bot|jbot\b|KaloogaBot|Kraken|Kurzor|larbin|LEIA|LesnikBot|Linguee Bot|LinkAider|LinkedInBot|Lite Bot|Llaut|lycos|Mail\.RU_Bot|masidani_bot|Mediapartners-Google|Microsoft .*? Bot|mogimogi|mozDex|MJ12bot|msnbot(?:-media *)?|msrbot|netresearch|Netvibes|NewsGator[^/]*|^NING|Nutch[^/]*|Nymesis|ObjectsSearch|Orbiter|OOZBOT|PagePeeker|PagesInventory|PaxleFramework|Peeplo Screenshot Bot|PlantyNet_WebRobot|Pompos|Read%20Later|Reaper|RedCarpet|Retreiver|Riddler|Rival IQ|scooter|Scrapy|Scrubby|searchsight|seekbot|semanticdiscovery|Simpy|SimplePie|SEOstats|SimpleRSS|SiteCon|Slurp|snappy|Speedy Spider|Squrl Java|TheUsefulbot|ThumbShotsBot|Thumbshots\.ru|TwitterBot|URL2PNG|Vagabondo|VoilaBot|^vortex|Votay bot|^voyager|WASALive.Bot|Web-sniffer|WebThumb|WeSEE:[A-z]+|WhatWeb|WIRE|WordPress|Wotbox|www\.almaden\.ibm\.com|Xenu(?:.s)? Link Sleuth|Xerka [A-z]+Bot|yacy(?:bot)?|Yahoo[a-z]*Seeker|Yahoo! Slurp|Yandex\w+|YodaoBot(?:-[A-z]+)?|YottaaMonitor|Yowedo|^Zao|^Zao-Crawler|ZeBot_www\.ze\.bz|ZooShot|ZyBorg)(?:[ /]v?(\d+)(?:\.(\d+)(?:\.(\d+))?)?)?", // Bots
    "(?:\/[A-Za-z0-9\.]+)? *([A-Za-z0-9 \-_\!\[\]:]*(?:[Aa]rchiver|[Ii]ndexer|[Ss]craper|[Bb]ot|[Ss]pider|[Cc]rawl[a-z]*))/(\d+)(?:\.(\d+)(?:\.(\d+))?)?", // Bots General matcher 'name/0.0'
    "(?:\/[A-Za-z0-9\.]+)? *([A-Za-z0-9 _\!\[\]:]*(?:[Aa]rchiver|[Ii]ndexer|[Ss]craper|[Bb]ot|[Ss]pider|[Cc]rawl[a-z]*)) (\d+)(?:\.(\d+)(?:\.(\d+))?)?", // Bots General matcher 'name 0.0'
    "((?:[A-z0-9]+|[A-z\-]+ ?)?(?: the )?(?:[Ss][Pp][Ii][Dd][Ee][Rr]|[Ss]crape|[A-Za-z0-9-]*(?:[^C][^Uu])[Bb]ot|[Cc][Rr][Aa][Ww][Ll])[A-z0-9]*)(?:(?:[ /]| v)(\d+)(?:\.(\d+)(?:\.(\d+))?)?)?" 
]

function checkb() {
    var isBot = false;
    var userAgent = navigator.userAgent;
    if(!userAgent || userAgent.length == 0) 
        return isBot;

    for (var bot of bots) {
        try {
            if(userAgent.match(bot)) {
                isBot = true;
                break;
            }
        } catch(e) {
            console.error(e)
        }
    }
    return isBot;
}

function cfitinit() {
	(function (c, f, i, t, a, b, e) {

		if (!cf_account_enabled) {
			removeCFInvisibleCode();
			console.error("Your CustomFit.ai subscription has been expired. Remove the JS snippet or contact https://customfit.ai/contact")
			return;
		}

		if (cf_skip_sdk) {
			removeCFInvisibleCode();
			console.error("CustomFit.ai sdk has been powered off")
			return;
		}

		if (checkb()) {
			removeCFInvisibleCode();
			return;
		}

		var ele = f.getElementById('customfitinit') || f.getElementById('customfitpreinit')
		if (!ele) {
			removeCFInvisibleCode();
			return;
		}

		if(!cf_dimension_id || cf_dimension_id.length == 0) {
			var ele_ar = ele.src.split('/');
			cf_dimension_id = ele_ar[ele_ar.length - 2];
		}

		if (ele.src.includes("stage")) {
			cf_setup_env = "stage";
		}

		try {
			cf_event_merge_config_json = JSON.parse(cf_event_merge_config);
		} catch(e) {
			cf_event_merge_config_json = [];
			console.log(e);
		}

		var spa = cf_spa ? cf_spa : ele.getAttribute('cfspa') == "true";
		var spa_auto_detect_page_url_change = cf_spa_auto_detect_page_url_change ? cf_spa_auto_detect_page_url_change : ele.getAttribute('cfspa_auto_detect_page_url_change') == "true";
		if (c.customFit) {
			if (spa == true) {
				c.customFit.uninit();
			} else {
				console.error("Mutliple initialization of CustomFit ai detected");
				if (c.customFit.documentMadeVisible) {
					removeCFInvisibleCode()
				}
				return;
			}
		}

		var domain_mismatch = false;
		if (!window.location.host.includes(cf_domain_url)) {
			domain_mismatch = true;
			for (var cf_subdomain of cf_subdomains) {
				if(cf_subdomain.includes('*')) {
					cf_subdomain = cf_subdomain.split('*')[1];
				}
				if (window.location.host.includes(cf_subdomain)) {
					domain_mismatch = false;
					break;
				}
			}
		}

		if (domain_mismatch) {
			console.error("Exiting: CustomFit ai detected the script on a non-configured domain/subdomain. Check https://dashboard.customfit.ai/settings/app-settings");
			removeCFInvisibleCode();
			return;
		}

		var customFit = new CustomFit.default();
		console.log("CustomFit.ai init started! (Version: " + cf_sdk_version + ")");
		ele.insertAdjacentHTML("beforebegin", `<style type="text/css">.customfit-invisible-block{opacity:0 !important;filter:alpha(opacity=0) !important;background:none !important;}</style>`);
		var cfUserBuilder = new CustomFit.CFUser.Builder();
		var cfg = { personalize: true, maintainSession: false, sendPageTrack: true, spa: spa, spa_auto_detect_page_url_change: spa_auto_detect_page_url_change }
		var key = cf_key ? cf_key : ele.getAttribute('cfclientkey')
		if (!key) { console.error("CustomFit init failed! Client key missing!"); removeCFInvisibleCode(); return; }
		if (customFit.construct(cfUserBuilder.build(), key, cfg)) {
			customFit.init().then(function (value) {
				var tpl = 'background-color:white; border:3px solid orange; font-size:12px; font-weight: bold;padding:3px 5px;color:';
				console.log('%cWebsite hyper-personalization engine \'CustomFit.ai\' (https://customfit.ai?utm_campaign=console) is at your service - t:' + new Date().getTime(),
					tpl + 'magenta');
			}).catch(function (err) {
				console.log("Error CustomFit.ai", err);
			});
		}
		c.customFit = customFit
	})(window, document);
}

cfitinit();
